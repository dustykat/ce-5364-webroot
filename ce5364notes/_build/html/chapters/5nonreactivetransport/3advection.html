
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Advection &#8212; Groundwater Transport Phenomena</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Diffusion" href="../6nonreactivetransport/4diffusion.html" />
    <link rel="prev" title="Flux" href="2flux.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/gwtransport.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Groundwater Transport Phenomena</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to CE 5364 Groundwater Transport Phenomena
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../0introduction/0introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../1computationaltools/1computationaltools.html">
   Computational Tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2essentialgroundwater/essentialgwreview.html">
   Essential Groundwater Review - I
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3essentialgroundwater/essentialgwreview2.html">
   Essential Groundwater Review - II
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4pollutants/4pollutants.html">
   Pollutants
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="5nonreactivetransport.html">
   Non-Reactive Transport - I
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="1tracerhypothesis.html">
     Tracer Hypothesis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2flux.html">
     Flux
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Advection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6nonreactivetransport/4diffusion.html">
     Diffusion
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6nonreactivetransport/5dispersion.html">
     Dispersion
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7analyticalmodels/analyticalmodels.html">
   Analytical Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7analyticalmodels/ogatabanks.html">
     Ogata-Banks Solution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7analyticalmodels/sauty.html">
     Sauty Solution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7analyticalmodels/huntsolution.html">
     Hunt Solution (2D plume in regional flow)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7analyticalmodels/domenico.html">
     Domenico-Robbins Convolution of 1D Solutions to approximate 3D behavior
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../8reactivetransport/8reactivetransport.html">
   Reactive Transport
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../8reactivetransport/6reactions.html">
     Reactions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../8reactivetransport/7decay.html">
     Decay
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../16siteinvestigation/siteinvestigation.html">
   Site Investigations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../19regulatory/regulatory.html">
   Groundwater Protection Legal Framework
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/5nonreactivetransport/3advection.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapters/5nonreactivetransport/3advection.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/chapters/5nonreactivetransport/3advection.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modeling-advection">
   Modeling Advection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modeling-tools">
   Modeling Tools
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#particle-tracking">
   Particle Tracking
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multi-linear-interpolation">
     Multi-Linear Interpolation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spreadsheet-approach">
     Spreadsheet Approach
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spreadsheets">
   Spreadsheets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-of-particle-tracking">
   Example of Particle Tracking
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-2-problem-2-8-pg-578">
     Problem 2 (Problem 2-8, pg. 578)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-1-need-to-digitize-the-head-map">
     Step 1. Need to Digitize the Head Map
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#open-g3data">
       Open G3DATA
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#set-view-zoom">
       Set View == Zoom
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#set-filename">
       Set Filename
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#set-xy-coordinates">
       Set XY Coordinates
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#digitize-the-contours">
       Digitize the Contours
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#step-2-check-the-digitization-results">
     Step 2 Check the Digitization Results
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flownets-pp-30-34">
   Flownets (pp. 30-34)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#theory-in-progress">
     Theory (in progress)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-in-python">
     Example in Python
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#velocity-potential">
       Velocity Potential
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#stream-function">
       Stream Function
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sheetpile-under-a-dam-flownet">
     Sheetpile under a dam flownet
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#flownet-example-2-pore-pressure-under-a-dam-domain-decomposition-approach">
     Flownet Example 2 : Pore Pressure under a Dam (Domain Decomposition approach)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="advection">
<h1>Advection<a class="headerlink" href="#advection" title="Permalink to this headline">¶</a></h1>
<p>Advection (convection) is the transport of dissolved or suspended material by motion of the host fluid. The prediction of the direction and amount of material transported requires knowledge of the fluid velocity field (the velocity of a fluid particle).</p>
<p><img alt="" src="../../_images/labeledparcel.png" /></p>
<p>The figure depicts the flow of a labeled fluid in a tube.  One can use the sketch to define various useful properties of the labeled fluid portion as listed.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Expression</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Mass of labeled fluid</p></td>
<td><p><span class="math notranslate nohighlight">\(m=\rho A\Delta L\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Mass of tracer</p></td>
<td><p><span class="math notranslate nohighlight">\(m=C A\Delta L\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Distance traveled by leading (trailing edge)</p></td>
<td><p><span class="math notranslate nohighlight">\(x=\Delta L\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Time required to travel distance</p></td>
<td><p><span class="math notranslate nohighlight">\(time = \Delta t\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Velocity of leading edge</p></td>
<td><p><span class="math notranslate nohighlight">\(u = \frac{x}{time} = \frac{\Delta L}{\Delta t}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Mass through circular frame/unit time</p></td>
<td><p><span class="math notranslate nohighlight">\(m=\frac{\rho A\Delta L}{\Delta t}\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Tracer through circular frame/unit time</p></td>
<td><p><span class="math notranslate nohighlight">\(m=\frac{C A\Delta L}{\Delta t}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Fluid mass flux</p></td>
<td><p><span class="math notranslate nohighlight">\(J=\rho\frac{UA}{A}=\rho\frac{Q}{A}=\rho U\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Tracer mass flux</p></td>
<td><p><span class="math notranslate nohighlight">\(J=C\frac{UA}{A}=C\frac{Q}{A}=C U\)</span></p></td>
</tr>
</tbody>
</table>
<p>The advective flux is the product of the quantity of interest (in this case mass of either host fluid or tracer) and the velocity term.  Typically the mean section velocity is used (pipe flow, open channel flow) because fine scale resolution of the velocity field is impossible.  In porous media, the pore velocity or average linear velocity is used.
Advection calculations usually use mean section velocity based on discharge measurements.</p>
<div class="section" id="modeling-advection">
<h2>Modeling Advection<a class="headerlink" href="#modeling-advection" title="Permalink to this headline">¶</a></h2>
<p>To build models, we simply apply the Reynolds Transport Theorem to the advective flux component something like:</p>
<p><img alt="" src="../../_images/advectivefrux.png" /></p>
</div>
<div class="section" id="modeling-tools">
<h2>Modeling Tools<a class="headerlink" href="#modeling-tools" title="Permalink to this headline">¶</a></h2>
<p>1D Examples are in the textbook; 1D is not too difficult as the direction hence the path is known.</p>
<p>Higher spatial dimensions (2D, 3D) use either a particle tracking approach (DPRW, MOC, MT3D, …) or flux-limited Reynolds-averaged Navier-Stokes (FLUENT, SUTRA, HST3D, ….)</p>
</div>
<div class="section" id="particle-tracking">
<h2>Particle Tracking<a class="headerlink" href="#particle-tracking" title="Permalink to this headline">¶</a></h2>
<p>Later on we will use USGS-MOC, so will illustrate particle tracking.</p>
<ul class="simple">
<li><p>Particle or front tracking is typically performed using special software.</p></li>
<li><p>It can be performed using a spreadsheet.</p></li>
<li><p>The spreadsheet exercise is useful to illustrate the principles involved in particle tracking calculations.</p></li>
<li><p>Particle tracking with reactions is very computationally intensive and is beyond practical application in a spreadsheet; such computations are used to design space shuttles, helicopters and other things where the knowledge gained justifies the costs</p></li>
</ul>
<p>The first step is to compute the velocity field (if it is steady even better, if not then every time increment it is recomputed)</p>
<ul class="simple">
<li><p>If analytical functions are available for the velocity field then tracking is relatively easy.</p></li>
<li><p>Usually the velocity field is determined numerically at discrete points in space, and this is the situation of interest.</p></li>
<li><p>The interpolation schemes in common use are simple; simple, simple-linear, and multi-linear schemes.</p></li>
<li><p>Only the simple-linear scheme preserves cell-by-cell mass balances.</p></li>
</ul>
<p>The figure below illustrates simple linear interpolation.</p>
<p><img alt="" src="../../_images/particle_track_interpolation.png" /></p>
<ul class="simple">
<li><p>Typical computational grid for heads.</p></li>
<li><p>Arrows are the interfacial fluxes.</p></li>
<li><p>The simple scheme assigns the top and left flux to <span class="math notranslate nohighlight">\((x_1,y_1)\)</span>.</p></li>
<li><p>The simple scheme assgins the right and bottom flux to <span class="math notranslate nohighlight">\((x_2,y_2)\)</span>.</p></li>
</ul>
<p>The particle velocity is determined by position of the particle relative to the velocity grid.</p>
<p><img alt="" src="../../_images/pt_find_particle.png" /></p>
<p>Uses the same grid as the head scheme.
Velocity is the distance weighted average of the cell that the particle occupies.</p>
<p><img alt="" src="../../_images/pt_get_velo.png" /></p>
<p>From the above figure, the particle’s velocities (x- and y- directions) are:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(u_p = \frac{1-\delta x}{\Delta x}u(x_1,y_1)+\frac{\delta x}{\Delta x}u(x_2,y_2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(v_p = \frac{1-\delta y}{\Delta y}v(x_1,y_1)+\frac{\delta y}{\Delta y}v(x_2,y_2)\)</span></p></li>
</ul>
<div class="section" id="multi-linear-interpolation">
<h3>Multi-Linear Interpolation<a class="headerlink" href="#multi-linear-interpolation" title="Permalink to this headline">¶</a></h3>
<p>Higher order schemes produce smoother velocity fields at the expense of cell mass balances and computational ease. The USGS-MOC model uses a bi-linear scheme where the velocities at the four corners of the occupied cell are used. When transient flow fields occur, averaging in time is also used. The differences in the schemes are hard to detect when the grid spacing is small and the flow field is smoothly varying.</p>
</div>
<div class="section" id="spreadsheet-approach">
<h3>Spreadsheet Approach<a class="headerlink" href="#spreadsheet-approach" title="Permalink to this headline">¶</a></h3>
<p>To illustrate particle tracking the simple velocity scheme is used.<br />
Extension to higher order schemes is straight forward.</p>
<p>Illustrate with simple scheme. Consider:</p>
<p><img alt="" src="../../_images/ss_fig1.png" /></p>
<ul class="simple">
<li><p>Large rectangles represent the velocity grid.</p></li>
<li><p>Circles represent the geometric location where velocity is known.</p></li>
<li><p>Small rectangle represents the particle that we wish to track.</p></li>
</ul>
<p><strong>Cell Indexing</strong></p>
<p><img alt="" src="../../_images/ss_fig2.png" /></p>
<ul class="simple">
<li><p>Each cell represents a grid location in the velocity field.  Thus each cell has a unique row and column index.</p></li>
<li><p>Each cell centroid also has a unique geomteric (x,y) location.</p></li>
<li><p>The particle in the figure is located in cell named: Col_1,Row_2.</p></li>
<li><p>The cell is located at position: (X_1,Y_2).</p></li>
<li><p>The particle position is (XP,YP).</p></li>
</ul>
<p><strong>Locating the Particle</strong></p>
<ul class="simple">
<li><p>At the start of a time-step:</p></li>
<li><p>particle position is known.</p></li>
<li><p>cell positions are known.</p></li>
<li><p>cell that the particle occupies is unknown.</p></li>
<li><p>Construct a distance table</p></li>
<li><p>The distance from each cell to the particle is calculated and stored in a table.</p></li>
<li><p>Search the table,find the cell nearest the particle.</p></li>
<li><p>The cell coordinates of the smallest distance in the table is determined</p></li>
</ul>
<p><strong>Locating in Excel</strong></p>
<ul class="simple">
<li><p>The spreadsheet function that finds the value in an array (rectangular area of cells), given the position in the array to search is the function <code class="docutils literal notranslate"><span class="pre">INDEX(array,row_index,column_index)</span></code></p></li>
<li><p>The spreadsheet function that can find the position in an array where a particular value appears is the function <code class="docutils literal notranslate"><span class="pre">MATCH(value,array,type)</span></code></p></li>
</ul>
<p><strong>INDEX Function</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">INDEX(array,row_index,column_index)</span></code>
array is the location of the rectangular area of cells to search (eg. A3:C6).
row_index is number of rows down from the starting row to search.
column_index is the number of columns across from the starting column to search.</p></li>
</ul>
<p><strong>MATCH Function</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MATCH(value,array,type)</span></code>
value is the numerical value to search for in the array.
array is the location of the rectangular area of cells to search (eg. A3:C6).
type is the type of match to use.  type=0 means exact matching.</p></li>
</ul>
<p><strong>Using the Functions</strong></p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">INDEX</span></code> function allows us to select the correct values of velocity if we know which cell the particle resides in.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">MATCH</span></code> function allows us to compare values in an array and determine the position in the array that these values are found.<br />
Thus the <code class="docutils literal notranslate"><span class="pre">MATCH</span></code> function lets us search a distance table, find the cell center nearest the particle, and then use the index to find the correct velocity.</p></li>
</ul>
<p><strong>Moving the Particle</strong></p>
<p>Once the cell containing the particle is identified, the particle is assigned the velocity values for that cell.
The particle is then “moved” by the simple kinematic calculation:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_p(t+\Delta t)=x_p(t)+u_p(t)\Delta t\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y_p(t+\Delta t)=y_p(t)+v_p(t)\Delta t\)</span></p></li>
</ul>
<p><strong>Illustrative Example</strong></p>
<p>An example with 3 particles is shown below - the spreadsheet is kind of big because iterative computations are intentionally avoided.</p>
<p><img alt="" src="../../_images/pt_seg0.png" /></p>
<p>Closer view for particle 1:</p>
<p><img alt="" src="../../_images/pt_seg1.png" /></p>
<p>Closer view for particle 2:</p>
<p><img alt="" src="../../_images/pt_seg2.png" /></p>
<p>Closer view for particle 3:</p>
<p><img alt="" src="../../_images/pt_seg3.png" /></p>
<p><strong>Summary</strong></p>
<ul class="simple">
<li><p>Particle tracking is a tool to determine the position of a fluid particle in a flow field.</p></li>
<li><p>A two-step approach is required:</p></li>
<li><p>Determine particle velocity</p>
<ul>
<li><p>Locate the particle relative to known velocity locations.</p></li>
<li><p>Assign the velocity to the particle based on an interpolation scheme.</p></li>
</ul>
</li>
<li><p>Move the particle.</p></li>
<li><p>All particle tracking programs use this type of two-step logic.</p></li>
</ul>
</div>
</div>
<div class="section" id="spreadsheets">
<h2>Spreadsheets<a class="headerlink" href="#spreadsheets" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/ce5364notes/chapters/5nonreactivetransport/PartTrack_10.xls">Cleveland, T.G. (1997) <em>Particle Tracking Spreadsheet (10X10) (Excel)</em></a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/ce5364notes/chapters/5nonreactivetransport/PartTrack_20.xls">Cleveland, T.G. (1997) <em>Particle Tracking Spreadsheet (20X20) (Excel)</em></a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/ce5364notes/chapters/5nonreactivetransport/PartTrack.xls">Cleveland, T.G. (1997) <em>Particle Tracking Spreadsheet (5X5 same as example above) (Excel)</em></a></p></li>
</ol>
<p>Performing the calculations in a python script is illustrated in the next section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will see that the python script is simpler to construct than the spreadsheet (in terms of weird functions), but takes a shit-ton more code!</p>
</div>
</div>
<div class="section" id="example-of-particle-tracking">
<h2>Example of Particle Tracking<a class="headerlink" href="#example-of-particle-tracking" title="Permalink to this headline">¶</a></h2>
<p>Here we illustrate using particle tracking to address the problem from the homework.</p>
<hr><hr>
<div class="section" id="problem-2-problem-2-8-pg-578">
<h3>Problem 2 (Problem 2-8, pg. 578)<a class="headerlink" href="#problem-2-problem-2-8-pg-578" title="Permalink to this headline">¶</a></h3>
<p>The figure below shows a piezometric map for a shallow sand aquifer.  The hydraulic conductivtiy is estimated to be <span class="math notranslate nohighlight">\(1.5 \times 10^{-2}~\frac{cm}{s}\)</span>, the saturated thickness is 40 feet, and the effective porosity is 0.3.</p>
<p><img alt="" src="http://54.243.252.9/ce-5364-webroot/2-Exercises/ES1/Fig5.18.png" /></p>
<p>Determine:</p>
<ol class="simple">
<li><p>Which well is expected to be the most contaminated.</p></li>
<li><p>The groundwater velocity and seepage velocity across the plume.</p></li>
<li><p>The duration that the source has been contaminating the aquifer (neglect dispersion, diffusiom, and adsorption).</p></li>
<li><p>The flow rate across the plume.</p></li>
<li><p>An explaination for contamination upgradient of the source zone.</p></li>
</ol>
</div>
<div class="section" id="step-1-need-to-digitize-the-head-map">
<h3>Step 1. Need to Digitize the Head Map<a class="headerlink" href="#step-1-need-to-digitize-the-head-map" title="Permalink to this headline">¶</a></h3>
<p>Use <a class="reference external" href="https://alternativeto.net/software/g3data/?platform=windows">G3DATA</a> or something similar to digitize the head map.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">G3DATA</span></code> we will need a coordinate system, so thats superimposed on</p>
<p><img alt="" src="../../_images/Fig5.18-Coordinates.png" /></p>
<p>Next you need to open an instance of <code class="docutils literal notranslate"><span class="pre">G3DATA</span></code>. If using Windows the system should give you a windows manager, if using linux you need an X-window desktop.</p>
<div class="section" id="open-g3data">
<h4>Open G3DATA<a class="headerlink" href="#open-g3data" title="Permalink to this headline">¶</a></h4>
<p>Observe that I get the RandR warning (Resize and rotate) - this is assocated with my VNC server window, and the software still is working.  Given I am running on a Raspberry Pi over the internet, ill live with the warning.</p>
<p><img alt="" src="../../_images/openG3.png" /></p>
<p>Also notice in the program call the <code class="docutils literal notranslate"><span class="pre">-scale</span> <span class="pre">0.1</span></code> this is a trial-and-error to rescale the image so I can see what I am doing, so open and close a few times until you get the view window into a workable size.</p>
<p><img alt="" src="../../_images/G3running.png" /></p>
</div>
<div class="section" id="set-view-zoom">
<h4>Set View == Zoom<a class="headerlink" href="#set-view-zoom" title="Permalink to this headline">¶</a></h4>
<p>Next we will need to set the view window to Zoom area.  This is needed to write the level set files that we are building.</p>
<p><img alt="" src="../../_images/viewZoom.png" /></p>
</div>
<div class="section" id="set-filename">
<h4>Set Filename<a class="headerlink" href="#set-filename" title="Permalink to this headline">¶</a></h4>
<p>Here we set the file name for each level set.  We will digitize each contour line and save its coordinates to a file, then we conactenate these files after adding the Z coordinate into a single file for gridding and plotting.</p>
<p><img alt="" src="../../_images/setFileName.png" /></p>
</div>
<div class="section" id="set-xy-coordinates">
<h4>Set XY Coordinates<a class="headerlink" href="#set-xy-coordinates" title="Permalink to this headline">¶</a></h4>
<p>Here we must set the X and Y coordinates of the lower left,lower right (X) and lower left upper left (Y) to establish how we will be measuring things.</p>
<p><img alt="" src="../../_images/setXY.png" /></p>
</div>
<div class="section" id="digitize-the-contours">
<h4>Digitize the Contours<a class="headerlink" href="#digitize-the-contours" title="Permalink to this headline">¶</a></h4>
<p>Now we digitize a contour line</p>
<p><img alt="" src="../../_images/digitizeLS.png" /></p>
<p>when done, we write the points to a file.  Here is what is in the tile.</p>
<p><img alt="" src="../../_images/LSfile.png" /></p>
<p>Then clear the points (in the G3DATA program), change the file name and digitize the next line. Repeat until all the lines are complete.</p>
<p>Then open each file and add the Z-coordinate.  Lastly join each file into a single file for further processing.</p>
<p>Here is what my version looks like, the file is <code class="docutils literal notranslate"><span class="pre">Fig5.18-LevelSets.png.dat</span></code> its an ASCII file that I can read and make a contour plot, but more importantly I can grid the data to estimate x- and y- components of velocity from the given value of hydraulic conductivity.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">-</span><span class="n">Easting</span>	<span class="n">Y</span><span class="o">-</span><span class="n">Northing</span>	<span class="n">Z</span><span class="o">-</span><span class="n">Elevation</span>
<span class="o">-</span><span class="mf">0.365791375238</span>  <span class="mf">0.00426936718372</span> <span class="mf">5.5</span>
<span class="mf">7.44799110264</span>  <span class="mf">34.0524726574</span> <span class="mf">5.5</span>
<span class="mf">30.6624750375</span>  <span class="mf">65.7872126049</span> <span class="mf">5.5</span>
<span class="o">...</span>
<span class="n">many</span> <span class="n">lines</span>
<span class="o">...</span>
<span class="mf">353.704129652</span>  <span class="mf">725.957058705</span> <span class="mf">5.5</span>
<span class="mf">186.509893725</span>  <span class="mf">0.312464310759</span> <span class="mf">5.75</span>
<span class="mf">195.371098732</span>  <span class="mf">37.1933927273</span> <span class="mf">5.75</span>
<span class="mf">202.181166327</span>  <span class="mf">65.9190293167</span> <span class="mf">5.75</span>
<span class="mf">206.765265923</span>  <span class="mf">96.4487403766</span> <span class="mf">5.75</span>
<span class="o">...</span>
<span class="n">many</span> <span class="n">lines</span>
<span class="o">...</span>
<span class="mf">486.889653936</span>  <span class="mf">722.268859129</span> <span class="mf">5.75</span>
<span class="mf">362.749010841</span>  <span class="o">-</span><span class="mf">18.4586090188</span> <span class="mf">6.0</span>
<span class="mf">367.376818083</span>  <span class="mf">9.58126046662</span> <span class="mf">6.0</span>
<span class="o">...</span>
<span class="n">many</span> <span class="n">lines</span>
<span class="o">...</span>
<span class="mf">595.939191403</span>  <span class="mf">718.506746134</span> <span class="mf">6.0</span>
<span class="mf">502.803399911</span>  <span class="o">-</span><span class="mf">17.6039350757</span> <span class="mf">6.25</span>
<span class="mf">512.271308678</span>  <span class="mf">26.3822876764</span> <span class="mf">6.25</span>
<span class="mf">520.432150683</span>  <span class="mf">61.4932965599</span> <span class="mf">6.25</span>
<span class="mf">525.047470026</span>  <span class="mf">90.2445493523</span> <span class="mf">6.25</span>
<span class="o">...</span>
<span class="n">many</span> <span class="n">lines</span>
<span class="o">...</span>
<span class="mf">708.769440297</span>  <span class="mf">624.373336948</span> <span class="mf">6.25</span>
<span class="mf">637.755441575</span>  <span class="o">-</span><span class="mf">17.7565649526</span> <span class="mf">6.50</span>
<span class="mf">649.674100524</span>  <span class="mf">11.6206838032</span> <span class="mf">6.50</span>
<span class="o">...</span>
<span class="n">many</span> <span class="n">lines</span>
<span class="o">...</span>
<span class="mf">885.881149356</span>  <span class="mf">618.394355043</span> <span class="mf">6.50</span>
<span class="mf">901.700715759</span>  <span class="o">-</span><span class="mf">11.9467567219</span> <span class="mf">6.75</span>
<span class="mf">909.60191353</span>  <span class="mf">17.1217634194</span> <span class="mf">6.75</span>
<span class="o">...</span>
<span class="n">many</span> <span class="n">lines</span>
<span class="o">...</span>
<span class="mf">976.769639356</span>  <span class="mf">628.357723872</span> <span class="mf">6.75</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="step-2-check-the-digitization-results">
<h3>Step 2 Check the Digitization Results<a class="headerlink" href="#step-2-check-the-digitization-results" title="Permalink to this headline">¶</a></h3>
<p>Here we will now produce a contour map from the digitized map, adjust sizes and overlay on the original map to get an idea of how good we did.</p>
<p>Also will use trial-and-error to find a useable hull within the contour plot where we can capture heads and use for a particle tracking effort - we have to find a rectangle with non-null interpolation values; easiest way (my opinion) is to try indices until can find a reasonable rectangle then sample from that rectangle.  The process is documented below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The interpolation algorithm does not estimate vales outside the convex hull defined by the observation data.  So the box below is by trial-and-error to stay within the convex hull; the interpolator in this region produces useable estimates for computing the heads and velocities from just the mapped information&gt;</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># CCMR from ENGR-1330:</span>
<span class="c1"># http://54.243.252.9/engr-1330-webroot/8-Labs/Lab07/Lab07.html</span>
<span class="c1"># https://clouds.eos.ubc.ca/~phil/docs/problem_solving/06-Plotting-with-Matplotlib/06.14-Contour-Plots.html</span>
<span class="c1"># https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html</span>
<span class="c1"># https://stackoverflow.com/questions/332289/how-do-you-change-the-size-of-figures-drawn-with-matplotlib</span>
<span class="c1"># https://stackoverflow.com/questions/18730044/converting-two-lists-into-a-matrix</span>
<span class="c1"># https://stackoverflow.com/questions/3242382/interpolation-over-an-irregular-grid</span>
<span class="c1"># https://stackoverflow.com/questions/33919875/interpolate-irregular-3d-data-from-a-xyz-file-to-a-regular-grid</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Fig5.18-LevelSets.png.dat&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># read an ascii file already prepared, delimiter is tabs</span>
<span class="c1">#my_xyz = pandas.read_csv(&#39;XYZSomewhereUSA.txt&#39;,sep=&#39; &#39;) # read an ascii file already prepared, delimiter is tabs</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) #examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="s1">&#39;X-Easting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="s1">&#39;Y-Northing&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="s1">&#39;Z-Elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use cubic spline interpolation (other choices are nearest and linear)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">fill_value</span> <span class="o">=</span> <span class="s1">&#39;nan&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Indices of black box on overlay below:&quot;</span><span class="p">)</span>
<span class="n">ixl</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">ixh</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">iyl</span> <span class="o">=</span> <span class="mi">27</span>
<span class="n">iyh</span> <span class="o">=</span> <span class="mi">62</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xyz lower left corner &quot;</span><span class="p">,</span><span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixl</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixl</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixl</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xyz lower right corner&quot;</span><span class="p">,</span><span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixh</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixh</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixh</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xyz upper left corner &quot;</span><span class="p">,</span><span class="n">X</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixl</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixl</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixl</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xyz upper right corner &quot;</span><span class="p">,</span><span class="n">X</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixh</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixh</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixh</span><span class="p">])</span>
<span class="n">xxl</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixl</span><span class="p">]</span>
<span class="n">xxh</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixh</span><span class="p">]</span>
<span class="n">yyl</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixl</span><span class="p">]</span>
<span class="n">yyh</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixh</span><span class="p">]</span>
<span class="n">flag</span><span class="o">=</span><span class="kc">True</span>
<span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.00</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">]</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.autolayout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;Fig5.18-Coordinates.png&quot;</span><span class="p">)</span> <span class="c1"># base image</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">if</span> <span class="n">flag</span><span class="p">:</span> 
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span><span class="c1"># sets X and Y plot window of basemap</span>
<span class="c1">#fig.set_size_inches(14, 7)</span>
<span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">5.50</span><span class="p">,</span><span class="mf">5.75</span><span class="p">,</span><span class="mf">6.00</span><span class="p">,</span><span class="mf">6.25</span><span class="p">,</span><span class="mf">6.50</span><span class="p">,</span><span class="mf">6.75</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot from Gridded Data File&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">800</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyl</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyh</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxl</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxh</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Indices of black box on overlay below:
xyz lower left corner  90.9090909090909 200.0 5.478952367771485
xyz lower right corner 909.090909090909 200.0 6.722448985544166
xyz upper left corner  90.9090909090909 588.8888888888889 5.302942021834024
xyz upper right corner  909.090909090909 588.8888888888889 6.663235234576626
</pre></div>
</div>
<img alt="../../_images/3advection_12_1.png" src="../../_images/3advection_12_1.png" />
</div>
</div>
<p>This is acceptable.  Now we will extract velocities from the gridded data files - using the “box”.  Recall to use the spreadsheet version of the particle tracker we need the <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> fields from the head distribution.</p>
<p>We will use the supplied hydraulic conductivity and porosity</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(K~\approx~ 1.5 \times 10^{-2}~\frac{cm}{s} \cdot \frac{1~in}{2.54~cm} \cdot \frac{1~ft}{12~in} \cdot \frac{86400~s}{1~day} = 42.52~\frac{ft}{day}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(n~\approx~ 0.30 \)</span></p></li>
</ul>
<p>And apply Darcy’s law as</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\textbf{u(x,y)} = -\frac{K}{n}\cdot \frac{\Delta h}{\Delta x}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\textbf{v(x,y)} = -\frac{K}{n}\cdot \frac{\Delta h}{\Delta y}\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Conductivity</span> <span class="o">=</span> <span class="mf">42.52</span> <span class="c1"># feet/day</span>
<span class="n">Porosity</span> <span class="o">=</span> <span class="mf">0.30</span> <span class="c1"># voids/bulk</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="n">iyh</span> <span class="o">-</span> <span class="n">iyl</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="n">ixh</span> <span class="o">-</span> <span class="n">ixl</span>
<span class="c1">#Zero vectors for the velocity fields</span>
<span class="n">U</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">V</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">#Zero vectors for realinged mesh grid</span>
<span class="n">XG</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">YG</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> <span class="c1">#range(nrows)</span>
        <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="p">(</span><span class="n">Conductivity</span><span class="o">/</span><span class="n">Porosity</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">Z</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#- K dh/dx</span>
        <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="p">(</span><span class="n">Conductivity</span><span class="o">/</span><span class="n">Porosity</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">Z</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">])</span> <span class="c1">#- K dh/dy</span>
        <span class="n">XG</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">]</span>
        <span class="n">YG</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Suppose we want a plot of the vector field just to check our work, a nice tool is <code class="docutils literal notranslate"><span class="pre">quiver</span></code> and/or <code class="docutils literal notranslate"><span class="pre">streamplot</span></code> which are demonstrated below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert to numpy arrays</span>
<span class="n">UU</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="n">VV</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">XX</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">XG</span><span class="p">)</span>
<span class="n">YY</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">YG</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">UU</span><span class="p">[</span><span class="mi">30</span><span class="p">][</span><span class="mi">30</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.22504528917472658
</pre></div>
</div>
</div>
</div>
<p>Now a cool “quiver” plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.00</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">]</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.autolayout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;Fig5.18-Coordinates.png&quot;</span><span class="p">)</span> <span class="c1"># base image</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">if</span> <span class="n">flag</span><span class="p">:</span> 
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span><span class="c1"># sets X and Y plot window of basemap</span>
<span class="c1">#fig.set_size_inches(14, 7)</span>
<span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">5.50</span><span class="p">,</span><span class="mf">5.75</span><span class="p">,</span><span class="mf">6.00</span><span class="p">,</span><span class="mf">6.25</span><span class="p">,</span><span class="mf">6.50</span><span class="p">,</span><span class="mf">6.75</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">XX</span><span class="p">[::</span><span class="mi">6</span><span class="p">,</span> <span class="p">::</span><span class="mi">6</span><span class="p">],</span> <span class="n">YY</span><span class="p">[::</span><span class="mi">6</span><span class="p">,</span> <span class="p">::</span><span class="mi">6</span><span class="p">],</span> <span class="n">UU</span><span class="p">[::</span><span class="mi">6</span><span class="p">,</span> <span class="p">::</span><span class="mi">6</span><span class="p">],</span> <span class="n">VV</span><span class="p">[::</span><span class="mi">6</span><span class="p">,</span> <span class="p">::</span><span class="mi">6</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;width&#39;</span><span class="p">)</span>
<span class="c1">#ax.clabel(CS, inline=2, fontsize=12)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Vector Plot from Gridded Data File&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">800</span><span class="p">]);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyl</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyh</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxl</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxh</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">);</span>

<span class="c1">#matplotlib.pyplot.quiver(XX[::6, ::6], YY[::6, ::6], UU[::6, ::6], VV[::6, ::6], units=&#39;width&#39;)</span>
<span class="c1">#matplotlib.pyplot.streamplot(XX, YY, UU, VV, density=0.5, linewidth=2, color=None)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3advection_19_0.png" src="../../_images/3advection_19_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.00</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">]</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.autolayout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;Fig5.18-Coordinates.png&quot;</span><span class="p">)</span> <span class="c1"># base image</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">if</span> <span class="n">flag</span><span class="p">:</span> 
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span><span class="c1"># sets X and Y plot window of basemap</span>
<span class="c1">#fig.set_size_inches(14, 7)</span>
<span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">5.50</span><span class="p">,</span><span class="mf">5.75</span><span class="p">,</span><span class="mf">6.00</span><span class="p">,</span><span class="mf">6.25</span><span class="p">,</span><span class="mf">6.50</span><span class="p">,</span><span class="mf">6.75</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">UU</span><span class="p">,</span> <span class="n">VV</span><span class="p">,</span>  <span class="n">density</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1">#ax.clabel(CS, inline=2, fontsize=12)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Vector Plot from Gridded Data File&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">800</span><span class="p">]);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyl</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyh</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxl</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxh</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3advection_20_0.png" src="../../_images/3advection_20_0.png" />
</div>
</div>
<p>Now we can implement a particle tracking script.  Using the spreadsheet as a guide we can write it in python, and access the cool graphics.</p>
<p>Here is the basic script, one simply has to wrap it into a time-stepping loop to produce a trajectory.  Multiple particles can be managed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># U array x-velocity at XG,YG</span>
<span class="c1"># V array y-velocity at XG,YG</span>
<span class="c1"># XG array X-value of cell center</span>
<span class="c1"># YG array Y-value of cell center</span>
<span class="c1"># XP X-value of particle position </span>
<span class="c1"># YP Y-value of particle position</span>
<span class="c1"># UP x-velocity of particle </span>
<span class="c1"># VP y-velocity of particle</span>
<span class="c1"># TX x-component particle trajectory</span>
<span class="c1"># TY y-component particle trajectory</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
<span class="n">terse</span><span class="o">=</span><span class="kc">False</span>
<span class="n">deltaT</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">etime</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">numTime</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">XP</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">YP</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">UP</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">VP</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">TX</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#trajectory vector</span>
<span class="n">TY</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">np</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Total particles </span>
<span class="n">XP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">900</span><span class="p">)</span>
<span class="n">YP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">290</span><span class="p">)</span>
<span class="n">UP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">VP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ip</span><span class="o">=</span><span class="n">np</span><span class="o">-</span><span class="mi">1</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;                   Initial Particle Position&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">UP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">VP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">etime</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># move particles this time step</span>
<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numTime</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="p">):</span>
    <span class="c1"># Build Particle Distance Table</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> <span class="c1">#range(nrows)</span>
                <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">XX</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">YY</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
                <span class="n">index</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">count</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="c1"># use to find i,j for a given index</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span><span class="mi">1</span>
    <span class="c1"># find closest cell</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dist</span><span class="p">):</span>
                <span class="c1">#print(index[i],dist[i])</span>
                <span class="n">ixx</span><span class="o">=</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">jyy</span><span class="o">=</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># use nearest cell assignment - aka simple scheme</span>
                <span class="n">UP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span> <span class="o">=</span> <span class="n">UU</span><span class="p">[</span><span class="n">ixx</span><span class="p">][</span><span class="n">jyy</span><span class="p">]</span>
                <span class="n">VP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span> <span class="o">=</span> <span class="n">VV</span><span class="p">[</span><span class="n">ixx</span><span class="p">][</span><span class="n">jyy</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Particle Position and Velocities Before Move&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">UP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">VP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">etime</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
                <span class="k">break</span> <span class="c1">#exits the loop - we stop at the first nearest cell encountered</span>
    <span class="c1"># move the particle</span>
        <span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="o">=</span><span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="o">+</span><span class="n">UP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="o">*</span><span class="n">deltaT</span>
        <span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="o">=</span><span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="o">+</span><span class="n">VP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="o">*</span><span class="n">deltaT</span>
        <span class="n">etime</span><span class="o">=</span><span class="n">etime</span><span class="o">+</span><span class="n">deltaT</span>
        <span class="k">if</span> <span class="n">terse</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Particle Position and Velocities After Move&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">UP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">VP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">etime</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">TX</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="n">etime</span><span class="p">])</span>
        <span class="n">TY</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="n">etime</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                   Initial Particle Position 900 290 0 0 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.00</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">]</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.autolayout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;Fig5.18-Coordinates.png&quot;</span><span class="p">)</span> <span class="c1"># base image</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">if</span> <span class="n">flag</span><span class="p">:</span> 
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span><span class="c1"># sets X and Y plot window of basemap</span>
<span class="c1">#fig.set_size_inches(14, 7)</span>
<span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">5.50</span><span class="p">,</span><span class="mf">5.75</span><span class="p">,</span><span class="mf">6.00</span><span class="p">,</span><span class="mf">6.25</span><span class="p">,</span><span class="mf">6.50</span><span class="p">,</span><span class="mf">6.75</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">UU</span><span class="p">,</span> <span class="n">VV</span><span class="p">,</span>  <span class="n">density</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1">#ax.clabel(CS, inline=2, fontsize=12)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Vector Plot from Gridded Data File</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
            <span class="s1">&#39;Each Marker is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">deltaT</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; days</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
            <span class="s1">&#39;Total Time is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">etime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; days&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">800</span><span class="p">]);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyl</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyh</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxl</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxh</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">xtrajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">sublist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">TX</span><span class="p">]</span>
<span class="n">ytrajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">sublist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">TY</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtrajectory</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ytrajectory</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtrajectory</span><span class="p">,</span><span class="n">ytrajectory</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="p">;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;&#39;
</pre></div>
</div>
<img alt="../../_images/3advection_23_1.png" src="../../_images/3advection_23_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">43</span><span class="o">/.</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.25</span><span class="o">/</span><span class="mi">700</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.255952380952381
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">700</span><span class="o">/.</span><span class="mi">25</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2800.0
</pre></div>
</div>
</div>
</div>
<p>A useful exercise is to modify the script(s) above for multiple particles to inform the plume age (assuming I have the velocities correctly computed).</p>
</div>
</div>
<div class="section" id="flownets-pp-30-34">
<h2>Flownets (pp. 30-34)<a class="headerlink" href="#flownets-pp-30-34" title="Permalink to this headline">¶</a></h2>
<p>A related concept is flownets as outlined in <a class="reference external" href="http://54.243.252.9/ce-5364-webroot/3-Readings/flownet_1.pdf">Cleveland, T.G. (2002) <em>Flownets</em> Notes to accompany “CIVE 7332 Flow and Transport Modeling for Environmental Engineering” at University of Houston</a></p>
<p>Numerical generation of flownets can be accomplished using a spreadsheet, python script, or MODFLOW.</p>
<p>A simple spreadsheet example is available from</p>
<p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/ce5364notes/chapters/5nonreactivetransport/VelocityPotential-StreamFunction-FDM.xls">Cleveland, T.G. (1997) <em>Velocity Potential - Stream Function Ideal Flow Model (circa 1999) (Excel)</em></a></p>
<div class="section" id="theory-in-progress">
<h3>Theory (in progress)<a class="headerlink" href="#theory-in-progress" title="Permalink to this headline">¶</a></h3>
<p>A flow net is a coutour plot of <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\Psi\)</span>.</p>
</div>
<div class="section" id="example-in-python">
<h3>Example in Python<a class="headerlink" href="#example-in-python" title="Permalink to this headline">¶</a></h3>
<p>In steady aquifer flow, the flow is irrotational (or at least can be modeled as such).
There exists an orthogonal function called the stream function (it is the function that exists in the flow field when vorticity is zero).
A really good explaination of stream functions (and streamlines) appears on pages 381–398 in Zheng(1995).</p>
<p>This function can be used to generate plots of streamlines for the same system.
The principal changes are the material properties representation and the boundary conditions.</p>
<div class="section" id="velocity-potential">
<h4>Velocity Potential<a class="headerlink" href="#velocity-potential" title="Permalink to this headline">¶</a></h4>
<p>The velocity potential function is usually Darcy’s law applied to the head distribution <span class="math notranslate nohighlight">\(\phi = \frac{T}{b}h\)</span></p>
<p>If we start with a steady flow description of GW flow like:</p>
<div class="math notranslate nohighlight">
\[
0= 
\frac{\partial}{\partial x}({\frac{T_x}{b} \frac{\partial h}{\partial x}})
+
\frac{\partial}{\partial y}({\frac{T_y}{b} \frac{\partial h}{\partial y}})
\]</div>
<p>the terms <span class="math notranslate nohighlight">\({\frac{T_x}{b} \frac{\partial h}{\partial x}}\)</span>  and <span class="math notranslate nohighlight">\({\frac{T_y}{b} \frac{\partial h}{\partial y}}\)</span> can be replaced by <span class="math notranslate nohighlight">\(\frac{\partial \phi}{\partial x}\)</span> or <span class="math notranslate nohighlight">\(\frac{\partial \phi}{\partial y}\)</span> so the expression looks something like</p>
<div class="math notranslate nohighlight">
\[
0= 
\frac{\partial}{\partial x}({ \frac{\partial \phi}{\partial x}})
+
\frac{\partial}{\partial y}({ \frac{\partial \phi}{\partial y}})
\]</div>
<p>Which is what we would call the velocity potential - although for flow nets we usually just solve for the head so we can compute pressures, using the formulation below:</p>
<div class="math notranslate nohighlight">
\[
0= 
\frac{\partial}{\partial x}({{T_x} \frac{\partial h}{\partial x}})
+
\frac{\partial}{\partial y}({{T_y} \frac{\partial h}{\partial y}})
\]</div>
<p>The difference equation (pp. 349-357) on a regular grid is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
0= 
[\frac{1}{\Delta x} T_{x} \frac{h_{i-1,j} - h_{i,j}}{\Delta x} +
 \frac{1}{\Delta y} T_{y} \frac{h_{i,j-1} - h_{i,j}}{\Delta y}] - \\
~~~~~~~~~~\\
~~~~~~~~~~[ \frac{1}{\Delta x} T_{x}  \frac{h_{i,j} - h_{i+1,j}}{\Delta x} +
  \frac{1}{\Delta y}  T_{y} \frac{h_{i,j} - h_{i,j+1}}{\Delta y} ]        
\end{matrix}        
\end{split}\]</div>
<p>Typically one approximates the spatial variation of the material properties (transmissivity) as arithmetic mean values between two cells, so making the following definitions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
A_{i,j} = \frac{1}{2 \Delta x^2}(T_{x,(i-1,j)}+T_{x,(i,j)}) \\ ~~ \\
B_{i,j} = \frac{1}{2 \Delta x^2}(T_{x,(i,j)}+T_{x,(i+1,j)})   \\ ~~ \\
C_{i,j} = \frac{1}{2 \Delta y^2}(T_{y,(i,j-1)}+T_{y,(i,j)})   \\ ~~ \\
D_{i,j} = \frac{1}{2 \Delta y^2}(T_{y,(i,j)}+T_{y,(i,j+1)})   \\ ~~ \\
\end{matrix}
\end{split}\]</div>
<p>Substitution into the difference equation yields</p>
<div class="math notranslate nohighlight">
\[
0 = A_{i,j}h_{i-1,j} + B_{i,j}h_{i+1,j} - (A_{i,j}+B_{i,j}+C_{i,j}+D_{i,j})h_{i,j} + C_{i,j}h_{i,j-1} + D_{i,j}h_{i,j+1}
\]</div>
<p>As before we can explicitly write the cell equation for <span class="math notranslate nohighlight">\(h_{i,j}\)</span> as</p>
<div class="math notranslate nohighlight">
\[
h_{i,j} = \frac{[A_{i,j}h_{i-1,j} + B_{i,j}h_{i+1,j} + C_{i,j}h_{i,j-1} + D_{i,j}h_{i,j+1}]}{[A_{i,j}+B_{i,j}+C_{i,j}+D_{i,j}]}
\]</div>
<p>This difference equation represents an approximation to the governing flow equation, the accuracy depending on the cell
size. Boundary conditions are applied directly into the analogs (another name for the difference equations) at appropriate
locations on the computational grid. We can generate solutions either by iteration or solving the resulting linear system; iteration is really easy to program, so for exploratory work that’s usually the approach.</p>
</div>
<div class="section" id="stream-function">
<h4>Stream Function<a class="headerlink" href="#stream-function" title="Permalink to this headline">¶</a></h4>
<p>The stream function <span class="math notranslate nohighlight">\(\Psi\)</span> is a function that is orthogonal to the velocity potential function and expressed as a partial differential equation is</p>
<div class="math notranslate nohighlight">
\[
0= 
\frac{\partial}{\partial x}({\frac{1}{T_y} \frac{\partial \Psi}{\partial x}})
+
\frac{\partial}{\partial y}({\frac{1}{T_x} \frac{\partial \Psi}{\partial y}})
\]</div>
<p>Observe how the material property is inverted and changes directional identity, otherwise the equation is structurally identical to the groundwater flow equation (for steady flow).</p>
<p>The difference equation is practically the same as above:</p>
<p>The difference equation is also almost the same</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
0= 
[\frac{1}{\Delta x} \frac{1}{T_{y}} \frac{\Psi_{i-1,j} - \Psi_{i,j}}{\Delta x} +
 \frac{1}{\Delta y} \frac{1}{T_{x}} \frac{\Psi_{i,j-1} - \Psi_{i,j}}{\Delta y}] - \\
~~~~~~~~~~\\
~~~~~~~~~~[ \frac{1}{\Delta x} \frac{1}{T_{y}}  \frac{\Psi_{i,j} - \Psi_{i+1,j}}{\Delta x} +
  \frac{1}{\Delta y}  \frac{1}{T_{x}} \frac{\Psi_{i,j} - \Psi_{i,j+1}}{\Delta y} ]        
\end{matrix}        
\end{split}\]</div>
<p>The substitutions are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
A_{i,j} = \frac{1}{2 \Delta x^2}(T_{y,(i-1,j)}^{-1}+T_{y,(i,j)}^{-1}) \\ ~~ \\
B_{i,j} = \frac{1}{2 \Delta x^2}(T_{y,(i,j)}^{-1}+T_{y,(i+1,j)}^{-1})   \\ ~~ \\
C_{i,j} = \frac{1}{2 \Delta y^2}(T_{x,(i,j-1)}^{-1}+T_{x,(i,j)}^{-1})   \\ ~~ \\
D_{i,j} = \frac{1}{2 \Delta y^2}(T_{x,(i,j)}^{-1}+T_{x,(i,j+1)}^{-1})   \\ ~~ \\
\end{matrix}
\end{split}\]</div>
<p>Substitution into the difference equation yields</p>
<div class="math notranslate nohighlight">
\[
0 = A_{i,j}\Psi_{i-1,j} + B_{i,j}\Psi_{i+1,j} - (A_{i,j}+B_{i,j}+C_{i,j}+D_{i,j})\Psi_{i,j} + C_{i,j}\Psi_{i,j-1} + D_{i,j}\Psi_{i,j+1}
\]</div>
<p>As before we can explicitly write the cell equation for <span class="math notranslate nohighlight">\(h_{i,j}\)</span> as</p>
<div class="math notranslate nohighlight">
\[
\Psi_{i,j} = \frac{[A_{i,j}\Psi_{i-1,j} + B_{i,j}\Psi_{i+1,j} + C_{i,j}\Psi_{i,j-1} + D_{i,j}\Psi_{i,j+1}]}{[A_{i,j}+B_{i,j}+C_{i,j}+D_{i,j}]}
\]</div>
<p>So at this point we could literally use the same script, however boundary conditions also ``invert.’’
A no-flow head-domain boundary is a constant value stream function-domain boundary.
A constant value head-domain boundary is a zero-gradient stream function-domain boundary.</p>
<p>So a script that first solves for the head distribution, then the stream function could be used to create a flownet.</p>
</div>
</div>
<div class="section" id="sheetpile-under-a-dam-flownet">
<h3>Sheetpile under a dam flownet<a class="headerlink" href="#sheetpile-under-a-dam-flownet" title="Permalink to this headline">¶</a></h3>
<p>Compare to the example shown on pp. 30-34.</p>
<p>The figure below is a schematic of a dam built upon a permeable ground layer 80 meters thick (segment A to I).</p>
<p><img alt="" src="../../_images/sheetpile1.png" /></p>
<p>The dam has a base 60 meters long (segment B to F), with an upstream water depth of 10 meters. The downstream side of the dam is at 0 meters depth (otherwise its not a very good dam!). A sheetpile cutoff wall is installed beneath the dam (segment C to D to U to E). The ground layer has a hydraulic conductivity of K = 1 × 10−4 meters per second.</p>
<p>Important engineering questions are what is the pore water pressure under the dam, and is what is the total seepage under the dam? The pore water pressure can be found by solving for heads under the dam then subtracting the elevation of the computation location relative to a datum. The flow is found by Darcy’s law applied under the dam (shown as locations 1,2,3,4, and 5 in the sketch), which in turn requires computation of head under the dam. Thus the questions are answered by finding the head distribution under the dam.</p>
<p>The flow field (mathematically) extends an infinite distance upstream and downstream, but as a practical matter the contribution to seepage far upstream of the dam is negligible, and hence is approximated by the finite domain depicted.</p>
<p>Using the tools we have already we can simply build an input file, run our script and determine the head distribution (and thus compute the discharges under the dam. Then rerun with same script, but modify the boundary conditions and material properties to obtain the stream function - plot both solutions on the same contour map and viola we have a flownet.</p>
<p>The first is to represent the domain as shown, and make the following specifications in the boundary condition information, and we will treat the sheetpile cutoff wall as a low permeability inclusion (much like the the prior example). The boundary conditions are:</p>
<ol class="simple">
<li><p>The segment from A to B is a constant head boundary with value equal to 10.</p></li>
<li><p>The segment from B to F is a zero-flux boundary.</p></li>
<li><p>The segment from B to C to D to U to E to F should be treated as a zero-flux boundary, but our mask does not extend into the interior – however the sheetpile itself can be approximated by providing a very small permeability. Alternately we could (should) modify the code to handle interior boundaries – but that is outside the scope of this chapter.</p></li>
<li><p>The segment from F to G is a constant head boundary with value equal to 0.</p></li>
<li><p>The segment form G to H is a constant head boundary with value equal to 0.</p></li>
<li><p>The segment from H to I is a zero-flux boundary.</p></li>
<li><p>The segment from I to A is a constant head boundary with value equal to 10.</p></li>
</ol>
<p>Here’s the input file for the heads <span class="math notranslate nohighlight">\(\phi\)</span> in the picture</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span>
<span class="mi">10</span>
<span class="mi">1</span>
<span class="mi">9</span>
<span class="mi">31</span>
<span class="mf">1e-12</span>
<span class="mi">5000</span>
<span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span> <span class="mi">30</span> <span class="mi">40</span> <span class="mi">50</span> <span class="mi">60</span> <span class="mi">70</span> <span class="mi">80</span> <span class="mi">90</span> <span class="mi">100</span> <span class="mi">110</span> <span class="mi">120</span> <span class="mi">130</span> <span class="mi">140</span> <span class="mi">150</span> <span class="mi">160</span> <span class="mi">170</span> <span class="mi">180</span> <span class="mi">190</span> <span class="mi">200</span> <span class="mi">210</span> <span class="mi">220</span> <span class="mi">230</span> <span class="mi">240</span> <span class="mi">250</span> <span class="mi">260</span> <span class="mi">270</span> <span class="mi">280</span> <span class="mi">290</span> <span class="mi">300</span>
<span class="mi">80</span> <span class="mi">70</span> <span class="mi">60</span> <span class="mi">50</span> <span class="mi">40</span> <span class="mi">30</span> <span class="mi">20</span> <span class="mi">10</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.00010</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;PotentialFnSheetpile1.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force new matrix</span>
<span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(head)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(headold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>

<span class="c1"># Boundary Conditions</span>

<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
            <span class="n">head</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
            <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
        <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
        <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span> <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in velocity potential because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="c1">############# Contour Plot</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">my_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
<span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
<span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
<span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">3000</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">800</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">levels1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot of Heads from Sheetpile1 Input&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in velocity potential because tolerance met 
Iterations = 443
End Calculations
Iterations    =  443
Closure Error =  0.0
Head Map
----
0 [10.    10.    10.    10.    10.    10.    10.    10.    10.    10.
 10.    10.    10.    10.     9.478  0.524  0.     0.     0.     0.
  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  0.   ]
1 [10.     9.98   9.959  9.936  9.91   9.881  9.848  9.808  9.763  9.71
  9.652  9.591  9.535  9.497  9.478  0.524  0.505  0.467  0.411  0.351
  0.293  0.241  0.196  0.157  0.125  0.097  0.073  0.052  0.034  0.016
  0.   ]
2 [10.     9.96   9.919  9.874  9.824  9.767  9.701  9.623  9.532  9.426
  9.306  9.178  9.054  8.965  8.949  1.055  1.039  0.95   0.827  0.699
  0.58   0.475  0.385  0.309  0.244  0.19   0.143  0.102  0.066  0.032
  0.   ]
3 [10.     9.943  9.883  9.818  9.746  9.663  9.566  9.451  9.316  9.156
  8.969  8.759  8.538  8.351  8.336  1.67   1.654  1.468  1.247  1.038
  0.852  0.694  0.56   0.448  0.354  0.275  0.207  0.148  0.095  0.047
  0.   ]
4 [10.     9.927  9.852  9.77   9.678  9.572  9.448  9.3    9.124  8.912
  8.657  8.351  7.986  7.559  6.629  3.379  2.448  2.021  1.657  1.352
  1.098  0.888  0.714  0.57   0.45   0.348  0.262  0.187  0.121  0.059
  0.   ]
5 [10.     9.915  9.827  9.731  9.623  9.499  9.353  9.179  8.968  8.711
  8.395  8.002  7.498  6.806  5.702  4.307  3.202  2.511  2.007  1.615
  1.301  1.046  0.838  0.667  0.526  0.407  0.306  0.219  0.141  0.069
  0.   ]
6 [10.     9.907  9.81   9.704  9.586  9.448  9.287  9.093  8.858  8.569
  8.212  7.764  7.196  6.465  5.528  4.48   3.544  2.813  2.246  1.8
  1.444  1.158  0.926  0.736  0.579  0.448  0.337  0.24   0.155  0.076
  0.   ]
7 [10.     9.903  9.801  9.69   9.566  9.422  9.253  9.049  8.801  8.496
  8.118  7.647  7.057  6.33   5.467  4.542  3.679  2.952  2.364  1.894
  1.518  1.215  0.971  0.771  0.606  0.469  0.352  0.251  0.162  0.079
  0.   ]
8 [10.     9.903  9.801  9.69   9.566  9.422  9.253  9.049  8.801  8.496
  8.118  7.647  7.057  6.33   5.467  4.542  3.679  2.952  2.364  1.894
  1.518  1.215  0.971  0.771  0.606  0.469  0.352  0.251  0.162  0.079
  0.   ]
----
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Contour Plot of Heads from Sheetpile1 Input&#39;)
</pre></div>
</div>
<img alt="../../_images/3advection_30_2.png" src="../../_images/3advection_30_2.png" />
</div>
</div>
<p>Now we reuse the code, but change <code class="docutils literal notranslate"><span class="pre">head</span></code> to <code class="docutils literal notranslate"><span class="pre">stream</span></code> and modify the contour plot variable names as well as modify the input file to reflect the changed material properties and boundary conditions.</p>
<p>Here’s the input file for the stream function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span>
<span class="mi">10</span>
<span class="mi">1</span>
<span class="mi">9</span>
<span class="mi">31</span>
<span class="mf">1e-12</span>
<span class="mi">5000</span>
<span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span> <span class="mi">30</span> <span class="mi">40</span> <span class="mi">50</span> <span class="mi">60</span> <span class="mi">70</span> <span class="mi">80</span> <span class="mi">90</span> <span class="mi">100</span> <span class="mi">110</span> <span class="mi">120</span> <span class="mi">130</span> <span class="mi">140</span> <span class="mi">150</span> <span class="mi">160</span> <span class="mi">170</span> <span class="mi">180</span> <span class="mi">190</span> <span class="mi">200</span> <span class="mi">210</span> <span class="mi">220</span> <span class="mi">230</span> <span class="mi">240</span> <span class="mi">250</span> <span class="mi">260</span> <span class="mi">270</span> <span class="mi">280</span> <span class="mi">290</span> <span class="mi">300</span>
<span class="mi">80</span> <span class="mi">70</span> <span class="mi">60</span> <span class="mi">50</span> <span class="mi">40</span> <span class="mi">30</span> <span class="mi">20</span> <span class="mi">10</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">100000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
</pre></div>
</div>
<p>In these examples the value of the stream function is arbitrarily set to range from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(100\)</span>.  One useful interpretation of stream function values is that their differences indicate the flow fraction (of total flow) that flows between the streamlines (contour lines of constant stream function value).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;StreamFnSheetpile1.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">stream</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">stream</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##</span>
<span class="n">streamold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force new matrix</span>
<span class="n">streamold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="n">streamold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(stream)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(streamold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(stream)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(streamold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>

<span class="c1"># Boundary Conditions</span>

<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
            <span class="n">stream</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
            <span class="n">stream</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
        <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
        <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">stream</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span> <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(stream)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(streamold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="n">streamold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in Stream Function because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">streamold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="n">streamold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stream Function Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="c1">####################### Contour Plot ###############</span>
<span class="n">my_xyz2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">my_xyz2</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz2</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x2</span> <span class="o">=</span> <span class="n">my_xyz2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
<span class="n">coord_y2</span> <span class="o">=</span> <span class="n">my_xyz2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
<span class="n">coord_z2</span> <span class="o">=</span> <span class="n">my_xyz2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
<span class="n">coord_xy2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x2</span><span class="p">,</span> <span class="n">coord_y2</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x2</span><span class="p">),</span> <span class="mi">3000</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y2</span><span class="p">),</span> <span class="mi">800</span><span class="p">)</span>
<span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z2</span><span class="p">),</span> <span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">100</span><span class="p">]</span>
<span class="n">CS2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">levels</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS2</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot of Stream Function for Sheetpile1 Input&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in Stream Function because tolerance met 
Iterations = 396
End Calculations
Iterations    =  396
Closure Error =  0.0
Stream Function Map
----
0 [100.     96.845  93.555  89.987  85.989  81.394  76.015  69.642  62.046
  52.99   42.26   29.74   15.542   0.191   0.      0.      0.19   15.469
  29.592  42.031  52.669  61.62   69.093  75.318  80.519  84.898  88.632
  91.878  94.773  97.442 100.   ]
1 [100.     96.845  93.555  89.987  85.989  81.394  76.015  69.642  62.046
  52.99   42.26   29.74   15.542   0.191   0.16    0.16    0.19   15.469
  29.592  42.031  52.669  61.62   69.093  75.318  80.519  84.898  88.632
  91.878  94.773  97.442 100.   ]
2 [100.     96.982  93.832  90.416  86.586  82.178  77.008  70.865  63.507
  54.663  44.05   31.419  16.694   0.337   0.304   0.304   0.336  16.625
  31.277  43.83   54.356  63.099  70.34   76.342  81.342  85.543  89.121
  92.229  94.999  97.553 100.   ]
3 [100.     97.249  94.377  91.26   87.76   83.724  78.976  73.304  66.452
  58.105  47.859  35.19   19.48    0.47    0.432   0.432   0.47   19.416
  35.061  47.658  57.826  66.081  72.825  78.369  82.963  86.81   90.08
  92.916  95.443  97.77  100.   ]
4 [100.     97.636  95.168  92.486  89.47   85.984  81.867  76.921  70.894
  63.447  54.089  42.004  25.566   0.634   0.541   0.541   0.634  25.509
  41.891  53.916  63.207  70.575  76.51   81.346  85.33   88.655  91.473
  93.914  96.085  98.085 100.   ]
5 [100.     98.128  96.172  94.045  91.65   88.875  85.587  81.619  76.754
  70.701  63.045  53.171  40.146  22.721   0.665   0.665  22.703  40.095
  53.079  62.907  70.511  76.502  81.294  85.175  88.358  91.005  93.244
  95.18   96.901  98.484 100.   ]
6 [100.     98.703  97.348  95.872  94.209  92.279  89.987  87.213  83.804
  79.559  74.22   67.487  59.128  49.437  40.688  40.683  49.419  59.09
  67.422  74.124  79.426  83.629  86.988  89.702  91.921  93.763  95.318
  96.661  97.853  98.95  100.   ]
7 [100.     99.336  98.643  97.888  97.036  96.046  94.869  93.443  91.689
  89.509  86.79   83.43   79.442  75.211  71.965  71.962  75.201  79.422
  83.396  86.74   89.442  91.6    93.328  94.723  95.863  96.808  97.604
  98.292  98.902  99.463 100.   ]
8 [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.
 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.
 100. 100. 100.]
----
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Contour Plot of Stream Function for Sheetpile1 Input&#39;)
</pre></div>
</div>
<img alt="../../_images/3advection_32_2.png" src="../../_images/3advection_32_2.png" />
</div>
</div>
<p>Now both plots on same canvass</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Head (Velocity Potential Map)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z2</span><span class="p">),</span> <span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">levels1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels1</span><span class="p">)</span>
<span class="n">levels2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">]</span>
<span class="n">CS2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">levels2</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS2</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Flownet for Sheetpile1 Input&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Flownet for Sheetpile1 Input&#39;)
</pre></div>
</div>
<img alt="../../_images/3advection_34_1.png" src="../../_images/3advection_34_1.png" />
</div>
</div>
<hr>
<hr>
</div>
<div class="section" id="flownet-example-2-pore-pressure-under-a-dam-domain-decomposition-approach">
<h3>Flownet Example 2 : Pore Pressure under a Dam (Domain Decomposition approach)<a class="headerlink" href="#flownet-example-2-pore-pressure-under-a-dam-domain-decomposition-approach" title="Permalink to this headline">¶</a></h3>
<p>The second way to solve this example, and perhaps better is to take advantage of
the symmetry and cut the domain in half, as</p>
<p><img alt="" src="../../_images/sheetpile2.png" /></p>
<p>In this method we can actually specify the sheetpile as a boundary, and we will obtain the about same results, but
only need to supply half as much input data.</p>
<p>Here’s the input file for the half-domain head calculations</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span>
<span class="mi">10</span>
<span class="mi">1</span>
<span class="mi">9</span>
<span class="mi">15</span>
<span class="mf">1e-16</span>
<span class="mi">5000</span>
<span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span> <span class="mi">30</span> <span class="mi">40</span> <span class="mi">50</span> <span class="mi">60</span> <span class="mi">70</span> <span class="mi">80</span> <span class="mi">90</span> <span class="mi">100</span> <span class="mi">110</span> <span class="mi">120</span> <span class="mi">130</span> <span class="mi">140</span>
<span class="mi">80</span> <span class="mi">70</span> <span class="mi">60</span> <span class="mi">50</span> <span class="mi">40</span> <span class="mi">30</span> <span class="mi">20</span> <span class="mi">10</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">5</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">5</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">5</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">5</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">5</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;PotentialFnSheetpile2.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force new matrix</span>
<span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(head)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(headold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>

<span class="c1"># Boundary Conditions</span>

<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
            <span class="n">head</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
            <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
        <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
        <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span> <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in velocity potential because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="c1">############# Contour Plot</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">my_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
<span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
<span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
<span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">3000</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">800</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">levels1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot of Heads from Sheetpile2 Input&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in velocity potential because tolerance met 
Iterations = 412
End Calculations
Iterations    =  412
Closure Error =  0.0
Head Map
----
0 [10. 10. 10. 10. 10. 10. 10. 10. 10. 10. 10. 10. 10. 10. 10.]
1 [10.     9.975  9.949  9.921  9.889  9.853  9.811  9.761  9.701  9.632
  9.552  9.466  9.384  9.329  9.329]
2 [10.     9.951  9.9    9.845  9.783  9.712  9.629  9.531  9.413  9.274
  9.111  8.928  8.742  8.602  8.602]
3 [10.     9.93   9.856  9.776  9.687  9.584  9.463  9.319  9.147  8.939
  8.69   8.393  8.056  7.734  7.734]
4 [10.     9.911  9.818  9.717  9.604  9.473  9.32   9.137  8.916  8.647
  8.316  7.9    7.353  6.544  5.   ]
5 [10.     9.896  9.788  9.67   9.538  9.385  9.206  8.992  8.733  8.416
  8.026  7.538  6.913  6.088  5.   ]
6 [10.     9.886  9.767  9.637  9.492  9.325  9.127  8.891  8.607  8.26
  7.835  7.313  6.672  5.895  5.   ]
7 [10.     9.881  9.756  9.621  9.469  9.293  9.087  8.84   8.543  8.181
  7.741  7.207  6.566  5.82   5.   ]
8 [10.     9.881  9.756  9.621  9.469  9.293  9.087  8.84   8.543  8.181
  7.741  7.207  6.566  5.82   5.   ]
----
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Contour Plot of Heads from Sheetpile2 Input&#39;)
</pre></div>
</div>
<img alt="../../_images/3advection_36_2.png" src="../../_images/3advection_36_2.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you have to do this a lot, you could automate the “file rewrite” and have the program run the two instances back to back then make the contour plots</p>
</div>
<p>Here’s the input file for the domain decomposition stream function calculations</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span>
<span class="mi">10</span>
<span class="mi">1</span>
<span class="mi">9</span>
<span class="mi">15</span>
<span class="mf">1e-16</span>
<span class="mi">5000</span>
<span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span> <span class="mi">30</span> <span class="mi">40</span> <span class="mi">50</span> <span class="mi">60</span> <span class="mi">70</span> <span class="mi">80</span> <span class="mi">90</span> <span class="mi">100</span> <span class="mi">110</span> <span class="mi">120</span> <span class="mi">130</span> <span class="mi">140</span>
<span class="mi">80</span> <span class="mi">70</span> <span class="mi">60</span> <span class="mi">50</span> <span class="mi">40</span> <span class="mi">30</span> <span class="mi">20</span> <span class="mi">10</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">100</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">0</span>
<span class="mi">100</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">0</span>
<span class="mi">100</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">0</span>
<span class="mi">100</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">0</span>
<span class="mi">100</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">0</span>
<span class="mi">100</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">0</span>
<span class="mi">100</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">0</span>
<span class="mi">100</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">0</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
<span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span> <span class="mi">100000</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;StreamFnSheetpile2.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">stream</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">stream</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##</span>
<span class="n">streamold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force new matrix</span>
<span class="n">streamold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="n">streamold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(stream)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(streamold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(stream)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(streamold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>

<span class="c1"># Boundary Conditions</span>

<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
            <span class="n">stream</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
            <span class="n">stream</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
        <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
        <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">stream</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span> <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(stream)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(streamold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="n">streamold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in Stream Function because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">streamold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="n">streamold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stream Function Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="c1">####################### Contour Plot ###############</span>
<span class="n">my_xyz2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">my_xyz2</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz2</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x2</span> <span class="o">=</span> <span class="n">my_xyz2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
<span class="n">coord_y2</span> <span class="o">=</span> <span class="n">my_xyz2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
<span class="n">coord_z2</span> <span class="o">=</span> <span class="n">my_xyz2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
<span class="n">coord_xy2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x2</span><span class="p">,</span> <span class="n">coord_y2</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x2</span><span class="p">),</span> <span class="mi">3000</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y2</span><span class="p">),</span> <span class="mi">800</span><span class="p">)</span>
<span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z2</span><span class="p">),</span> <span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">100</span><span class="p">]</span>
<span class="n">CS2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">levels</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS2</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot of Stream Function for Sheetpile2 Input&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in Stream Function because tolerance met 
Iterations = 523
End Calculations
Iterations    =  523
Closure Error =  0.0
Stream Function Map
----
0 [100.     97.905  95.718  93.34   90.663  87.566  83.901  79.49   74.106
  67.455  59.153  48.703  35.523  19.154   0.   ]
1 [100.     97.905  95.718  93.34   90.663  87.566  83.901  79.49   74.106
  67.455  59.153  48.703  35.523  19.154   0.   ]
2 [100.     97.998  95.909  93.638  91.084  88.133  84.648  80.463  75.373
  69.107  61.301  51.433  38.712  21.939   0.   ]
3 [100.     98.18   96.28   94.218  91.903  89.234  86.093  82.343  77.815
  72.298  65.51   57.018  45.952  29.889   0.   ]
4 [100.     98.441  96.815  95.051  93.076  90.806  88.149  85.001  81.245
  76.759  71.424  65.177  58.188  51.667  51.667]
5 [100.     98.769  97.486  96.097  94.544  92.766  90.696  88.265  85.406
  82.069  78.252  74.077  69.956  66.924  66.924]
6 [100.     99.15   98.264  97.305  96.237  95.017  93.604  91.958  90.046
  87.859  85.437  82.922  80.636  79.149  79.149]
7 [100.     99.566  99.114  98.625  98.081  97.461  96.745  95.916  94.962
  93.884  92.715  91.538  90.515  89.888  89.888]
8 [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.
 100.]
----
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Contour Plot of Stream Function for Sheetpile2 Input&#39;)
</pre></div>
</div>
<img alt="../../_images/3advection_38_2.png" src="../../_images/3advection_38_2.png" />
</div>
</div>
<p>Now try both contour plot same plot canvas</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Head (Velocity Potential Map)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z2</span><span class="p">),</span> <span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">levels1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels1</span><span class="p">)</span>
<span class="n">levels2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">100</span><span class="p">]</span>
<span class="n">CS2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">levels2</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS2</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Flownet for Sheetpile2 Input&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Flownet for Sheetpile2 Input&#39;)
</pre></div>
</div>
<img alt="../../_images/3advection_40_1.png" src="../../_images/3advection_40_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/ce5364notes/chapters/3advection/Advection.PDF">Zheng, C. and Bennett, G.D. (1995) pp. 3-23 <em>Applied Contaminant Transport Modeling</em> Van Nostrand Reinhold</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/3-Readings/AdvectionNotes.pdf">Cleveland, T.G. (2002) <em>Advection</em> Notes to accompany <em>“CIVE 7332 Flow and Transport Modeling for Environmental Engineering” at University of Houston</em></a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/3-Readings/parttrack_1.pdf">Cleveland, T.G. (2002) <em>Particle Tracking in a Spreadsheet</em> Notes to accompany “CIVE 7332 Flow and Transport Modeling for Environmental Engineering” at University of Houston</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/3-Readings/DFPM-Flownets.pdf">Bear, J. (1972) <em>Dynamics of Fluids in Porous Media</em> McGraw Hill (pp. 236-241)</a></p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/5nonreactivetransport"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="2flux.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Flux</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../6nonreactivetransport/4diffusion.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Diffusion</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Theodore G. Cleveland, PhD<br/>
        
            &copy; Copyright 2023.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>