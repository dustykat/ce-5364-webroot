
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3. Fundamentals (Practice) &#8212; Groundwater Transport Phenomena</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/01fundamentals/01fundamentals.practice';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5. Site Mapping Tools" href="../03site.mapping.tools/site.mapping.tools.html" />
    <link rel="prev" title="2. Fundamentals I" href="01fundamentals.science.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/gwtransport.png" class="logo__image only-light" alt="Groundwater Transport Phenomena - Home"/>
    <script>document.write(`<img src="../../_static/gwtransport.png" class="logo__image only-dark" alt="Groundwater Transport Phenomena - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Preface
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00syllabus/ce5364-syllabus-2025-3.html">0. Syllabus (Fall 2025)</a></li>

<li class="toctree-l1"><a class="reference internal" href="../00introduction/00introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="01fundamentals.science.html">2. Fundamentals I</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Fundamentals (Practice)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03site.mapping.tools/site.mapping.tools.html">5. Site Mapping Tools</a></li>





<li class="toctree-l1"><a class="reference internal" href="../03site.characterization/site.characterization.html">6. Site Characterization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04physical.transport/physical.transport.html">7. Physical Transport</a></li>



<li class="toctree-l1"><a class="reference internal" href="../04physical.transport/modeling.advection.html">8. Modeling Advection</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapters/01fundamentals/01fundamentals.practice.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/01fundamentals/01fundamentals.practice.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3. Fundamentals (Practice)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scope">Scope</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#readings">Readings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#videos">Videos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spreadsheets-programs-data">Spreadsheets/Programs/Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#flow-equations">Flow Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transport-equations">Transport Equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-and-constitutive-pieces">Variables and constitutive pieces</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#species-mass-balance-over-a-representative-elementary-volume-rev">Species mass balance over a representative elementary volume (REV)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sorption-and-retardation-a-type-of-reaction">Sorption and retardation (a type of reaction)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-instantaneous-linear-equilibrium-sorption">(a) Instantaneous linear equilibrium sorption</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-kinetic-sorption-first-order-two-rate-optional">(b) Kinetic sorption (first-order two-rate; optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-dual-porosity-mobileimmobile-optional">(c) Dual-porosity / mobile–immobile (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#canonical-forms-for-direct-use">Canonical forms (for direct use)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions-quick-reference">Boundary conditions (quick reference)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#units-and-sign-checks">Units and sign checks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-the-equations">Solving the Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#flownets">Flownets</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-in-python">Example in Python</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#velocity-potential">Velocity Potential</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stream-function">Stream Function</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sheetpile-under-a-dam-flownet">Sheetpile under a dam flownet</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flownet-example-2-pore-pressure-under-a-dam-domain-decomposition-approach">Flownet Example 2 : Pore Pressure under a Dam (Domain Decomposition approach)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-s">Exercise(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-end">Section End</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="fundamentals-practice">
<h1>3. Fundamentals (Practice)<a class="headerlink" href="#fundamentals-practice" title="Link to this heading">#</a></h1>
<div class="admonition-course-website admonition">
<p class="admonition-title">Course Website</p>
<p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/">Link to Course Website</a></p>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%html</span>
<span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span><span class="w"> </span><span class="nt">table</span><span class="w"> </span><span class="p">{</span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="cp">!important</span><span class="p">;}</span><span class="w"> </span><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style> table {margin-left: 0 !important;} </style>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">subprocess</span>
<span class="n">hostname</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="s2">&quot;hostname&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">();</span> <span class="n">username</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="s2">&quot;whoami&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">python_executable</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">;</span> <span class="n">python_version</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">;</span> <span class="n">python_version_info</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hostname: </span><span class="si">{</span><span class="n">hostname</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="sa">f</span><span class="s2">&quot;User: </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="sa">f</span><span class="s2">&quot;Python Executable: </span><span class="si">{</span><span class="n">python_executable</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="sa">f</span><span class="s2">&quot;Python Version: </span><span class="si">{</span><span class="n">python_version</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="sa">f</span><span class="s2">&quot;Python Version Info: </span><span class="si">{</span><span class="n">python_version_info</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Hostname: ip-172-26-5-168
User: sensei
Python Executable: /opt/jupyterhub/bin/python3
Python Version: 3.10.12 (main, May 27 2025, 17:12:29) [GCC 11.4.0]
Python Version Info: sys.version_info(major=3, minor=10, micro=12, releaselevel=&#39;final&#39;, serial=0)
</pre></div>
</div>
</div>
</div>
<section id="scope">
<h2>Scope<a class="headerlink" href="#scope" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>flow equations</p></li>
<li><p>transport equations</p></li>
<li><p>generating flow nets (practical)</p></li>
</ul>
</section>
<section id="readings">
<h2>Readings<a class="headerlink" href="#readings" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://www.amazon.com/Ground-Water-Contamination-Transport-Remediation/dp/0130138401">Bedient, P.B., Rifai, H. S., and Newell, C. J. (1999). <em>Groundwater Contamination: Transport, and Remediation</em> Prentice Hall. pp. 34-47, 335-391.</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Becquerel">Becquerel (radioactivity unit) - Wikipedia</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/3-Readings/FluidPropertiesReading.pdf"><em>Fluid Properties</em> excerpt from: Casey, T.J. (1992) Water and Wastewater Engineering Hydraulics. Oxford University Press pp. 1-27</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/3-Readings/TransportPhenomenonReading.pdf"><em>Transport Phenomenon</em> excerpt from: Nazarov, W.W. and Alvarez-Cohen, L (19XX) Environmental Engineering Science. Wiley. pp. 159-199 </a></p></li>
<li><p><a class="reference internal" href="#dummy"><span class="xref myst"><em>Advective and Dispersive Transport</em> excerpt from: Cheng and Bennett (20XX) Applied Contaminant Transport Modeling. Academic Press. pp. 3-59</span></a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/3-Readings/FluidMechanicsReview.PDF">Fluid Mechanics Review (handwritten notes)</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/3-Readings/ModelingPollution.PDF">Modeling Pollution (handwritten notes)</a></p></li>
<li><p><a class="reference external" href="https://pubs.usgs.gov/circ/circ1139/">Ground Water and Surface Water A Single Resource</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/3-Readings/GroundwaterReview.pdf">Cleveland, T.G. (1997) <em>Groundwater Review</em> Notes to accompany “CIVE 7332 Flow and Transport Modeling for Environmental Engineering” at University of Houston</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/ce5364notes/chapters/3advection/Advection.PDF">Zheng, C. and Bennett, G.D. (1995) pp. 3-23 <em>Applied Contaminant Transport Modeling</em> Van Nostrand Reinhold</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/3-Readings/flownet_1.pdf">Cleveland, T.G. (2002) <em>Flownets</em> Notes to accompany “CIVE 7332 Flow and Transport Modeling for Environmental Engineering” at University of Houston</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/ce5364notes/chapters/5nonreactivetransport/VelocityPotential-StreamFunction-FDM.xls">Cleveland, T.G. (1997) <em>Velocity Potential - Stream Function Ideal Flow Model (circa 1999) (Excel)</em></a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/3-Readings/AdvectionNotes.pdf">Cleveland, T.G. (2002) <em>Advection</em> Notes to accompany “CIVE 7332 Flow and Transport Modeling for Environmental Engineering” at University of Houston</a></p></li>
<li><p><a class="reference external" href="https://d1wqtxts1xzle7.cloudfront.net/31171747/195055535-libre.pdf?1392371142=&amp;amp;response-content-disposition=inline%3B+filename%3DDynamics_of_fluids_in_porous_media.pdf&amp;amp;Expires=1695231543&amp;amp;Signature=fcj7Wef3HIA7wlTx~LJhmfFgQJIrRLnrwEgqd2KIjnsouiRrFZpLAgMw-gRJ7oxI1~h89bo-YpAQuhLHZc1vtNFq5d0QBrxwYRbAvr5jztdUDHWZrfjBPYBgujy5WCnrrtoN7GKrziCwbk7mDi1AUyBnC4RDidrKgBV-bMOpJR4ZR8~L6BTEPXhBAQJbLohdpWi8Ni6VUl33~rEQaum8NMcY11P6okNvXbXKft3vdYwjEK5NXezeVe6dQpYIiBcyPVqkFahRD9CFLXLHZsxXryzDT~x9pszx86ka0kXYN9y1Y7RzyAgZQaB5YWD8XZhK4w2PoIEVgIvGeuCxxt099Q__&amp;amp;Key-Pair-Id=APKAJLOHF5GGSLRBV4ZA">Bear, J. (1972) <em>Dynamics of Fluids in Porous Media</em> McGraw Hill (pp. 236-241)</a></p></li>
</ol>
<!--(http://54.243.252.9/ce-5364-webroot/3-Readings/DFPM-Flownets.pdf)-->
</section>
<hr class="docutils" />
<section id="videos">
<h2>Videos<a class="headerlink" href="#videos" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>None</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="spreadsheets-programs-data">
<h2>Spreadsheets/Programs/Data<a class="headerlink" href="#spreadsheets-programs-data" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>None</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="flow-equations">
<h2>Flow Equations<a class="headerlink" href="#flow-equations" title="Link to this heading">#</a></h2>
<p>The governing equations for groundwater flow are derived by combining Darcy’s law—which describes how water moves through porous media under a hydraulic gradient—with the principle of mass conservation applied to a representative elementary volume (REV) of the aquifer. The result is a partial differential equation that relates changes in hydraulic head over time to the spatial variation in flow and any external sources or sinks of water. The specific form of the equation depends on the aquifer type, dimensionality, and storage properties.</p>
<p><strong>Unconfined Aquifer:</strong></p>
<p>For an unconfined aquifer, the saturated thickness of the aquifer changes as water levels rise and fall. In this case, transmissivity depends on the instantaneous head, so the conductivity terms are multiplied by
<span class="math notranslate nohighlight">\(h\)</span>. The left-hand side contains the product of the specific yield <span class="math notranslate nohighlight">\(S_y\)</span> and the rate of change of head <span class="math notranslate nohighlight">\(\frac{\partial h}{\partial t}\)</span>, reflecting the volume of water released from storage per unit surface area per unit decline in head. The right-hand side sums the divergence of the flow in the <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> directions, and adds (or subtracts) source/sink terms for recharge, pumping, or leakage.</p>
<div class="math notranslate nohighlight">
\[S_y \frac{\partial h}{\partial t} = \frac{\partial}{\partial x}(K_x h \frac{\partial h}{\partial x}) 
+ \frac{\partial}{\partial y}(K_y h \frac{\partial h}{\partial y}) \pm source/sink \]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S_y\)</span> = specific yield.</p></li>
</ul>
<p><strong>Confined Aquifer (3D) :</strong></p>
<p>In a confined aquifer, the saturated thickness remains constant, so transmissivity is independent of head. Instead, storage comes from the compressibility of the aquifer matrix and the pore water, represented in the specific storage term
<span class="math notranslate nohighlight">\(S_s =\rho g (\alpha + n \beta)\)</span>, where <span class="math notranslate nohighlight">\(\alpha\)</span> is the matrix compressibility, <span class="math notranslate nohighlight">\(\beta\)</span> is the fluid compressibility, <span class="math notranslate nohighlight">\(n\)</span> is porosity, <span class="math notranslate nohighlight">\(\rho\)</span> is fluid density, and <span class="math notranslate nohighlight">\(g\)</span> is gravitational acceleration. The fully three-dimensional form accounts for anisotropic conductivities <span class="math notranslate nohighlight">\(K_x,K_y,K_z\)</span> in all directions.</p>
<div class="math notranslate nohighlight">
\[S_s \frac{\partial h}{\partial t} = \frac{\partial}{\partial x}(K_x\frac{\partial h}{\partial x}) 
+ \frac{\partial}{\partial y}(K_y\frac{\partial h}{\partial y}) + \frac{\partial}{\partial z}(K_z\frac{\partial h}{\partial z})\pm source/sink \]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S_s =\rho g (\alpha + n \beta)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> = compressibility of porous matrix (a spring constant for the solids fraction).</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span> = compressibility of liquid (usually water).</p></li>
</ul>
<p><strong>Confined Aquifer (2D) :</strong></p>
<p>When a confined aquifer can be treated in two dimensions—for example, in a horizontal flow model—the governing equation is vertically integrated over the aquifer thickness. The result is an equation in terms of transmissivity
<span class="math notranslate nohighlight">\(T\)</span> and storage coefficient <span class="math notranslate nohighlight">\(S\)</span>, where <span class="math notranslate nohighlight">\(S\)</span> is the vertical integral of <span class="math notranslate nohighlight">\(S_s\)</span> across the aquifer thickness. This 2D form is common in regional groundwater modeling where vertical gradients are small compared to horizontal gradients, and it simplifies computations while preserving the essential physics of lateral groundwater movement.  A common extension is layers of 2D models with leakage between layers (quasi-3D).</p>
<div class="math notranslate nohighlight">
\[S \frac{\partial h}{\partial t} = \frac{\partial}{\partial x}(T_x\frac{\partial h}{\partial x}) 
+ \frac{\partial}{\partial y}(T_y\frac{\partial h}{\partial y}) \pm source/sink \]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S\)</span> = storage coefficient (<span class="math notranslate nohighlight">\(S = \int_{z_{bot}}^{z_{top}}S_s(z) dz\)</span></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Origin of these equations</p>
<p><strong>Starting Point :</strong> Darcy’s law + conservation of mass</p>
<p>Darcy’s law (vector form, possibly anisotropic):</p>
<p><span class="math notranslate nohighlight">\(𝑞=−𝐾 \nabla h\)</span></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(q\)</span> is specific discharge</p></li>
<li><p><span class="math notranslate nohighlight">\(K\)</span> is the hydraulic conductivity <strong>tensor</strong></p></li>
<li><p>h is hydraulic head (a <strong>scalar</strong> field)</p></li>
</ul>
<p>Continuity (single-phase water, small deformations):</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial(\rho \theta)}{\partial t} + \nabla \cdot (\rho q) = \rho W\)</span></p>
<p><span class="math notranslate nohighlight">\(\theta\)</span> is volumetric water content (<span class="math notranslate nohighlight">\(\approx~\)</span> porosity <span class="math notranslate nohighlight">\(n\)</span> when saturated), <span class="math notranslate nohighlight">\(W\)</span> is a volumetric source/sink per bulk volume (positive = recharge), and <span class="math notranslate nohighlight">\(ρ\)</span> is water density.</p>
<p>Assuming constant density (negligible variable-density effects) and rearranging:</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial \theta}{\partial t} + \nabla \cdot  q =  W\)</span></p>
<p>All the physics now lives in (i) how <span class="math notranslate nohighlight">\(\theta\)</span> changes with <span class="math notranslate nohighlight">\(h\)</span> (storage) and (ii) <span class="math notranslate nohighlight">\(q\)</span> from Darcy’s law.</p>
<p><strong>Confined aquifer (3D)</strong></p>
<p>In a confined aquifer, the saturated thickness is constant; storage arises from compressibility of the matrix and water. A decline <span class="math notranslate nohighlight">\(dh\)</span> produces a volumetric water release <span class="math notranslate nohighlight">\((S_s dh)\)</span> per unit bulk volume, where</p>
<p><span class="math notranslate nohighlight">\(S_s =\rho g (\alpha + n \beta)\)</span></p>
<p>Here <span class="math notranslate nohighlight">\(\alpha\)</span> is matrix compressibility, <span class="math notranslate nohighlight">\(\beta\)</span> is water compressibility <span class="math notranslate nohighlight">\(n\)</span> is porosity, <span class="math notranslate nohighlight">\(ρg\)</span> converts head to pressure.</p>
<p>Thus</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial \theta}{\partial t}~\approx~S_s\frac{\partial h}{\partial t}\)</span></p>
<p>Insert Darcy’s law <span class="math notranslate nohighlight">\(𝑞=−𝐾 \nabla h\)</span> as the equation of motion  into continuity:</p>
<p><span class="math notranslate nohighlight">\(S_s\frac{\partial h}{\partial t}+ \nabla \cdot (−K \nabla h) = W \to S_s\frac{\partial h}{\partial t}= \nabla \cdot (K \nabla h) + W\)</span></p>
<p>which in components gives the 3D confined equation:</p>
<p>$S_s \frac{\partial h}{\partial t} = \frac{\partial}{\partial x}(K_x\frac{\partial h}{\partial x})</p>
<ul class="simple">
<li><p>\frac{\partial}{\partial y}(K_y\frac{\partial h}{\partial y}) + \frac{\partial}{\partial z}(K_z\frac{\partial h}{\partial z})\pm W (source/sink) $</p></li>
</ul>
<p><strong>Confined aquifer, vertically integrated (2D)</strong></p>
<p>Integrate the 3D equation from
<span class="math notranslate nohighlight">\(z_{bot}\)</span> to <span class="math notranslate nohighlight">\(z_{top}\)</span> (aquifer thickness <span class="math notranslate nohighlight">\(B\)</span>. Define:</p>
<p><span class="math notranslate nohighlight">\(T_x = \int_{z_{bot}}^{z_{top}} K_x(z) dz~(\approx~K_xB)~~~~\)</span>   <span class="math notranslate nohighlight">\(T_y = \int_{z_{bot}}^{z_{top}} K_y(z) dz~(\approx~K_yB)~~~~\)</span>  <span class="math notranslate nohighlight">\(S = \int_{z_{bot}}^{z_{top}} S_s(z) dz~(\approx~S_sB)\)</span></p>
<p>Assuming <span class="math notranslate nohighlight">\(h\)</span> is nearly uniform with depth (Dupuit-type vertical averaging for confined systems), the vertical terms cancel on integration and sources/sinks convert to areal rates <span class="math notranslate nohighlight">\(W'\)</span>. The result is:</p>
<p>$S \frac{\partial h}{\partial t} = \frac{\partial}{\partial x}(T_x\frac{\partial h}{\partial x})</p>
<ul class="simple">
<li><p>\frac{\partial}{\partial y}(T_y\frac{\partial h}{\partial y}) \pm W’ (source/sink) $</p></li>
</ul>
<p>which is the 2D confined equation.</p>
<p><strong>Unconfined aquifer (Boussinesq form)</strong></p>
<p>For unconfined conditions, the saturated thickness equals the head above the impermeable base (take datum
<span class="math notranslate nohighlight">\(z_b\)</span>) so the thickness is <span class="math notranslate nohighlight">\(b=h−z_b~\approx h ~\text{if}~z_b=0\)</span>. Two key changes:</p>
<p><strong>Storage:</strong> draining/filling is dominated by specific yield <span class="math notranslate nohighlight">\(S_y\)</span> (drainable porosity), so</p>
<p><span class="math notranslate nohighlight">\(\frac{\partial \theta}{\partial t}~\approx~S_y \frac{\partial h}{\partial t}\)</span>.</p>
<p><strong>Transmissivity depends on head:</strong> thickness <span class="math notranslate nohighlight">\(b \simeq h\)</span>, so the horizontal fluxes use head-dependent transmissivity:</p>
<p><span class="math notranslate nohighlight">\(q_x=-K_x h \frac{\partial h}{\partial x}~~~~\)</span>,<span class="math notranslate nohighlight">\(q_y=-K_y h \frac{\partial h}{\partial y}~~~~\)</span>,</p>
<p>after invoking a Dupuit assumption (vertical gradients small compared to horizontal; vertical head distribution is nearly hydrostatic).</p>
<p>Insert into continuity (plan-view):</p>
<p>$S_y \frac{\partial h}{\partial t} = \frac{\partial}{\partial x}(K_x h \frac{\partial h}{\partial x})</p>
<ul class="simple">
<li><p>\frac{\partial}{\partial y}(K_y h \frac{\partial h}{\partial y}) \pm W’ (source/sink) $</p></li>
</ul>
<p>which is the Boussinesq equation used for unconfined flow (the equation above, with optional sources/sinks).</p>
</div>
</section>
<section id="transport-equations">
<h2>Transport Equations<a class="headerlink" href="#transport-equations" title="Link to this heading">#</a></h2>
<p>Transport builds on the same foundations as flow: the equations of motion (Darcy’s law) and mass continuity. Here we add constituent-specific processes—advection and hydrodynamic dispersion—plus reactions (e.g., decay, biodegradation) and sorption. Although sorption is a reaction, it’s often treated separately because it directly alters storage via retardation.</p>
<p>We assume a saturated medium with constant fluid density and porosity over the time scales of interest. The velocity field is obtained from the groundwater flow solution described above (using <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> or <span class="math notranslate nohighlight">\(\mathbf{v}=\mathbf{q}/n\)</span> as appropriate).</p>
<section id="variables-and-constitutive-pieces">
<h3>Variables and constitutive pieces<a class="headerlink" href="#variables-and-constitutive-pieces" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(C(\mathbf{x},t)\)</span> — dissolved concentration <span class="math notranslate nohighlight">\([M\,L^{-3}]\)</span> in the mobile (water) phase</p></li>
<li><p><span class="math notranslate nohighlight">\(s(\mathbf{x},t)\)</span> — sorbed concentration on the solid phase <span class="math notranslate nohighlight">\([M\,M^{-1}]\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> — porosity <span class="math notranslate nohighlight">\([-]\)</span>; <span class="math notranslate nohighlight">\(\ \rho_b\)</span> — bulk density of porous medium <span class="math notranslate nohighlight">\([M\,L^{-3}]\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{q}\)</span> — Darcy flux (specific discharge) <span class="math notranslate nohighlight">\([L\,T^{-1}]\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{v}=\mathbf{q}/n\)</span> — average linear (pore) velocity <span class="math notranslate nohighlight">\([L\,T^{-1}]\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{D}\)</span> — hydrodynamic dispersion tensor <span class="math notranslate nohighlight">\([L^{2}\,T^{-1}]\)</span>:
$<span class="math notranslate nohighlight">\(
\boldsymbol{D} \;=\; \tau D_m\,\mathbf{I}
\;+\; \alpha_T\,\lVert\mathbf{v}\rVert\,\mathbf{I}
\;+\; (\alpha_L-\alpha_T)\,\frac{\mathbf{v}\mathbf{v}^{\!\top}}{\lVert\mathbf{v}\rVert}
\)</span><span class="math notranslate nohighlight">\(
where \)</span>D_m<span class="math notranslate nohighlight">\( is molecular diffusion, \)</span>\tau<span class="math notranslate nohighlight">\( is tortuosity, and \)</span>\alpha_L,\alpha_T$ are longitudinal/transverse dispersivities.</p></li>
<li><p><span class="math notranslate nohighlight">\(W(\mathbf{x},t)\)</span> — volumetric water source/sink per bulk volume <span class="math notranslate nohighlight">\([T^{-1}]\)</span> (positive = water addition)</p></li>
<li><p><span class="math notranslate nohighlight">\(C_{\mathrm{in}}(\mathbf{x},t)\)</span> — concentration of water added through <span class="math notranslate nohighlight">\(W&gt;0\)</span></p></li>
</ul>
<p><strong>Dissolved mass flux</strong> (dispersion + advection):
$<span class="math notranslate nohighlight">\(
\mathbf{J} \;=\; -\,n\,\boldsymbol{D}\,\nabla C \;+\; \mathbf{q}\,C
\qquad [M\,L^{-2}\,T^{-1}].
\)</span>$</p>
</section>
<section id="species-mass-balance-over-a-representative-elementary-volume-rev">
<h3>Species mass balance over a representative elementary volume (REV)<a class="headerlink" href="#species-mass-balance-over-a-representative-elementary-volume-rev" title="Link to this heading">#</a></h3>
<p><strong>Total species mass per bulk volume:</strong>
$<span class="math notranslate nohighlight">\(
M \;=\; nC \;+\; \rho_b s.
\)</span>$</p>
<p><strong>Conservation of mass</strong> (accumulation = inflow <span class="math notranslate nohighlight">\(-\)</span> outflow <span class="math notranslate nohighlight">\(+\)</span> reactions <span class="math notranslate nohighlight">\(+\)</span> external additions):
$<span class="math notranslate nohighlight">\(
\frac{\partial}{\partial t}\big(nC + \rho_b s\big)
\;+\; \nabla\!\cdot\mathbf{J}
\;=\; nW\,C_{\mathrm{in}} \;+\; R_{\text{chem}}(C,s,\ldots),
\)</span><span class="math notranslate nohighlight">\(
where \)</span>R_{\text{chem}}<span class="math notranslate nohighlight">\( \)</span>[M,L^{-3},T^{-1}]$ is net internal production/consumption from reactions not otherwise represented (e.g., multispecies kinetics, biodegradation).</p>
<p>Insert <span class="math notranslate nohighlight">\(\mathbf{J}\)</span>:
$<span class="math notranslate nohighlight">\(
\frac{\partial}{\partial t}\big(nC + \rho_b s\big)
\;+\; \nabla\!\cdot\!\big(-\,n\boldsymbol{D}\nabla C + \mathbf{q}C\big)
\;=\; nW\,C_{\mathrm{in}} \;+\; R_{\text{chem}}.
\)</span>$</p>
<blockquote>
<div><p>Using groundwater continuity, <span class="math notranslate nohighlight">\(\nabla\!\cdot\mathbf{q}=nW\)</span>, we have<br />
<span class="math notranslate nohighlight">\(-\nabla\!\cdot(\mathbf{q}C)= -\mathbf{q}\!\cdot\nabla C \;-\; C\,\nabla\!\cdot\mathbf{q} = -\mathbf{q}\!\cdot\nabla C - nW\,C\)</span>.<br />
Together with <span class="math notranslate nohighlight">\(+\,nW\,C_{\mathrm{in}}\)</span>, the net water exchange term is <span class="math notranslate nohighlight">\(nW(C_{\mathrm{in}}-C)\)</span>.</p>
</div></blockquote>
</section>
<section id="sorption-and-retardation-a-type-of-reaction">
<h3>Sorption and retardation (a type of reaction)<a class="headerlink" href="#sorption-and-retardation-a-type-of-reaction" title="Link to this heading">#</a></h3>
<section id="a-instantaneous-linear-equilibrium-sorption">
<h4>(a) Instantaneous linear equilibrium sorption<a class="headerlink" href="#a-instantaneous-linear-equilibrium-sorption" title="Link to this heading">#</a></h4>
<p>Assume <span class="math notranslate nohighlight">\(s = K_d\,C\)</span>. Then
$<span class="math notranslate nohighlight">\(
\frac{\partial}{\partial t}(nC + \rho_b s)
= \big(n + \rho_b K_d\big)\,\frac{\partial C}{\partial t}
= n\,R_f\,\frac{\partial C}{\partial t},
\qquad
R_f \equiv 1 + \frac{\rho_b K_d}{n}.
\)</span>$</p>
<p>Substitute into the balance equation above:</p>
<div class="math notranslate nohighlight">
\[nR_f \frac{\partial C}{\partial t} = \nabla\!\cdot\!\big(n\boldsymbol{D}\nabla C\big) - \nabla \cdot(\mathbf{q}C) + nW C_{\mathrm{in}} + R_{\text{chem}}(C) - \lambda n C,\]</div>
<p>where <span class="math notranslate nohighlight">\(-\lambda n C\)</span> represents first-order aqueous decay (optional).</p>
<p>Divide by <span class="math notranslate nohighlight">\(n\)</span> and use <span class="math notranslate nohighlight">\(\mathbf{v}=\mathbf{q}/n\)</span> if preferred:</p>
<div class="math notranslate nohighlight">
\[
R_f\,\frac{\partial C}{\partial t} = \nabla\!\cdot\!\big(\boldsymbol{D}\nabla C\big) - \nabla\!\cdot(\mathbf{v}C) + W\,C_{\mathrm{in}} + \frac{R_{\text{chem}}}{n} - \lambda\ C.
\]</div>
</section>
</section>
<section id="b-kinetic-sorption-first-order-two-rate-optional">
<h3>(b) Kinetic sorption (first-order two-rate; optional)<a class="headerlink" href="#b-kinetic-sorption-first-order-two-rate-optional" title="Link to this heading">#</a></h3>
<p>Replace <span class="math notranslate nohighlight">\(s=K_d C\)</span> with
$<span class="math notranslate nohighlight">\(
\rho_b\frac{\partial s}{\partial t}
= k_a\,\rho_b C \;-\; k_d\,\rho_b s,
\)</span><span class="math notranslate nohighlight">\(
and keep \)</span>\rho_b ,\partial s/\partial t<span class="math notranslate nohighlight">\( explicitly in the accumulation term. No single \)</span>R_f$ applies; this yields a coupled PDE–ODE system.</p>
</section>
<section id="c-dual-porosity-mobileimmobile-optional">
<h3>(c) Dual-porosity / mobile–immobile (optional)<a class="headerlink" href="#c-dual-porosity-mobileimmobile-optional" title="Link to this heading">#</a></h3>
<p>Let <span class="math notranslate nohighlight">\(n = n_m + n_{im}\)</span> and introduce <span class="math notranslate nohighlight">\(C_{im}\)</span>:
$<span class="math notranslate nohighlight">\(
\begin{aligned}
&amp; n_m\frac{\partial C}{\partial t} + \rho_b\frac{\partial s}{\partial t}
\;-\; \nabla\!\cdot\!\big(n_m\boldsymbol{D}\nabla C\big) + \nabla\!\cdot(\mathbf{q}C) = nW\,C_{\mathrm{in}} + R_{\text{chem}} - \omega\,(C_{im}-C) - \lambda\,n_m C, \\[4pt] &amp; n_{im}\frac{\partial C_{im}}{\partial t} = \omega\,(C_{im}-C) - \lambda_{im}\,n_{im} C_{im}.
\end{aligned}
\)</span>$</p>
</section>
<section id="canonical-forms-for-direct-use">
<h3>Canonical forms (for direct use)<a class="headerlink" href="#canonical-forms-for-direct-use" title="Link to this heading">#</a></h3>
<p><strong>General conservative form (no assumption on sorption kinetics):</strong>
$<span class="math notranslate nohighlight">\(
\frac{\partial}{\partial t}\big(nC + \rho_b s\big)
= \nabla\!\cdot\!\big(n\boldsymbol{D}\nabla C\big) - \nabla\!\cdot(\mathbf{q}C) + nW\,C_{\mathrm{in}} + R_{\text{chem}}(C,s,\ldots) - \lambda\,nC.
\)</span>$</p>
<p><strong>Retarded ADE with first-order decay (instantaneous linear sorption):</strong>
$<span class="math notranslate nohighlight">\(
nR_f\,\frac{\partial C}{\partial t}
= \nabla\!\cdot\!\big(n\boldsymbol{D}\nabla C\big) - \nabla\!\cdot(\mathbf{q}C) + nW\,C_{\mathrm{in}} + R_{\text{chem}}(C) - \lambda\,nC.
\)</span>$</p>
<p>(Optionally divide by <span class="math notranslate nohighlight">\(n\)</span> and write in terms of <span class="math notranslate nohighlight">\(\mathbf{v}=\mathbf{q}/n\)</span>.)</p>
</section>
<section id="boundary-conditions-quick-reference">
<h3>Boundary conditions (quick reference)<a class="headerlink" href="#boundary-conditions-quick-reference" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Dirichlet (specified concentration):</strong> <span class="math notranslate nohighlight">\(C = C_b\)</span> on <span class="math notranslate nohighlight">\(\Gamma_D\)</span>.</p></li>
<li><p><strong>Neumann (specified mass flux):</strong> <span class="math notranslate nohighlight">\(\mathbf{n}\!\cdot\!\big(-n\boldsymbol{D}\nabla C + \mathbf{q}C\big) = J_b\)</span> on <span class="math notranslate nohighlight">\(\Gamma_N\)</span>.</p></li>
<li><p><strong>No-flux:</strong> <span class="math notranslate nohighlight">\(\mathbf{n}\!\cdot\!\big(-n\boldsymbol{D}\nabla C + \mathbf{q}C\big)=0\)</span>.</p></li>
</ul>
</section>
<section id="units-and-sign-checks">
<h3>Units and sign checks<a class="headerlink" href="#units-and-sign-checks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\nabla\!\cdot(n\boldsymbol{D}\nabla C)\)</span> and <span class="math notranslate nohighlight">\(-\nabla\!\cdot(\mathbf{q}C)\)</span> both have units <span class="math notranslate nohighlight">\([M\,L^{-3}\,T^{-1}]\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(nW(C_{\mathrm{in}}-C)\)</span> has units <span class="math notranslate nohighlight">\([M\,L^{-3}\,T^{-1}]\)</span>.</p></li>
<li><p>Positive <span class="math notranslate nohighlight">\(W\)</span> adds water and mass; negative <span class="math notranslate nohighlight">\(W\)</span> removes them.</p></li>
</ul>
<blockquote>
<div><p>Notes.<br />
(i) If density varies or saturation changes, retain <span class="math notranslate nohighlight">\(\rho\)</span> and use the appropriate flow equation (e.g., Richards’ equation) and variable-density transport.<br />
(ii) Spatially variable <span class="math notranslate nohighlight">\(n(\mathbf{x})\)</span> can be kept inside divergences; if you divide by <span class="math notranslate nohighlight">\(n\)</span>, handle <span class="math notranslate nohighlight">\(\nabla n\)</span> terms consistently.</p>
</div></blockquote>
</section>
</section>
<section id="solving-the-equations">
<h2>Solving the Equations<a class="headerlink" href="#solving-the-equations" title="Link to this heading">#</a></h2>
<p>Flow and transport are typically solved on the same spatial domain but with different numerical behaviors. Groundwater flow is elliptic at steady state and parabolic when storage is included; mature solvers (finite difference/volume/element with implicit time stepping) handle these problems reliably. By contrast, transport (advection–dispersion–reaction) mixes hyperbolic advection with parabolic dispersion and adds reactions, which makes it more prone to numerical artifacts (numerical dispersion, spurious oscillations, and CFL-related stability limits). As a result, transport often needs stabilization (e.g., upwinding/TVD/SUPG), careful grid design, and step-size control.</p>
<p>Where geometry and boundary conditions are simple, analytical solutions exist and are preferred for verification and insight—we will use several later. For realistic sites, we use numerical models: in this course we’ll rely on MODFLOW 6 for flow (with FloPy to script workflows), remembering that the governing equations are precisely those stated above. When reactions matter (sorption, decay, multispecies kinetics), a common and practical strategy is operator splitting: advance transport for a short step, then apply reaction kinetics locally (cell-by-cell), update concentrations, and iterate. Fully coupled (monolithic) reactive-transport solvers also exist but are more specialized. In practice, many workflows compose reliable codes via APIs—a flow solver, a transport stepper, and a reaction module—to simulate multiple interacting species without re-implementing everything from scratch.</p>
<p>To build intuition before the full machinery, the next section generates numerical flownets. These approximate head fields and streamlines under idealized conditions, making visible how boundary conditions, heterogeneity, and anisotropy shape flow patterns. The flownets give a concrete feel for what the flow solver is doing and set the stage for interpreting transport results that follow.</p>
</section>
<section id="flownets">
<h2>Flownets<a class="headerlink" href="#flownets" title="Link to this heading">#</a></h2>
<p>A flow net is a graphical representation that depicts the flow of groundwater within an aquifer or through porous media. It consists of a network of flow lines and equipotential lines that together provide a clear visualization of the groundwater flow direction and hydraulic head distribution within a given geological formation. Flow lines represent the path that groundwater particles would take as they move through the aquifer, while equipotential lines represent lines of equal hydraulic head. These lines intersect orthogonally, forming a grid-like pattern, with the density of flow lines increasing where the groundwater flow is faster.</p>
<p>Flow nets are employed in various aspects of groundwater modeling:</p>
<ol class="arabic simple">
<li><p>Delineating Flow Patterns: Flow nets are instrumental in identifying the direction and velocity of groundwater flow within an aquifer. By studying the flow lines and equipotential lines, hydrogeologists can determine the dominant flow pathways and areas of groundwater recharge and discharge.</p></li>
<li><p>Designing Well Fields: When designing well fields for groundwater extraction, it is crucial to understand the local groundwater flow patterns. Flow nets help in optimizing the placement and pumping rates of wells, ensuring efficient water supply without causing adverse effects on nearby groundwater-dependent ecosystems.</p></li>
<li><p>Contaminant Transport Modeling: Flow nets are an essential component of contaminant transport modeling. They provide the basis for predicting the movement of contaminants through the subsurface, allowing for the assessment of potential risks and the development of remediation strategies.</p></li>
<li><p>Dam and Barrier Design: Engineers use flow nets to design dams, levees, and groundwater barriers. Understanding groundwater flow patterns is critical for ensuring the stability and effectiveness of these structures in controlling water flow.</p></li>
<li><p>Land Use Planning: Flow nets also have applications in land use planning. By considering groundwater flow patterns, urban planners can make informed decisions about where to build infrastructure, manage stormwater, and protect sensitive areas from potential contamination.</p></li>
</ol>
<p>Flownets provide a visual representation of groundwater flow patterns and hydraulic head distributions, aiding in various aspects of groundwater resource management, environmental protection, and engineering design.</p>
<p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/3-Readings/flownet_1.pdf">Cleveland, T.G. (2002) <em>Flownets</em> Notes to accompany “CIVE 7332 Flow and Transport Modeling for Environmental Engineering” at University of Houston</a></p>
<p>Numerical generation of flownets can be accomplished using a spreadsheet, python script, or MODFLOW.</p>
<p>A simple spreadsheet example is available from</p>
<p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/ce5364notes/chapters/5nonreactivetransport/VelocityPotential-StreamFunction-FDM.xls">Cleveland, T.G. (1997) <em>Velocity Potential - Stream Function Ideal Flow Model (circa 1999) (Excel)</em></a></p>
<section id="example-in-python">
<h3>Example in Python<a class="headerlink" href="#example-in-python" title="Link to this heading">#</a></h3>
<p>In steady aquifer flow, the flow is irrotational (or at least can be modeled as such).
There exists an orthogonal function called the stream function (it is the function that exists in the flow field when vorticity is zero).
A really good explaination of stream functions (and streamlines) appears on pages 381–398 in Zheng(1995).</p>
<p>This function can be used to generate plots of streamlines for the same system.
The principal changes are the material properties representation and the boundary conditions.</p>
<section id="velocity-potential">
<h4>Velocity Potential<a class="headerlink" href="#velocity-potential" title="Link to this heading">#</a></h4>
<p>The velocity potential function is usually Darcy’s law applied to the head distribution <span class="math notranslate nohighlight">\(\phi = \frac{T}{b}h\)</span></p>
<p>If we start with a steady flow description of GW flow like:</p>
<div class="math notranslate nohighlight">
\[
0= 
\frac{\partial}{\partial x}({\frac{T_x}{b} \frac{\partial h}{\partial x}})
+
\frac{\partial}{\partial y}({\frac{T_y}{b} \frac{\partial h}{\partial y}})
\]</div>
<p>the terms <span class="math notranslate nohighlight">\({\frac{T_x}{b} \frac{\partial h}{\partial x}}\)</span>  and <span class="math notranslate nohighlight">\({\frac{T_y}{b} \frac{\partial h}{\partial y}}\)</span> can be replaced by <span class="math notranslate nohighlight">\(\frac{\partial \phi}{\partial x}\)</span> or <span class="math notranslate nohighlight">\(\frac{\partial \phi}{\partial y}\)</span> so the expression looks something like</p>
<div class="math notranslate nohighlight">
\[
0= 
\frac{\partial}{\partial x}({ \frac{\partial \phi}{\partial x}})
+
\frac{\partial}{\partial y}({ \frac{\partial \phi}{\partial y}})
\]</div>
<p>Which is what we would call the velocity potential - although for flow nets we usually just solve for the head so we can compute pressures, using the formulation below:</p>
<div class="math notranslate nohighlight">
\[
0= 
\frac{\partial}{\partial x}({{T_x} \frac{\partial h}{\partial x}})
+
\frac{\partial}{\partial y}({{T_y} \frac{\partial h}{\partial y}})
\]</div>
<p>The difference equation (pp. 349-357) on a regular grid is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
0= 
[\frac{1}{\Delta x} T_{x} \frac{h_{i-1,j} - h_{i,j}}{\Delta x} +
 \frac{1}{\Delta y} T_{y} \frac{h_{i,j-1} - h_{i,j}}{\Delta y}] - \\
~~~~~~~~~~\\
~~~~~~~~~~[ \frac{1}{\Delta x} T_{x}  \frac{h_{i,j} - h_{i+1,j}}{\Delta x} +
  \frac{1}{\Delta y}  T_{y} \frac{h_{i,j} - h_{i,j+1}}{\Delta y} ]        
\end{matrix}        
\end{split}\]</div>
<p>Typically one approximates the spatial variation of the material properties (transmissivity) as arithmetic mean values between two cells, so making the following definitions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
A_{i,j} = \frac{1}{2 \Delta x^2}(T_{x,(i-1,j)}+T_{x,(i,j)}) \\ ~~ \\
B_{i,j} = \frac{1}{2 \Delta x^2}(T_{x,(i,j)}+T_{x,(i+1,j)})   \\ ~~ \\
C_{i,j} = \frac{1}{2 \Delta y^2}(T_{y,(i,j-1)}+T_{y,(i,j)})   \\ ~~ \\
D_{i,j} = \frac{1}{2 \Delta y^2}(T_{y,(i,j)}+T_{y,(i,j+1)})   \\ ~~ \\
\end{matrix}
\end{split}\]</div>
<p>Substitution into the difference equation yields</p>
<div class="math notranslate nohighlight">
\[
0 = A_{i,j}h_{i-1,j} + B_{i,j}h_{i+1,j} - (A_{i,j}+B_{i,j}+C_{i,j}+D_{i,j})h_{i,j} + C_{i,j}h_{i,j-1} + D_{i,j}h_{i,j+1}
\]</div>
<p>As before we can explicitly write the cell equation for <span class="math notranslate nohighlight">\(h_{i,j}\)</span> as</p>
<div class="math notranslate nohighlight">
\[
h_{i,j} = \frac{[A_{i,j}h_{i-1,j} + B_{i,j}h_{i+1,j} + C_{i,j}h_{i,j-1} + D_{i,j}h_{i,j+1}]}{[A_{i,j}+B_{i,j}+C_{i,j}+D_{i,j}]}
\]</div>
<p>This difference equation represents an approximation to the governing flow equation, the accuracy depending on the cell
size. Boundary conditions are applied directly into the analogs (another name for the difference equations) at appropriate
locations on the computational grid. We can generate solutions either by iteration or solving the resulting linear system; iteration is really easy to program, so for exploratory work that’s usually the approach.</p>
</section>
<section id="stream-function">
<h4>Stream Function<a class="headerlink" href="#stream-function" title="Link to this heading">#</a></h4>
<p>The stream function <span class="math notranslate nohighlight">\(\Psi\)</span> is a function that is orthogonal to the velocity potential function and expressed as a partial differential equation is</p>
<div class="math notranslate nohighlight">
\[
0= 
\frac{\partial}{\partial x}({\frac{1}{T_y} \frac{\partial \Psi}{\partial x}})
+
\frac{\partial}{\partial y}({\frac{1}{T_x} \frac{\partial \Psi}{\partial y}})
\]</div>
<p>Observe how the material property is inverted and changes directional identity, otherwise the equation is structurally identical to the groundwater flow equation (for steady flow).</p>
<p>The difference equation is practically the same as above:</p>
<p>The difference equation is also almost the same</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
0= 
[\frac{1}{\Delta x} \frac{1}{T_{y}} \frac{\Psi_{i-1,j} - \Psi_{i,j}}{\Delta x} +
 \frac{1}{\Delta y} \frac{1}{T_{x}} \frac{\Psi_{i,j-1} - \Psi_{i,j}}{\Delta y}] - \\
~~~~~~~~~~\\
~~~~~~~~~~[ \frac{1}{\Delta x} \frac{1}{T_{y}}  \frac{\Psi_{i,j} - \Psi_{i+1,j}}{\Delta x} +
  \frac{1}{\Delta y}  \frac{1}{T_{x}} \frac{\Psi_{i,j} - \Psi_{i,j+1}}{\Delta y} ]        
\end{matrix}        
\end{split}\]</div>
<p>The substitutions are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{matrix}
A_{i,j} = \frac{1}{2 \Delta x^2}(T_{y,(i-1,j)}^{-1}+T_{y,(i,j)}^{-1}) \\ ~~ \\
B_{i,j} = \frac{1}{2 \Delta x^2}(T_{y,(i,j)}^{-1}+T_{y,(i+1,j)}^{-1})   \\ ~~ \\
C_{i,j} = \frac{1}{2 \Delta y^2}(T_{x,(i,j-1)}^{-1}+T_{x,(i,j)}^{-1})   \\ ~~ \\
D_{i,j} = \frac{1}{2 \Delta y^2}(T_{x,(i,j)}^{-1}+T_{x,(i,j+1)}^{-1})   \\ ~~ \\
\end{matrix}
\end{split}\]</div>
<p>Substitution into the difference equation yields</p>
<div class="math notranslate nohighlight">
\[
0 = A_{i,j}\Psi_{i-1,j} + B_{i,j}\Psi_{i+1,j} - (A_{i,j}+B_{i,j}+C_{i,j}+D_{i,j})\Psi_{i,j} + C_{i,j}\Psi_{i,j-1} + D_{i,j}\Psi_{i,j+1}
\]</div>
<p>As before we can explicitly write the cell equation for <span class="math notranslate nohighlight">\(h_{i,j}\)</span> as</p>
<div class="math notranslate nohighlight">
\[
\Psi_{i,j} = \frac{[A_{i,j}\Psi_{i-1,j} + B_{i,j}\Psi_{i+1,j} + C_{i,j}\Psi_{i,j-1} + D_{i,j}\Psi_{i,j+1}]}{[A_{i,j}+B_{i,j}+C_{i,j}+D_{i,j}]}
\]</div>
<p>So at this point we could literally use the same script, however boundary conditions also ``invert.’’
A no-flow head-domain boundary is a constant value stream function-domain boundary.
A constant value head-domain boundary is a zero-gradient stream function-domain boundary.</p>
<p>So a script that first solves for the head distribution, then the stream function could be used to create a flownet.</p>
</section>
</section>
<section id="sheetpile-under-a-dam-flownet">
<h3>Sheetpile under a dam flownet<a class="headerlink" href="#sheetpile-under-a-dam-flownet" title="Link to this heading">#</a></h3>
<p>Compare to the example shown on pp. 30-34.</p>
<p>The figure below is a schematic of a dam built upon a permeable ground layer 80 meters thick (segment A to I).</p>
<p><img alt="" src="../../_images/sheetpile1.png" /></p>
<p>The dam has a base 60 meters long (segment B to F), with an upstream water depth of 10 meters. The downstream side of the dam is at 0 meters depth (otherwise its not a very good dam!). A sheetpile cutoff wall is installed beneath the dam (segment C to D to U to E). The ground layer has a hydraulic conductivity of K = 1 × 10−4 meters per second.</p>
<p>Important engineering questions are what is the pore water pressure under the dam, and is what is the total seepage under the dam? The pore water pressure can be found by solving for heads under the dam then subtracting the elevation of the computation location relative to a datum. The flow is found by Darcy’s law applied under the dam (shown as locations 1,2,3,4, and 5 in the sketch), which in turn requires computation of head under the dam. Thus the questions are answered by finding the head distribution under the dam.</p>
<p>The flow field (mathematically) extends an infinite distance upstream and downstream, but as a practical matter the contribution to seepage far upstream of the dam is negligible, and hence is approximated by the finite domain depicted.</p>
<p>Using the tools we have already we can simply build an input file, run our script and determine the head distribution (and thus compute the discharges under the dam. Then rerun with same script, but modify the boundary conditions and material properties to obtain the stream function - plot both solutions on the same contour map and viola we have a flownet.</p>
<p>The first is to represent the domain as shown, and make the following specifications in the boundary condition information, and we will treat the sheetpile cutoff wall as a low permeability inclusion (much like the the prior example). The boundary conditions are:</p>
<ol class="arabic simple">
<li><p>The segment from A to B is a constant head boundary with value equal to 10.</p></li>
<li><p>The segment from B to F is a zero-flux boundary.</p></li>
<li><p>The segment from B to C to D to U to E to F should be treated as a zero-flux boundary, but our mask does not extend into the interior – however the sheetpile itself can be approximated by providing a very small permeability. Alternately we could (should) modify the code to handle interior boundaries – but that is outside the scope of this chapter.</p></li>
<li><p>The segment from F to G is a constant head boundary with value equal to 0.</p></li>
<li><p>The segment form G to H is a constant head boundary with value equal to 0.</p></li>
<li><p>The segment from H to I is a zero-flux boundary.</p></li>
<li><p>The segment from I to A is a constant head boundary with value equal to 10.</p></li>
</ol>
<p>Here’s the input file for the heads <span class="math notranslate nohighlight">\(\phi\)</span> in the picture</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span>
<span class="mi">10</span>
<span class="mi">1</span>
<span class="mi">9</span>
<span class="mi">31</span>
<span class="mf">1e-12</span>
<span class="mi">5000</span>
<span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span> <span class="mi">30</span> <span class="mi">40</span> <span class="mi">50</span> <span class="mi">60</span> <span class="mi">70</span> <span class="mi">80</span> <span class="mi">90</span> <span class="mi">100</span> <span class="mi">110</span> <span class="mi">120</span> <span class="mi">130</span> <span class="mi">140</span> <span class="mi">150</span> <span class="mi">160</span> <span class="mi">170</span> <span class="mi">180</span> <span class="mi">190</span> <span class="mi">200</span> <span class="mi">210</span> <span class="mi">220</span> <span class="mi">230</span> <span class="mi">240</span> <span class="mi">250</span> <span class="mi">260</span> <span class="mi">270</span> <span class="mi">280</span> <span class="mi">290</span> <span class="mi">300</span>
<span class="mi">80</span> <span class="mi">70</span> <span class="mi">60</span> <span class="mi">50</span> <span class="mi">40</span> <span class="mi">30</span> <span class="mi">20</span> <span class="mi">10</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.00010</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0000001</span> <span class="mf">0.0000001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;PotentialFnSheetpile1.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">head</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">head</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##</span>
<span class="n">headold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force new matrix</span>
<span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(head)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(headold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>

<span class="c1"># Boundary Conditions</span>

<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
            <span class="n">head</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
            <span class="n">head</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
        <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
        <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">head</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span> <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(head)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(headold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in velocity potential because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">headold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">headold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Head Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="c1">############# Contour Plot</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">my_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
<span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
<span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
<span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">3000</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">800</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">levels1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot of Heads from Sheetpile1 Input&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in velocity potential because tolerance met 
Iterations = 443
End Calculations
Iterations    =  443
Closure Error =  0.0
Head Map
----
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 [10.    10.    10.    10.    10.    10.    10.    10.    10.    10.
 10.    10.    10.    10.     9.478  0.524  0.     0.     0.     0.
  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.
  0.   ]
1 [10.     9.98   9.959  9.936  9.91   9.881  9.848  9.808  9.763  9.71
  9.652  9.591  9.535  9.497  9.478  0.524  0.505  0.467  0.411  0.351
  0.293  0.241  0.196  0.157  0.125  0.097  0.073  0.052  0.034  0.016
  0.   ]
2 [10.     9.96   9.919  9.874  9.824  9.767  9.701  9.623  9.532  9.426
  9.306  9.178  9.054  8.965  8.949  1.055  1.039  0.95   0.827  0.699
  0.58   0.475  0.385  0.309  0.244  0.19   0.143  0.102  0.066  0.032
  0.   ]
3 [10.     9.943  9.883  9.818  9.746  9.663  9.566  9.451  9.316  9.156
  8.969  8.759  8.538  8.351  8.336  1.67   1.654  1.468  1.247  1.038
  0.852  0.694  0.56   0.448  0.354  0.275  0.207  0.148  0.095  0.047
  0.   ]
4 [10.     9.927  9.852  9.77   9.678  9.572  9.448  9.3    9.124  8.912
  8.657  8.351  7.986  7.559  6.629  3.379  2.448  2.021  1.657  1.352
  1.098  0.888  0.714  0.57   0.45   0.348  0.262  0.187  0.121  0.059
  0.   ]
5 [10.     9.915  9.827  9.731  9.623  9.499  9.353  9.179  8.968  8.711
  8.395  8.002  7.498  6.806  5.702  4.307  3.202  2.511  2.007  1.615
  1.301  1.046  0.838  0.667  0.526  0.407  0.306  0.219  0.141  0.069
  0.   ]
6 [10.     9.907  9.81   9.704  9.586  9.448  9.287  9.093  8.858  8.569
  8.212  7.764  7.196  6.465  5.528  4.48   3.544  2.813  2.246  1.8
  1.444  1.158  0.926  0.736  0.579  0.448  0.337  0.24   0.155  0.076
  0.   ]
7 [10.     9.903  9.801  9.69   9.566  9.422  9.253  9.049  8.801  8.496
  8.118  7.647  7.057  6.33   5.467  4.542  3.679  2.952  2.364  1.894
  1.518  1.215  0.971  0.771  0.606  0.469  0.352  0.251  0.162  0.079
  0.   ]
8 [10.     9.903  9.801  9.69   9.566  9.422  9.253  9.049  8.801  8.496
  8.118  7.647  7.057  6.33   5.467  4.542  3.679  2.952  2.364  1.894
  1.518  1.215  0.971  0.771  0.606  0.469  0.352  0.251  0.162  0.079
  0.   ]
----
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Contour Plot of Heads from Sheetpile1 Input&#39;)
</pre></div>
</div>
<img alt="../../_images/b63403a92c82f504bf963242af37c59ee153f12018bf1f24073ba672a6c0e530.png" src="../../_images/b63403a92c82f504bf963242af37c59ee153f12018bf1f24073ba672a6c0e530.png" />
</div>
</div>
<p>Now we reuse the code, but change <code class="docutils literal notranslate"><span class="pre">head</span></code> to <code class="docutils literal notranslate"><span class="pre">stream</span></code> and modify the contour plot variable names as well as modify the input file to reflect the changed material properties and boundary conditions.</p>
<p>Here’s the input file for the stream function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span>
<span class="mi">10</span>
<span class="mi">1</span>
<span class="mi">9</span>
<span class="mi">31</span>
<span class="mf">1e-12</span>
<span class="mi">5000</span>
<span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span> <span class="mi">30</span> <span class="mi">40</span> <span class="mi">50</span> <span class="mi">60</span> <span class="mi">70</span> <span class="mi">80</span> <span class="mi">90</span> <span class="mi">100</span> <span class="mi">110</span> <span class="mi">120</span> <span class="mi">130</span> <span class="mi">140</span> <span class="mi">150</span> <span class="mi">160</span> <span class="mi">170</span> <span class="mi">180</span> <span class="mi">190</span> <span class="mi">200</span> <span class="mi">210</span> <span class="mi">220</span> <span class="mi">230</span> <span class="mi">240</span> <span class="mi">250</span> <span class="mi">260</span> <span class="mi">270</span> <span class="mi">280</span> <span class="mi">290</span> <span class="mi">300</span>
<span class="mi">80</span> <span class="mi">70</span> <span class="mi">60</span> <span class="mi">50</span> <span class="mi">40</span> <span class="mi">30</span> <span class="mi">20</span> <span class="mi">10</span> <span class="mi">0</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">100</span>
<span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span> <span class="mi">100</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">100000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000000</span> <span class="mi">10000000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
<span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span> <span class="mi">10000</span>
</pre></div>
</div>
<p>In these examples the value of the stream function is arbitrarily set to range from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(100\)</span>.  One useful interpretation of stream function values is that their differences indicate the flow fraction (of total flow) that flows between the streamlines (contour lines of constant stream function value).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">sse</span><span class="o">=</span><span class="mf">0.0</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="n">sse</span><span class="o">=</span><span class="n">sse</span><span class="o">+</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">-</span><span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">matrix1</span><span class="p">,</span><span class="n">matrix2</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="c1">##print(nr,nc)</span>
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
            <span class="c1">##print(ir,jc)</span>
            <span class="n">matrix2</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span><span class="o">=</span><span class="n">matrix1</span><span class="p">[</span><span class="n">ir</span><span class="p">][</span><span class="n">jc</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">writearray</span><span class="p">(</span><span class="n">matrix</span><span class="p">):</span>
    <span class="n">nr</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="c1"># get row count</span>
    <span class="n">nc</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get column count</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>    
    <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ir</span><span class="p">,</span><span class="n">new_list</span><span class="p">[</span><span class="n">ir</span><span class="p">][:])</span>
    <span class="k">return</span><span class="p">()</span>

<span class="n">localfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;StreamFnSheetpile1.txt&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="c1"># connect and read file for 2D gw model</span>
<span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
<span class="n">distancex</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancex</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">distancey</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="n">distancey</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarytop</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarytop</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundarybottom</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundarybottom</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryleft</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryleft</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">boundaryright</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#empty list</span>
<span class="n">boundaryright</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">stream</span> <span class="o">=</span><span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">stream</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondx</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondx</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">hydcondy</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
        <span class="n">hydcondy</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">localfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
<span class="n">localfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># Disconnect the file</span>
<span class="c1">##</span>
<span class="n">amat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">bmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">cmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">dmat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">##</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondx</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltax</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span><span class="o">+</span> <span class="n">hydcondy</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">deltaz</span> <span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">deltay</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##</span>
<span class="n">streamold</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">jc</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">ir</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span> <span class="c1">#force new matrix</span>
<span class="n">streamold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="n">streamold</span><span class="p">)</span> <span class="c1"># update</span>
<span class="c1">##writearray(stream)</span>
<span class="c1">##print(&quot;----&quot;)</span>
<span class="c1">##writearray(streamold)</span>
<span class="c1">##print(&quot;--------&quot;)</span>
<span class="n">tolflag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span><span class="p">):</span>
<span class="c1">##    print(&quot;begin iteration&quot;)</span>
<span class="c1">##    writearray(stream)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(streamold)</span>
<span class="c1">##    print(&quot;--------&quot;)</span>

<span class="c1"># Boundary Conditions</span>

<span class="c1"># first and last row special == no flow boundaries</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">boundarytop</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at top</span>
            <span class="n">stream</span> <span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
        <span class="k">if</span> <span class="n">boundarybottom</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">jcol</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># no - flow at bottom</span>
            <span class="n">stream</span> <span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span><span class="n">nrows</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span>
<span class="c1"># first and last column special == no flow boundaries     </span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> 
        <span class="k">if</span>  <span class="n">boundaryleft</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># no - flow at left</span>
        <span class="k">if</span> <span class="n">boundaryright</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span> <span class="n">irow</span> <span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="n">stream</span> <span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">stream</span><span class="p">[</span> <span class="n">irow</span> <span class="p">][</span><span class="n">ncols</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># no - flow at right</span>
<span class="c1"># interior updates</span>
    <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nrows</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncols</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span> <span class="n">amat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">bmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">jcol</span>  <span class="p">]</span> 
                              <span class="o">+</span><span class="n">cmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> 
                              <span class="o">+</span><span class="n">dmat</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]</span><span class="o">*</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span>  <span class="p">][</span><span class="n">jcol</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">amat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">bmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">cmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">]</span><span class="o">+</span> <span class="n">dmat</span><span class="p">[</span> <span class="n">irow</span><span class="p">][</span><span class="n">jcol</span> <span class="p">])</span>
<span class="c1"># test for stopping iterations</span>
<span class="c1">##    print(&quot;end iteration&quot;)</span>
<span class="c1">##    writearray(stream)</span>
<span class="c1">##    print(&quot;----&quot;)</span>
<span class="c1">##    writearray(streamold)</span>
    <span class="n">percentdiff</span> <span class="o">=</span> <span class="n">sse</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="n">streamold</span><span class="p">)</span>
    <span class="k">if</span>  <span class="n">percentdiff</span> <span class="o">&lt;=</span> <span class="n">tolerance</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in Stream Function because tolerance met &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span> <span class="p">,</span> <span class="nb">iter</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> <span class="p">;</span>
        <span class="n">tolflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">break</span>
    <span class="n">streamold</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="n">streamold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;End Calculations&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations    = &quot;</span><span class="p">,</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Closure Error = &quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">percentdiff</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stream Function Map&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="n">writearray</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
<span class="c1">####################### Contour Plot ###############</span>
<span class="n">my_xyz2</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jcol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">my_xyz2</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">distancex</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">jcol</span><span class="p">],</span><span class="n">distancey</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">irow</span><span class="p">],</span><span class="n">stream</span><span class="p">[</span><span class="n">irow</span><span class="p">][</span><span class="n">jcol</span><span class="p">]])</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz2</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz2</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) # activate to examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x2</span> <span class="o">=</span> <span class="n">my_xyz2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 0 of dataframe</span>
<span class="n">coord_y2</span> <span class="o">=</span> <span class="n">my_xyz2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 1 of dataframe</span>
<span class="n">coord_z2</span> <span class="o">=</span> <span class="n">my_xyz2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="c1"># column 2 of dataframe</span>
<span class="n">coord_xy2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x2</span><span class="p">,</span> <span class="n">coord_y2</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x2</span><span class="p">),</span> <span class="mi">3000</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y2</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y2</span><span class="p">),</span> <span class="mi">800</span><span class="p">)</span>
<span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z2</span><span class="p">),</span> <span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">100</span><span class="p">]</span>
<span class="n">CS2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">levels</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS2</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot of Stream Function for Sheetpile1 Input&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exit iterations in Stream Function because tolerance met 
Iterations = 396
End Calculations
Iterations    =  396
Closure Error =  0.0
Stream Function Map
----
0 [100.     96.845  93.555  89.987  85.989  81.394  76.015  69.642  62.046
  52.99   42.26   29.74   15.542   0.191   0.      0.      0.19   15.469
  29.592  42.031  52.669  61.62   69.093  75.318  80.519  84.898  88.632
  91.878  94.773  97.442 100.   ]
1 [100.     96.845  93.555  89.987  85.989  81.394  76.015  69.642  62.046
  52.99   42.26   29.74   15.542   0.191   0.16    0.16    0.19   15.469
  29.592  42.031  52.669  61.62   69.093  75.318  80.519  84.898  88.632
  91.878  94.773  97.442 100.   ]
2 [100.     96.982  93.832  90.416  86.586  82.178  77.008  70.865  63.507
  54.663  44.05   31.419  16.694   0.337   0.304   0.304   0.336  16.625
  31.277  43.83   54.356  63.099  70.34   76.342  81.342  85.543  89.121
  92.229  94.999  97.553 100.   ]
3 [100.     97.249  94.377  91.26   87.76   83.724  78.976  73.304  66.452
  58.105  47.859  35.19   19.48    0.47    0.432   0.432   0.47   19.416
  35.061  47.658  57.826  66.081  72.825  78.369  82.963  86.81   90.08
  92.916  95.443  97.77  100.   ]
4 [100.     97.636  95.168  92.486  89.47   85.984  81.867  76.921  70.894
  63.447  54.089  42.004  25.566   0.634   0.541   0.541   0.634  25.509
  41.891  53.916  63.207  70.575  76.51   81.346  85.33   88.655  91.473
  93.914  96.085  98.085 100.   ]
5 [100.     98.128  96.172  94.045  91.65   88.875  85.587  81.619  76.754
  70.701  63.045  53.171  40.146  22.721   0.665   0.665  22.703  40.095
  53.079  62.907  70.511  76.502  81.294  85.175  88.358  91.005  93.244
  95.18   96.901  98.484 100.   ]
6 [100.     98.703  97.348  95.872  94.209  92.279  89.987  87.213  83.804
  79.559  74.22   67.487  59.128  49.437  40.688  40.683  49.419  59.09
  67.422  74.124  79.426  83.629  86.988  89.702  91.921  93.763  95.318
  96.661  97.853  98.95  100.   ]
7 [100.     99.336  98.643  97.888  97.036  96.046  94.869  93.443  91.689
  89.509  86.79   83.43   79.442  75.211  71.965  71.962  75.201  79.422
  83.396  86.74   89.442  91.6    93.328  94.723  95.863  96.808  97.604
  98.292  98.902  99.463 100.   ]
8 [100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.
 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100. 100.
 100. 100. 100.]
----
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Contour Plot of Stream Function for Sheetpile1 Input&#39;)
</pre></div>
</div>
<img alt="../../_images/415fadf0c7d84324bb476438fbd9a4f4c6c652f50de3515eba5d08db838e5236.png" src="../../_images/415fadf0c7d84324bb476438fbd9a4f4c6c652f50de3515eba5d08db838e5236.png" />
</div>
</div>
<p>Now both plots on same canvass</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Head (Velocity Potential Map)</span>
<span class="c1"># Grid the data; use linear interpolation (choices are nearest, linear, cubic)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z2</span><span class="p">),</span> <span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">levels1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels1</span><span class="p">)</span>
<span class="n">levels2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">]</span>
<span class="n">CS2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">Y2</span><span class="p">,</span> <span class="n">Z2</span><span class="p">,</span> <span class="n">levels2</span> <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS2</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Flownet for Sheetpile1 Input&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Flownet for Sheetpile1 Input&#39;)
</pre></div>
</div>
<img alt="../../_images/b1ef8ba8490c511df09c6db9c86ffa09e7fbfbb2af21f2763d6bfa59d8f8e3e7.png" src="../../_images/b1ef8ba8490c511df09c6db9c86ffa09e7fbfbb2af21f2763d6bfa59d8f8e3e7.png" />
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Using AI to improve your (already working) code: a practical framework
Goal: keep your code correct, make it clearer/faster/safer—and learn something in the process.</p>
<ol class="arabic simple">
<li><p>Set the ground rules (before you paste code)</p></li>
</ol>
<p>Snapshot a baseline: save the working script + sample inputs/outputs.</p>
<p>State objectives: e.g., “modularize,” “add tests,” “speed up by 2×,” “remove globals.”</p>
<p>List invariants: what must not change (I/O format, algorithm, results within tolerance).</p>
<p>Share minimal context: problem description, performance pain points, constraints (no new deps, Py≥3.10, runs headless, etc.).</p>
<p>Provide a small, runnable example: tiny input + expected output for quick checks.</p>
<ol class="arabic simple" start="2">
<li><p>Ask for a plan, then patches</p></li>
</ol>
<p>First request: “Propose a refactor plan with milestones (interfaces, tests, perf check).”</p>
<p>Work in small steps (e.g., extract functions → add dataclasses → add tests → add CLI).</p>
<p>Prefer diffs or focused snippets over full rewrites to avoid regressions.</p>
<ol class="arabic simple" start="3">
<li><p>Build safety nets</p></li>
</ol>
<p>Tests: ask for unit tests (edge cases + typical), fixtures, and a quick benchmark harness.</p>
<p>Determinism: specify seeds and tolerances (e.g., atol=1e-6), and record environment info.</p>
<p>Validation hooks: print/plot key diagnostics to confirm physics/logic after each change.</p>
<ol class="arabic simple" start="4">
<li><p>Check the work</p></li>
</ol>
<p>Require a short rationale for each change (why it helps; complexity trade-offs).</p>
<p>Watch for red flags: invented APIs, silent dependency creep, algorithm swaps, huge boilerplate.</p>
<p>Inspect performance: time/memory before vs after; accept only measurable wins.</p>
<ol class="arabic simple" start="5">
<li><p>Document and package</p></li>
</ol>
<p>Ask for docstrings, type hints, and a concise README (usage, assumptions, limits).</p>
<p>Ensure error messages guide the user; add logging where it helps debugging.</p>
<p>Keep your license/copyright headers intact.</p>
<p>Prompt templates (copy/paste)</p>
<p>“Refactor into a module with read_input, assemble_coeffs, solve, plot. Keep I/O identical.”</p>
<p>“Add dataclasses for grid/boundaries; no new dependencies; include type hints.”</p>
<p>“Write pytest tests for 3 cases (baseline, edge, heterogeneity); set numeric tolerances.”</p>
<p>“Suggest a safe SOR acceleration (ω selection), show where it slots in, and guard with a flag.”</p>
<p>“Produce a minimal benchmark script and report speedup on the provided sample.”</p>
<p>Remember: AI is a pair programmer, not an oracle. Keep runs tight, verify often, and merge improvements only when they pass your tests and preserve the science.</p>
</div>
<p>What follows below are two modules saved as .py files which are loaded in an identical fashion as a library or any other python module.  As you shall observe they make the model build/display much more tidy.  They implement the algorithm identically, but are modular.</p>
<p>I supplied the code above with the following prompt:</p>
<blockquote>
<div><p>Attached is my potential flow code. Can you refactor into logical modules, and enforce best programming practices.  As this is pedagogical - error checking is not vital, but elegant fails are desirable.</p>
</div></blockquote>
<p>The results are two modules <code class="docutils literal notranslate"><span class="pre">potential_flow_mod.py</span></code> and <code class="docutils literal notranslate"><span class="pre">flownet_plotter.py</span></code></p>
<p><strong>potential_flow_mod.py</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># potential_flow_mod.py</span>
<span class="c1">#</span>
<span class="c1"># Built collaboratively by Sensei and OpenAI ChatGPT on 2025-08-14;</span>
<span class="c1"># Derived from the classroom “PotentialFnSheetpile1” script.</span>
<span class="c1"># Gauss–Seidel iterative solver for Laplacian-type linear systems (in-place updates)</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">GridSpec</span><span class="p">:</span>
    <span class="n">deltax</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">deltay</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">deltaz</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">ncols</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">distancex</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">distancey</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Boundaries</span><span class="p">:</span>
    <span class="n">top</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">bottom</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">left</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">right</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ModelData</span><span class="p">:</span>
    <span class="n">grid</span><span class="p">:</span> <span class="n">GridSpec</span>
    <span class="n">bounds</span><span class="p">:</span> <span class="n">Boundaries</span>
    <span class="n">head0</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">Kx</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">Ky</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">maxiter</span><span class="p">:</span> <span class="nb">int</span>

<span class="k">def</span> <span class="nf">read_potential_input</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ModelData</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">deltax</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="n">deltay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="n">deltaz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="n">maxiter</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

        <span class="n">distancex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">distancey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">boundarytop</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">boundarybottom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">boundaryleft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">boundaryright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

        <span class="n">head0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="n">head0</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">Kx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="n">Kx</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

        <span class="n">Ky</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span>
            <span class="n">Ky</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">deltax</span><span class="p">,</span> <span class="n">deltay</span><span class="p">,</span> <span class="n">deltaz</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">distancex</span><span class="p">,</span> <span class="n">distancey</span><span class="p">)</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="n">Boundaries</span><span class="p">(</span><span class="n">boundarytop</span><span class="p">,</span> <span class="n">boundarybottom</span><span class="p">,</span> <span class="n">boundaryleft</span><span class="p">,</span> <span class="n">boundaryright</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ModelData</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">head0</span><span class="p">,</span> <span class="n">Kx</span><span class="p">,</span> <span class="n">Ky</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">assemble_coefficients</span><span class="p">(</span><span class="n">Kx</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Ky</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">grid</span><span class="p">:</span> <span class="n">GridSpec</span><span class="p">):</span>
    <span class="n">nr</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">ncols</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nr</span><span class="p">,</span> <span class="n">nc</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">dx2</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">deltax</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">dy2</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">deltay</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">deltaz</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">Kx</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">Kx</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">*</span> <span class="n">dz</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">dx2</span><span class="p">)</span>
            <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">Kx</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">Kx</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">*</span> <span class="n">dz</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">dx2</span><span class="p">)</span>
            <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">Ky</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">Ky</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span> <span class="o">*</span> <span class="n">dz</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">dy2</span><span class="p">)</span>
            <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">Ky</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">Ky</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">dz</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">dy2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span>

<span class="k">def</span> <span class="nf">apply_no_flow_edges</span><span class="p">(</span><span class="n">head</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">Boundaries</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">nr</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nc</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bounds</span><span class="o">.</span><span class="n">top</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">head</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">bounds</span><span class="o">.</span><span class="n">bottom</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">head</span><span class="p">[</span><span class="n">nr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">nr</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bounds</span><span class="o">.</span><span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">head</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">bounds</span><span class="o">.</span><span class="n">right</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">head</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">nc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">nc</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">gauss_seidel_sweep</span><span class="p">(</span><span class="n">head</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">A</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">B</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">C</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">D</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">nr</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">wsum</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">wsum</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">head</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">head</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">head</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">head</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                    <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">head</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                <span class="p">)</span> <span class="o">/</span> <span class="n">wsum</span>

<span class="k">def</span> <span class="nf">solve_potential</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="n">grid</span><span class="p">,</span> <span class="n">bounds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">bounds</span>
    <span class="n">head</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">head0</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">head_old</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">assemble_coefficients</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Kx</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">Ky</span><span class="p">,</span> <span class="n">grid</span><span class="p">)</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">tolerance</span>
    <span class="n">maxiter</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">maxiter</span>
    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">apply_no_flow_edges</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">bounds</span><span class="p">)</span>
        <span class="n">gauss_seidel_sweep</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
        <span class="n">sse</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">head</span> <span class="o">-</span> <span class="n">head_old</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">and</span> <span class="p">(</span><span class="n">it</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">it</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iter </span><span class="si">{</span><span class="n">it</span><span class="si">:</span><span class="s2">6d</span><span class="si">}</span><span class="s2"> | SSE=</span><span class="si">{</span><span class="n">sse</span><span class="si">:</span><span class="s2">.6e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sse</span> <span class="o">&lt;=</span> <span class="n">tol</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exit iterations in velocity potential because tolerance met&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Iterations =&quot;</span><span class="p">,</span> <span class="n">it</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">head</span><span class="p">,</span> <span class="n">it</span><span class="p">,</span> <span class="n">sse</span>
        <span class="n">head_old</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">head</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reached max iterations.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">head</span><span class="p">,</span> <span class="n">maxiter</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">head</span> <span class="o">-</span> <span class="n">head_old</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">plot_head_contours</span><span class="p">(</span><span class="n">distancex</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">distancey</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">head</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
                       <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;Contour Plot of Heads&quot;</span><span class="p">,</span> <span class="n">nx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1200</span><span class="p">,</span> <span class="n">ny</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">600</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cubic&quot;</span><span class="p">):</span>
    <span class="n">Xpts</span><span class="p">,</span> <span class="n">Ypts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">distancex</span><span class="p">,</span> <span class="n">distancey</span><span class="p">)</span>
    <span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">Xpts</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">Ypts</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">head</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">gx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">distancex</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">distancex</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">gy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">distancey</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">distancey</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">ny</span><span class="p">)</span>
    <span class="n">GX</span><span class="p">,</span> <span class="n">GY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span> <span class="n">gy</span><span class="p">)</span>
    <span class="n">GZ</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="p">(</span><span class="n">GX</span><span class="p">,</span> <span class="n">GY</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">GX</span><span class="p">,</span> <span class="n">GY</span><span class="p">,</span> <span class="n">GZ</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;x (distance units)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;y (distance units)&quot;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span>
</pre></div>
</div>
<p><strong>flownet_plotter.py</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># flownet_plotter.py</span>
<span class="c1">#</span>
<span class="c1"># Built collaboratively by Sensei and OpenAI ChatGPT on 2025-08-14.</span>
<span class="c1"># Overlays equipotential (head) and stream-function contours on a common grid to form a flownet.</span>
<span class="c1"># Reads two 3-column XYZ files (x y value), grids via scipy.griddata, and plots head (solid) + stream (dashed).</span>
<span class="c1"># Includes a helper to write XYZ from regular grids and a CLI for quick use; no explicit colors are set.</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">read_xyz</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read an XYZ file with 3 columns: x, y, value.</span>
<span class="sd">    Delimiters may be commas or whitespace.</span>
<span class="sd">    Lines starting with &#39;#&#39; or &#39;//&#39; are ignored.</span>
<span class="sd">    Returns: (x, y, z) as 1D numpy arrays.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">zs</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;//&#39;</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">ys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">);</span> <span class="n">zs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No valid data found in </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">ys</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">grid_xyz</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Grid scattered (x,y,z) onto a regular mesh using scipy.griddata.</span>
<span class="sd">    extent: (xmin, xmax, ymin, ymax); if None, computed from data.</span>
<span class="sd">    Returns: GX, GY, GZ</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">extent</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">extent</span>

    <span class="n">gx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
    <span class="n">gy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span>
    <span class="n">GX</span><span class="p">,</span> <span class="n">GY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">gx</span><span class="p">,</span> <span class="n">gy</span><span class="p">)</span>

    <span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
    <span class="n">GZ</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="p">(</span><span class="n">GX</span><span class="p">,</span> <span class="n">GY</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">GX</span><span class="p">,</span> <span class="n">GY</span><span class="p">,</span> <span class="n">GZ</span>

<span class="sd">&quot;&quot;&quot;def write_xyz_grid(distancex, distancey, array2d, path):</span>
<span class="sd">&quot;&quot;&quot;</span>
   <span class="c1"># Helper to write a regular grid (distancex, distancey, array) into</span>
   <span class="c1"># 3-column XYZ format. Each row: x y value</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    X, Y = np.meshgrid(distancex, distancey)</span>
<span class="sd">    xyz = np.column_stack([X.ravel(), Y.ravel(), array2d.ravel()])</span>
<span class="sd">    print(&quot;in write xyz&quot;)</span>
<span class="sd">    np.savetxt(</span>
<span class="sd">        path,</span>
<span class="sd">        xyz,</span>
<span class="sd">        fmt=&quot;%.6g&quot;,</span>
<span class="sd">        delimiter=&quot; &quot;,</span>
<span class="sd">        header=&quot;x y value&quot;,   # do NOT include &#39;\n&#39; here</span>
<span class="sd">        comments=&quot;# &quot;        # keeps a normal &#39;# &#39; header line</span>
<span class="sd">    )</span>

<span class="sd">    </span>
<span class="sd">with open(path, &#39;w&#39;, encoding=&#39;utf-8&#39;) as f:</span>
<span class="sd">        f.write(&#39;# x y value&#39;)</span>
<span class="sd">        for i, yy in enumerate(distancey):</span>
<span class="sd">            for j, xx in enumerate(distancex):</span>
<span class="sd">                f.write(f&quot;{xx} {yy} {array2d[i, j]}&quot;+&quot;\n&quot;)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">write_xyz_grid</span><span class="p">(</span><span class="n">distancex</span><span class="p">,</span> <span class="n">distancey</span><span class="p">,</span> <span class="n">array2d</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span>
                   <span class="n">label</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">transpose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Write a regular grid to 3-column XYZ text: x y &lt;label&gt;</span>

<span class="sd">    - distancex: (ncols,)</span>
<span class="sd">    - distancey: (nrows,)</span>
<span class="sd">    - array2d:   (nrows, ncols)</span>
<span class="sd">    - transpose=True if your array orientation needs flipping</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">distancex</span><span class="p">,</span> <span class="n">distancey</span><span class="p">)</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">array2d</span><span class="o">.</span><span class="n">T</span> <span class="k">if</span> <span class="n">transpose</span> <span class="k">else</span> <span class="n">array2d</span>
    <span class="n">xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">X</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">Y</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">Z</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span>

    <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span>
        <span class="n">path</span><span class="p">,</span>
        <span class="n">xyz</span><span class="p">,</span>
        <span class="n">fmt</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;%.</span><span class="si">{</span><span class="n">precision</span><span class="si">}</span><span class="s2">g&quot;</span><span class="p">,</span>
        <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
        <span class="n">header</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;x y </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>   <span class="c1"># reader ignores &#39;#&#39; lines</span>
        <span class="n">comments</span><span class="o">=</span><span class="s2">&quot;# &quot;</span><span class="p">,</span>
        <span class="n">newline</span><span class="o">=</span><span class="n">newline</span>          <span class="c1"># ensures real newlines on all OSes</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wrote </span><span class="si">{</span><span class="n">xyz</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> rows to </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_flownet</span><span class="p">(</span><span class="n">head_file</span><span class="p">,</span> <span class="n">stream_file</span><span class="p">,</span>
                 <span class="n">head_levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stream_levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">nx</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span>
                 <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Flownet&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">7.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                 <span class="n">head_label_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">stream_label_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">save_png</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot head and stream-function contours from two XYZ files on a common grid.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    head_file : str</span>
<span class="sd">        Path to XYZ file with (x, y, head).</span>
<span class="sd">    stream_file : str</span>
<span class="sd">        Path to XYZ file with (x, y, stream function).</span>
<span class="sd">    head_levels : list[float] or None</span>
<span class="sd">        Contour levels for head. If None, auto-selected.</span>
<span class="sd">    stream_levels : list[float] or None</span>
<span class="sd">        Contour levels for stream function. If None, auto-selected.</span>
<span class="sd">    nx, ny : int</span>
<span class="sd">        Grid size for interpolation.</span>
<span class="sd">    method : str</span>
<span class="sd">        &#39;nearest&#39;, &#39;linear&#39;, or &#39;cubic&#39; interpolation.</span>
<span class="sd">    title : str</span>
<span class="sd">        Figure title.</span>
<span class="sd">    figsize : tuple</span>
<span class="sd">        Figure size in inches.</span>
<span class="sd">    head_label_size, stream_label_size : int</span>
<span class="sd">        Font sizes for contour labels.</span>
<span class="sd">    save_png : str or None</span>
<span class="sd">        If provided, save to this path.</span>
<span class="sd">    transparent : bool</span>
<span class="sd">        Save PNG with transparent background.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig : matplotlib.figure.Figure</span>
<span class="sd">    ax : matplotlib.axes.Axes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="n">read_xyz</span><span class="p">(</span><span class="n">head_file</span><span class="p">)</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="n">read_xyz</span><span class="p">(</span><span class="n">stream_file</span><span class="p">)</span>

    <span class="c1"># Common extent from union of both datasets</span>
    <span class="n">xmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span>
    <span class="n">xmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span>
    <span class="n">ymin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y2</span><span class="p">))</span>
    <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y2</span><span class="p">))</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="p">(</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">,</span> <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>

    <span class="c1"># Grid both to the same mesh</span>
    <span class="n">GX</span><span class="p">,</span> <span class="n">GY</span><span class="p">,</span> <span class="n">GZ1</span> <span class="o">=</span> <span class="n">grid_xyz</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span>  <span class="n">_</span><span class="p">,</span>  <span class="n">GZ2</span> <span class="o">=</span> <span class="n">grid_xyz</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">nx</span><span class="o">=</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">ny</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">extent</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>

    <span class="c1"># Auto levels if not provided</span>
    <span class="k">def</span> <span class="nf">auto_levels</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">finite</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">arr</span><span class="p">)])</span>
        <span class="k">if</span> <span class="n">finite</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">finite</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">90</span><span class="p">])</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">finite</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">(</span><span class="n">finite</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">finite</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">hi</span> <span class="o">==</span> <span class="n">lo</span><span class="p">:</span>
            <span class="n">hi</span> <span class="o">=</span> <span class="n">lo</span> <span class="o">+</span> <span class="mf">1.0</span>  <span class="c1"># avoid degenerate contour</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">head_levels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">head_levels</span> <span class="o">=</span> <span class="n">auto_levels</span><span class="p">(</span><span class="n">GZ1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">stream_levels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">stream_levels</span> <span class="o">=</span> <span class="n">auto_levels</span><span class="p">(</span><span class="n">GZ2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>

    <span class="c1"># Head: solid lines</span>
    <span class="n">CS1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">GX</span><span class="p">,</span> <span class="n">GY</span><span class="p">,</span> <span class="n">GZ1</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">head_levels</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS1</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">head_label_size</span><span class="p">)</span>

    <span class="c1"># Stream function: dashed lines (no explicit color set)</span>
    <span class="n">CS2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">GX</span><span class="p">,</span> <span class="n">GY</span><span class="p">,</span> <span class="n">GZ2</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">stream_levels</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS2</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">stream_label_size</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

    <span class="c1"># Legend using proxy artists (default line color, different linestyles)</span>
    <span class="n">proxies</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">proxies</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Potential function (head)&#39;</span><span class="p">,</span> <span class="s1">&#39;Stream function (streamlines)&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">save_png</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_png</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="n">transparent</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

<span class="k">def</span> <span class="nf">_parse_levels</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse a comma-separated string of numbers into a list of floats.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Flownet plotter: overlay head and stream function contours.&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;head_file&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to head XYZ file (x y head).&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;stream_file&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to stream-function XYZ file (x y psi).&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--levels-head&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Comma-separated head contour levels, e.g., &quot;5,6,7,8&quot;.&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--levels-stream&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Comma-separated stream contour levels, e.g., &quot;10,20,30&quot;.&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--nx&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1200</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Interpolation grid size in x.&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--ny&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Interpolation grid size in y.&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--method&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="s1">&#39;cubic&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;griddata method.&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--title&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;Flownet&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Figure title.&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--save&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Output PNG path.&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--transparent&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Save with transparent background.&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_flownet</span><span class="p">(</span>
        <span class="n">args</span><span class="o">.</span><span class="n">head_file</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">stream_file</span><span class="p">,</span>
        <span class="n">head_levels</span><span class="o">=</span><span class="n">_parse_levels</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">levels_head</span><span class="p">),</span>
        <span class="n">stream_levels</span><span class="o">=</span><span class="n">_parse_levels</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">levels_stream</span><span class="p">),</span>
        <span class="n">nx</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">ny</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">method</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">save_png</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">save</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">transparent</span>
    <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>Now apply to the same input files</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reset</span> -f
<span class="kn">from</span> <span class="nn">potential_flow_mod</span> <span class="kn">import</span> <span class="n">read_potential_input</span><span class="p">,</span> <span class="n">solve_potential</span>
<span class="kn">from</span> <span class="nn">flownet_plotter</span> <span class="kn">import</span> <span class="n">write_xyz_grid</span><span class="p">,</span> <span class="n">plot_flownet</span>

<span class="c1"># 1) Solve velocity potential (head)</span>
<span class="n">modelp</span> <span class="o">=</span> <span class="n">read_potential_input</span><span class="p">(</span><span class="s2">&quot;PotentialFnSheetpile1.txt&quot;</span><span class="p">)</span>
<span class="n">head</span><span class="p">,</span> <span class="n">niter</span><span class="p">,</span> <span class="n">closure</span> <span class="o">=</span> <span class="n">solve_potential</span><span class="p">(</span><span class="n">modelp</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#fig = plot_head_contours(modelp.grid.distancex, modelp.grid.distancey, head, title=&quot;Contour Plot of Heads from Sheetpile1 Input&quot;)</span>

<span class="c1"># 2) Write solver outputs as XYZ (3 columns: x y value)</span>
<span class="n">write_xyz_grid</span><span class="p">(</span><span class="n">modelp</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">distancex</span><span class="p">,</span> <span class="n">modelp</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">distancey</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="s2">&quot;head_xyz.txt&quot;</span><span class="p">)</span>

<span class="c1"># 3) Solve stream function (streamlines)</span>
<span class="n">models</span> <span class="o">=</span> <span class="n">read_potential_input</span><span class="p">(</span><span class="s2">&quot;StreamFnSheetpile1.txt&quot;</span><span class="p">)</span>
<span class="n">stream</span><span class="p">,</span> <span class="n">niter</span><span class="p">,</span> <span class="n">closure</span> <span class="o">=</span> <span class="n">solve_potential</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#fig = plot_head_contours(models.grid.distancex, models.grid.distancey, stream, title=&quot;Contour Plot of Heads from Sheetpile1 Input&quot;)</span>

<span class="c1"># 4) Write solver outputs as  XYZ (3 columns: x y value)</span>
<span class="n">write_xyz_grid</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">distancex</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">distancey</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="s2">&quot;stream_xyz.txt&quot;</span><span class="p">)</span>

<span class="c1"># 5) Make the flownet</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_flownet</span><span class="p">(</span>
    <span class="s2">&quot;head_xyz.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;stream_xyz.txt&quot;</span><span class="p">,</span>
    <span class="n">head_levels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
    <span class="n">stream_levels</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Flownet for Sheetpile1 Inputs&quot;</span><span class="p">,</span>
    <span class="n">save_png</span><span class="o">=</span><span class="s2">&quot;flownet1.png&quot;</span><span class="p">,</span>
    <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4973ed9e42c8351386f7cd82fac3b50c465f9e1d4bef8c96be19bd7ac62c51d3.png" src="../../_images/4973ed9e42c8351386f7cd82fac3b50c465f9e1d4bef8c96be19bd7ac62c51d3.png" />
</div>
</div>
<hr>
<hr>
</section>
<section id="flownet-example-2-pore-pressure-under-a-dam-domain-decomposition-approach">
<h3>Flownet Example 2 : Pore Pressure under a Dam (Domain Decomposition approach)<a class="headerlink" href="#flownet-example-2-pore-pressure-under-a-dam-domain-decomposition-approach" title="Link to this heading">#</a></h3>
<p>The second way to solve this example, and perhaps better is to take advantage of
the symmetry and cut the domain in half, as</p>
<p><img alt="" src="../../_images/sheetpile2.png" /></p>
<p>In this method we can actually specify the sheetpile as a boundary, and we will obtain the about same results, but
only need to supply half as much input data.</p>
<p>Here’s the input file for the half-domain head calculations</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span>
<span class="mi">10</span>
<span class="mi">1</span>
<span class="mi">9</span>
<span class="mi">15</span>
<span class="mf">1e-16</span>
<span class="mi">5000</span>
<span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span> <span class="mi">30</span> <span class="mi">40</span> <span class="mi">50</span> <span class="mi">60</span> <span class="mi">70</span> <span class="mi">80</span> <span class="mi">90</span> <span class="mi">100</span> <span class="mi">110</span> <span class="mi">120</span> <span class="mi">130</span> <span class="mi">140</span>
<span class="mi">80</span> <span class="mi">70</span> <span class="mi">60</span> <span class="mi">50</span> <span class="mi">40</span> <span class="mi">30</span> <span class="mi">20</span> <span class="mi">10</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">5</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">5</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">5</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">5</span>
<span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">10</span> <span class="mi">5</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
<span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span> <span class="mf">0.0001</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reset</span> -f
<span class="kn">from</span> <span class="nn">potential_flow_mod</span> <span class="kn">import</span> <span class="n">read_potential_input</span><span class="p">,</span> <span class="n">solve_potential</span>
<span class="kn">from</span> <span class="nn">flownet_plotter</span> <span class="kn">import</span> <span class="n">write_xyz_grid</span><span class="p">,</span> <span class="n">plot_flownet</span>

<span class="c1"># 1) Solve velocity potential (head)</span>
<span class="n">modelp</span> <span class="o">=</span> <span class="n">read_potential_input</span><span class="p">(</span><span class="s2">&quot;PotentialFnSheetpile2.txt&quot;</span><span class="p">)</span>
<span class="n">head</span><span class="p">,</span> <span class="n">niter</span><span class="p">,</span> <span class="n">closure</span> <span class="o">=</span> <span class="n">solve_potential</span><span class="p">(</span><span class="n">modelp</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#fig = plot_head_contours(modelp.grid.distancex, modelp.grid.distancey, head, title=&quot;Contour Plot of Heads from Sheetpile1 Input&quot;)</span>

<span class="c1"># 2) Write solver outputs as XYZ (3 columns: x y value)</span>
<span class="n">write_xyz_grid</span><span class="p">(</span><span class="n">modelp</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">distancex</span><span class="p">,</span> <span class="n">modelp</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">distancey</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="s2">&quot;head_xyz.txt&quot;</span><span class="p">)</span>

<span class="c1"># 3) Solve stream function (streamlines)</span>
<span class="n">models</span> <span class="o">=</span> <span class="n">read_potential_input</span><span class="p">(</span><span class="s2">&quot;StreamFnSheetpile2.txt&quot;</span><span class="p">)</span>
<span class="n">stream</span><span class="p">,</span> <span class="n">niter</span><span class="p">,</span> <span class="n">closure</span> <span class="o">=</span> <span class="n">solve_potential</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#fig = plot_head_contours(models.grid.distancex, models.grid.distancey, stream, title=&quot;Contour Plot of Heads from Sheetpile1 Input&quot;)</span>

<span class="c1"># 4) Write solver outputs as  XYZ (3 columns: x y value)</span>
<span class="n">write_xyz_grid</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">distancex</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">distancey</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="s2">&quot;stream_xyz.txt&quot;</span><span class="p">)</span>

<span class="c1"># 5) Make the flownet</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_flownet</span><span class="p">(</span>
    <span class="s2">&quot;head_xyz.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;stream_xyz.txt&quot;</span><span class="p">,</span>
    <span class="n">head_levels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
    <span class="n">stream_levels</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Flownet for Sheetpile2 Inputs&quot;</span><span class="p">,</span>
    <span class="n">save_png</span><span class="o">=</span><span class="s2">&quot;flownet2.png&quot;</span><span class="p">,</span>
    <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/91708136e385cf6ece3eef318e969de4d923b7da31306694eee64976c31b45f0.png" src="../../_images/91708136e385cf6ece3eef318e969de4d923b7da31306694eee64976c31b45f0.png" />
</div>
</div>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>This chapter refreshed the governing equations of groundwater flow and the advection–dispersion equation for transport, emphasizing how Darcy’s law and mass conservation underpin both. Because you have seen these before, we focused on the essentials: storage terms (specific yield vs. specific storage), anisotropic conductivities, and how velocity fields from the flow solution drive transport. The aim was not to re-derive everything in full, but to recall the physics you need at your fingertips when you start building and checking models.</p>
<p>We then turned to flownets as a practical, low-overhead way to explore boundary effects and heterogeneity. Using a homebrew potential solver and flownet plotter, we showed how equipotential lines and stream functions can be overlaid to visualize flow patterns, estimate gradients, and even approximate capture zones—all without booting up MODFLOW. This approach is ideal for rapid “what-if” tests, classroom demonstrations, and early scoping on real sites. We noted anisotropy conceptually (directional conductivities) and left its detailed illustration as an exercise; extending the flownet to anisotropic cases is a natural next step. Together, these tools bridge theory and practice: they keep the physics honest while giving you fast, reproducible visuals that support interpretation and decision-making.</p>
</section>
<section id="exercise-s">
<h2>Exercise(s)<a class="headerlink" href="#exercise-s" title="Link to this heading">#</a></h2>
</section>
<section id="section-end">
<h2>Section End<a class="headerlink" href="#section-end" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="#top"><span class="xref myst">Back to top</span></a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python-my-env",
            path: "./chapters/01fundamentals"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python-my-env'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="01fundamentals.science.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2. Fundamentals I</p>
      </div>
    </a>
    <a class="right-next"
       href="../03site.mapping.tools/site.mapping.tools.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">5. Site Mapping Tools</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scope">Scope</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#readings">Readings</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#videos">Videos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spreadsheets-programs-data">Spreadsheets/Programs/Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#flow-equations">Flow Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transport-equations">Transport Equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-and-constitutive-pieces">Variables and constitutive pieces</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#species-mass-balance-over-a-representative-elementary-volume-rev">Species mass balance over a representative elementary volume (REV)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sorption-and-retardation-a-type-of-reaction">Sorption and retardation (a type of reaction)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-instantaneous-linear-equilibrium-sorption">(a) Instantaneous linear equilibrium sorption</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#b-kinetic-sorption-first-order-two-rate-optional">(b) Kinetic sorption (first-order two-rate; optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-dual-porosity-mobileimmobile-optional">(c) Dual-porosity / mobile–immobile (optional)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#canonical-forms-for-direct-use">Canonical forms (for direct use)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boundary-conditions-quick-reference">Boundary conditions (quick reference)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#units-and-sign-checks">Units and sign checks</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-the-equations">Solving the Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#flownets">Flownets</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-in-python">Example in Python</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#velocity-potential">Velocity Potential</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stream-function">Stream Function</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sheetpile-under-a-dam-flownet">Sheetpile under a dam flownet</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flownet-example-2-pore-pressure-under-a-dam-domain-decomposition-approach">Flownet Example 2 : Pore Pressure under a Dam (Domain Decomposition approach)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-s">Exercise(s)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-end">Section End</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Theodore G. Cleveland, PhD
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>