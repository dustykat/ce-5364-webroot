
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MF6 Project Problem Statement &#8212; Groundwater Transport Phenomena</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/12.01usgsmodflow6/mf6-pr2/mf6-pr2';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/gwtransport.png" class="logo__image only-light" alt="Groundwater Transport Phenomena - Home"/>
    <script>document.write(`<img src="../../../_static/gwtransport.png" class="logo__image only-dark" alt="Groundwater Transport Phenomena - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Preface
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../00syllabus/ce5364-syllabus-2025-3.html">0. Syllabus (Fall 2025)</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../00introduction/00introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01fundamentals/01fundamentals.science.html">2. Fundamentals I</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../01fundamentals/01fundamentals.practice.html">3. Fundamentals II</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../02regulatory.overview/regulatory.overview.html">3. Regulatory Overview and Risk Assessment</a></li>

<li class="toctree-l1"><a class="reference internal" href="../../03site.mapping.tools/site.mapping.tools.html">5. Site Mapping Tools</a></li>





<li class="toctree-l1"><a class="reference internal" href="../../03site.characterization/site.characterization.html">6. Site Characterization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../04physical.transport/physical.transport.html">7. Physical Transport</a></li>



<li class="toctree-l1"><a class="reference internal" href="../../04physical.transport/modeling.advection.html">8. Modeling Advection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../05analytical.models1d/05analytical.models1d.html">9. Analytical Solutions (1D)</a></li>



<li class="toctree-l1"><a class="reference internal" href="../../05analytical.solutions2d/05analytical.solutions2d.html">10. Analytical Solutions (2D)</a></li>




<li class="toctree-l1"><a class="reference internal" href="../../06reactive.transport/06reactive.transport.html">11. Reactive Transport</a></li>



<li class="toctree-l1"><a class="reference internal" href="../../07mf6.model/07mf6.introduction.html">12. MODFLOW6 Introduction</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../07mf6.model/07mf6.transport.html">13. MODFLOW6 Transport</a></li>


<li class="toctree-l1"><a class="reference internal" href="../../08data.collection/08data.collection.html">14. Sample Collection and Data Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../17unsaturatedzone/unsaturated.html">Unsaturated Zone Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../18untransport/unsaturatedtransport.html">Unsaturated Zone Transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../18untransport/napls.html">Non-Aqueous Phase Liquids</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../22remediation/remediation.html">Remediation Technologies</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapters/12.01usgsmodflow6/mf6-pr2/mf6-pr2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/chapters/12.01usgsmodflow6/mf6-pr2/mf6-pr2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>MF6 Project Problem Statement</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">MF6 Project Problem Statement</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-the-assimilative-capacity-of-a-300-ft-aquifer-for-aquifer-storage-recovery-applications-using-modflow6"><div style="text-align: center;"> Modeling the Assimilative Capacity of a 300-ft Aquifer for Aquifer-Storage-Recovery Applications using MODFLOW6 </div></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-problem-statement">Modeling Problem Statement</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-and-parameters">Assumptions and Parameters:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-methodology">Modeling Methodology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-workflow">Modeling Workflow</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-i-scenario-1">Appendix I: Scenario 1</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-setup">Initial setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters">Define parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-hydraulic-conductivity">Read Hydraulic Conductivity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-boundary-array">Read Boundary Array</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-computation-domain-array">Read Computation Domain Array</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#render-the-array-into-a-visual-representation-will-repeat-this-code-block-as-needed">Render the array into a visual representation - will repeat this code block as needed</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2d-array-you-would-replace-this-with-your-actual-data">Example 2D array (you would replace this with your actual data)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#assuming-my-array2d-is-your-2d-array-nrow-x-ncol">Assuming my_array2D is your 2D array (nrow x ncol)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-2d-array-using-imshow">Plot the 2D array using imshow</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#add-a-colorbar-to-indicate-the-value-scale">Add a colorbar to indicate the value scale</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#add-the-grid">Add the grid</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#customize-the-grid-to-align-with-the-image-cells">Customize the grid to align with the image cells</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#enable-minor-ticks-to-show-the-grid-at-each-cell">Enable minor ticks to show the grid at each cell</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#disable-the-default-major-ticks">Disable the default major ticks</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#add-row-and-column-labels">Add row and column labels</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-add-labels-for-clarity">Optional: Add labels for clarity</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#display-the-plot">Display the plot</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-storage-array">Read storage array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-porosity-array">Read porosity array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-longitudinal-dispersivity-array">Read longitudinal dispersivity array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-transverse-dispersivity-array">Read transverse dispersivity array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pumping-and-injection-wells">Pumping and Injection Wells</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Define parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-setup">Model setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-results">Plotting results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-i-scenario-2">Appendix I: Scenario 2</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Initial setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Define parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Read Hydraulic Conductivity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Read Boundary Array</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Read Computation Domain Array</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Render the array into a visual representation - will repeat this code block as needed</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Example 2D array (you would replace this with your actual data)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Assuming my_array2D is your 2D array (nrow x ncol)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Plot the 2D array using imshow</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Add a colorbar to indicate the value scale</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Add the grid</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Customize the grid to align with the image cells</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Enable minor ticks to show the grid at each cell</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Disable the default major ticks</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Add row and column labels</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Optional: Add labels for clarity</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Display the plot</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Read storage array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Read porosity array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Read longitudinal dispersivity array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Read transverse dispersivity array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">Pumping and Injection Wells</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Define parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Model setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Plotting results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="mf6-project-problem-statement">
<h1>MF6 Project Problem Statement<a class="headerlink" href="#mf6-project-problem-statement" title="Link to this heading">#</a></h1>
<p>A 300-ft thick aquifer is used for water supply.  The aquifer is also under consideration as a disposal field for treated waste water (aquifer-storage-recovery), where the filtration and dilution capacity of the aquifer will be used to receive the waste water for intentional re-use.</p>
<p>The figure below is a plan-view representation of a conceptual model of the aquifer. Each cell in the schematic is <span class="math notranslate nohighlight">\(1,500\)</span> feet by <span class="math notranslate nohighlight">\(1,500\)</span> feet.</p>
<p><img alt="" src="../../../_images/aquiferplan.png" /></p>
<p>The northern constant head boundary is set at h=600 ft. The southern edge constant boundary varies from 540 ft to 520 ft as one traverses from east to west.  Three water supply wells, W-1, W-2, and W-3 are already in service.  Hydrologic data suggests that the aquifer system has three distinct zones with different hydraulic characteristics.  These characteristics are tabulated below.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Zone</p></th>
<th class="head text-right"><p>K(cm/sec)</p></th>
<th class="head text-right"><p><span class="math notranslate nohighlight">\(n\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td class="text-right"><p>4.72</p></td>
<td class="text-right"><p>0.20</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td class="text-right"><p>1.57</p></td>
<td class="text-right"><p>0.20</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td class="text-right"><p>0.47</p></td>
<td class="text-right"><p>0.20</p></td>
</tr>
</tbody>
</table>
</div>
<p>The longitudinal dispersivity has been estimated as <span class="math notranslate nohighlight">\(\alpha_l=50~m\)</span> and the transverse dispersivity has been estimated at <span class="math notranslate nohighlight">\(\alpha_t=20~m\)</span>.  The drinking water wells supply water at the rates tabulated below.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Well</p></th>
<th class="head text-right"><p>Q(cfs)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>W-1</p></td>
<td class="text-right"><p>16.0</p></td>
</tr>
<tr class="row-odd"><td><p>W-2</p></td>
<td class="text-right"><p>7.0</p></td>
</tr>
<tr class="row-even"><td><p>W-3</p></td>
<td class="text-right"><p>7.0</p></td>
</tr>
</tbody>
</table>
</div>
<p>The proposed re-use scheme will inject tracer-labeled waste-water into the aquifer into any of the three injection sites, I-1, I-2, or I-3.  The goal is for the concentration of the non-toxic tracer to never exceede 250 mg/L at the water production wells.  The tracer is added just before injection as a dilution indicator so that the water utility can shut down a well if the water in that well is not sufficiently diluted (much like the tracer added to natural gas to detect leaks).  The tracer concentration at the injection point is 1000 mg/L (the operation goal is the dilute the waste water four fold before it reaches the drinking water wells).</p>
<p>Determine using MF6 the answers to the questions below.</p>
<ol class="arabic simple">
<li><p>Can 30 cfs of waste water be injected at I-3 and meet the water quality goal (4:1 dilution at drinking water wells)?</p></li>
<li><p>Is it possible to inject more waste water (higher flow or different location)?</p></li>
<li><p>Find the maximum volume that can be injected (at any or all of the three sites) and meet the water quality goal - this is the ‚Äúregulatory assimilative capacity of the system.‚Äù  Does this volume exceed the drinking water demand currently satisfied by the three wells?</p></li>
<li><p>Assume that instead of a non-toxic tracer, the injection water concentration represents some particular water quality parameter.  Assuming that the injection rate never exceedes the demand rate, what is the maximum waste load (mg/sec) that can be put into the aquifer and meet the raw water quality goal?</p></li>
</ol>
<p>Submit your response as a Modeling Report; below is a suggested layout for such a report</p>
<section id="modeling-the-assimilative-capacity-of-a-300-ft-aquifer-for-aquifer-storage-recovery-applications-using-modflow6">
<h2><div style="text-align: center;"> Modeling the Assimilative Capacity of a 300-ft Aquifer for Aquifer-Storage-Recovery Applications using MODFLOW6 </div><a class="headerlink" href="#modeling-the-assimilative-capacity-of-a-300-ft-aquifer-for-aquifer-storage-recovery-applications-using-modflow6" title="Link to this heading">#</a></h2>
<div style="text-align: center;">
by Author(s)
</div>
<div style="text-align: center;">
26 Nov 21024
</div>
<div style="text-align: center;">
Department of Civil, Environmental and Construction Engineering
</div><section id="introduction">
<h3>Introduction:<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h3>
<p>The 300-ft thick aquifer depicted below is to be used for water supply.  The aquifer is also under consideration as a disposal field for treated waste water (aquifer-storage-recovery), where the filtration and dilution capacity of the aquifer will be used to receive the waste water for intentional re-use.</p>
<p><img alt="" src="../../../_images/aquiferplan.png" /></p>
<p>The figure is a plan-view representation of the conceptual model of the aquifer. Each cell in the schematic is <span class="math notranslate nohighlight">\(1,500\)</span> feet by <span class="math notranslate nohighlight">\(1,500\)</span> feet.</p>
<p>The modeling <strong>objective</strong> is to evaluate the feasibility of injecting tracer-labeled wastewater into the aquifer without exceeding water quality goals at drinking water wells. Injection must achieve a 4:1 dilution (250 mg/L threshold) at the production wells W-1, W-2, and W-3, starting from an injection concentration of 1000 mg/L.</p>
</section>
<section id="modeling-problem-statement">
<h3>Modeling Problem Statement<a class="headerlink" href="#modeling-problem-statement" title="Link to this heading">#</a></h3>
<p>Evaluate injection scenarios at sites I-1, I-2, and I-3 considering:</p>
<ul class="simple">
<li><p>Feasibility of injecting 30 cfs at I-3.</p></li>
<li><p>Potential for higher injection rates or alternative locations.</p></li>
<li><p>Maximum allowable injection volume meeting water quality goals (regulatory assimilative capacity).</p></li>
<li><p>Maximum waste load (mg/sec) at allowable injection rates.</p></li>
</ul>
</section>
<section id="assumptions-and-parameters">
<h3>Assumptions and Parameters:<a class="headerlink" href="#assumptions-and-parameters" title="Link to this heading">#</a></h3>
<p>Hydrologic data suggests that the aquifer system has three distinct zones with different hydraulic characteristics.  These characteristics are tabulated below.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Zone</p></th>
<th class="head text-right"><p>K(cm/sec)</p></th>
<th class="head text-right"><p><span class="math notranslate nohighlight">\(n\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td class="text-right"><p>4.72</p></td>
<td class="text-right"><p>0.20</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td class="text-right"><p>1.57</p></td>
<td class="text-right"><p>0.20</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td class="text-right"><p>0.47</p></td>
<td class="text-right"><p>0.20</p></td>
</tr>
</tbody>
</table>
</div>
<p>The northern constant head boundary is set at h=600 ft. The southern edge constant boundary varies from 540 ft to 520 ft as one traverses from east to west.  Three water supply wells, W-1, W-2, and W-3 are already in service.<br />
The longitudinal dispersivity has been estimated as <span class="math notranslate nohighlight">\(\alpha_l=50~m\)</span> and the transverse dispersivity has been estimated at <span class="math notranslate nohighlight">\(\alpha_t=20~m\)</span>.</p>
<p>The drinking water wells supply water at the rates tabulated below.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Well</p></th>
<th class="head text-right"><p>Q(cfs)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>W-1</p></td>
<td class="text-right"><p>16.0</p></td>
</tr>
<tr class="row-odd"><td><p>W-2</p></td>
<td class="text-right"><p>7.0</p></td>
</tr>
<tr class="row-even"><td><p>W-3</p></td>
<td class="text-right"><p>7.0</p></td>
</tr>
</tbody>
</table>
</div>
<p>The proposed aquifer-storage-recovery (ASR) scheme involves injecting treated wastewater containing a tracer at an initial concentration of 1000 mg/L. The system‚Äôs operational objective is to ensure that the tracer undergoes sufficient dilution within the aquifer before reaching the production wells. Specifically, the tracer concentration at the drinking water wells‚ÄîW-1, W-2, and W-3‚Äîmust not exceed the regulatory threshold of 250 mg/L, representing a required 4:1 dilution ratio.</p>
<p>This requirement ensures compliance with water quality standards and safeguards the supply of potable water. Modeling will evaluate the aquifer‚Äôs dilution capacity under various injection scenarios to determine the maximum allowable injection rates while maintaining water quality at the production wells.</p>
</section>
<section id="modeling-methodology">
<h3>Modeling Methodology<a class="headerlink" href="#modeling-methodology" title="Link to this heading">#</a></h3>
<p>The modeling framework employs MODFLOW6 to simulate groundwater flow and a coupled mass transport solver to model tracer transport. The methodology is outlined as follows:</p>
<p><strong>Flow Calculations</strong>
Groundwater flow is simulated using MODFLOW6, which employs a block-centered finite difference approach to approximate the governing equations of motion for flow in saturated porous media. The influence of production wells on the flow field is explicitly modeled to capture their impact on groundwater velocities and directions.</p>
<p><strong>Transport Modeling</strong>
Tracer transport is simulated using a marker-in-cell, finite volume mass transport solver integrated with the MODFLOW6 flow grid. This solver models the key processes of advection, dispersion, and dilution, providing spatially and temporally resolved predictions of tracer concentrations throughout the aquifer.</p>
<p><strong>Dilution Criteria</strong>
Tracer concentrations at the production wells (W-1, W-2, and W-3) are evaluated against the operational dilution criterion, ensuring that the concentration does not exceed the target threshold</p>
<div class="math notranslate nohighlight">
\[ùê∂_{goal}=250~mg/L\]</div>
<p>This analysis determines the feasibility of proposed injection scenarios and the aquifer‚Äôs capacity to meet water quality standards.</p>
<p>By integrating flow and transport modeling on a shared computational grid, this methodology ensures accurate representation of hydrodynamic and mass transport processes essential for decision-making in aquifer storage and recovery operations.</p>
</section>
<section id="modeling-workflow">
<h3>Modeling Workflow<a class="headerlink" href="#modeling-workflow" title="Link to this heading">#</a></h3>
<p>The modeling workflow is:</p>
<ol class="arabic simple">
<li><p>Initial package set-up (Python package loading ‚Äì assume packages already installed in the kernel)</p></li>
<li><p>Read model structure data (I named the file ‚Äúpr2-input-base.txt‚Äù, you can rename as needed)</p></li>
<li><p>Read hydraulic conductivity array</p></li>
<li><p>Read boundary array</p></li>
<li><p>Read idomain array</p></li>
<li><p>Read storativity array</p></li>
<li><p>Read porosity array</p></li>
<li><p>Read/generate wells (once per stress period)</p></li>
</ol>
<p>The process above is repeated for eacxh scenario, the details are in the appendices below.</p>
<ol class="arabic simple" start="5">
<li><p>Results:</p></li>
</ol>
<ul class="simple">
<li><p>Scenario 1: Injection of 30 cfs at I-3. Tracer concentration at wells: <br> W-1: <span class="math notranslate nohighlight">\(15~mg/L\)</span> <br> W-2: <span class="math notranslate nohighlight">\(153~mg/L\)</span>  <br> W-3:<span class="math notranslate nohighlight">\(328~mg/L\)</span> ; <br> Evaluation: 30 cfs injection at I-3 does not5 meet the stated dilution goal].</p></li>
<li><p>Scenario 2: Reduce rate at I3 and increase at I1 and I2; total injection is 30 cfs. Injection rate: [Maximum rate feasible for each site, I-1, I-2, I-3]. Evaluation: [State if higher injection rates meet the goal].</p></li>
<li><p>Scenario 3: Regulatory Assimilative Capacity. Maximum injection volume: [Calculated capacity in cfs or m¬≥/s]. Comparison to well demand: [State if capacity exceeds current drinking water demand].</p>
<ul>
<li><p>Scenario 4: Maximum Waste Load. Maximum injection rate: [Rate that satisfies water demand]. Waste load: [Calculated maximum mg/secmg/sec].</p></li>
</ul>
</li>
</ul>
<ol class="arabic simple" start="6">
<li><p>Discussion</p></li>
</ol>
<ul class="simple">
<li><p>Feasibility: Summarize the feasibility of injection scenarios.</p></li>
<li><p>Sensitivity Analysis: Discuss key parameters affecting the results (e.g., dispersivity, porosity).</p></li>
<li><p>Limitations: Highlight assumptions that could impact accuracy.</p></li>
</ul>
<ol class="arabic simple" start="7">
<li><p>Recommendations</p></li>
</ol>
<ul class="simple">
<li><p>Proposed injection site(s) and rates.</p></li>
<li><p>Monitoring strategies to ensure compliance with water quality goals.</p></li>
<li><p>Consideration of alternative aquifer management strategies if goals cannot be met.</p></li>
</ul>
<ol class="arabic simple" start="8">
<li><p>Conclusions</p></li>
</ol>
<ul class="simple">
<li><p>Summarize findings, including the maximum allowable injection volume and waste load.</p></li>
</ul>
<ol class="arabic simple" start="9">
<li><p>Appendices</p></li>
</ol>
<ul class="simple">
<li><p>Appendix A: Detailed calculations (flow modeling, dilution ratios).</p></li>
<li><p>Appendix B: Maps/visualizations of flow and tracer concentration.</p></li>
<li><p>Appendix C: Tables of input parameters and results.</p></li>
</ul>
<!--

0. **Front matter**:

> Title Page: Title of the Report
    Author(s)
    Date
    Affiliation/Institution

> Table of Contents: List of Sections and Subsections with Page Numbers

> List of Figures and Tables: Numbered List of Figures and Tables with Captions and Page Numbers

> Executive Summary: A concise summary of the main objectives, methodology, key findings, and recommendations. This section should provide a quick overview of the report's main points.

1. **Introduction**: Background and context of the groundwater modeling study Objectives and goals of the modeling project. Scope and limitations of the study.

2. **Literature Review**: Review of relevant literature and prior research on the study area, hydrogeology, and similar modeling studies. Explanation of key concepts and theories related to groundwater modeling.

3. **Study Area and Data Collection**: Description of the study area, including its geographical location and hydrogeological characteristics. Details on data collection methods, sources, and types of data used (e.g., well data, geophysical data, hydrological data).

4. **Conceptual Model**: Development of the conceptual model, including hydrogeological setting, boundary conditions, and initial conditions. Explanation of the conceptual model's assumptions and simplifications.

5. **Numerical Modeling Approach**: Explanation of the numerical modeling software and methodology used. Description of the mathematical equations governing groundwater flow, solute transport, or any relevant processes.

6. **Model Calibration** *(not enough detail is provided in problem statement, so feel free to skip entirely)*: Details on the calibration process, including parameter estimation and model adjustments to match observed data. Presentation of calibration results and goodness-of-fit statistics.

7. **Model Validation** *(not enough detail is provided in problem statement, so feel free to skip entirely)*: Presentation of validation results to demonstrate the model's accuracy and reliability. Discussion of how well the model reproduces observed groundwater behavior.

8. **Scenario Analysis**: Presentation of model simulations for different scenarios, including various input conditions and potential changes in the study area. Discussion of the implications of different scenarios on groundwater behavior.

9. **Results and Discussion**: Detailed presentation of modeling results, including maps, graphs, and tables. Interpretation of the results in the context of the study's objectives. Discussion of any trends, anomalies, or significant findings.

10. **Conclusions**: Summary of the key findings and their implications. Discussion of the study's contributions to the field and its relevance to decision-making.

11. **Recommendations**: Specific recommendations for groundwater management, remediation, or further research based on the modeling results.

12. **References**: List of all sources and literature cited in the report, following a standard citation style.

13. **Appendices**: Supplementary material such as data tables, model input files, detailed modeling parameters, and additional figures.

Remember to use clear and concise language throughout the report, and include appropriate figures, tables, and citations to support your findings and analysis. Additionally, make sure the report is well-organized and follows a logical flow of information from introduction to conclusions. --></section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="appendix-i-scenario-1">
<h1>Appendix I: Scenario 1<a class="headerlink" href="#appendix-i-scenario-1" title="Link to this heading">#</a></h1>
<p>Inputs: Injection of 30 cfs at I-3.
Outputs: Tracer concentration at wells: W-1: [Concentration] mg/L ;W-2: [Concentration] mg/L; W-3: [Concentration] mg/L</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reset</span> -f
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The script generates a lot of output that are suppressed by a <code class="docutils literal notranslate"><span class="pre">;</span></code>  Comment the character out to re-enable full output (which is damn helpful for debugging the script!)</p>
</div>
<section id="initial-setup">
<h2>Initial setup<a class="headerlink" href="#initial-setup" title="Link to this heading">#</a></h2>
<p>Import dependencies, define the example name and workspace, and read settings from environment variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pformat</span>
<span class="kn">import</span> <span class="nn">flopy</span>
<span class="kn">import</span> <span class="nn">git</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">flopy.plot.styles</span> <span class="kn">import</span> <span class="n">styles</span>
<span class="kn">from</span> <span class="nn">modflow_devtools.misc</span> <span class="kn">import</span> <span class="n">get_env</span><span class="p">,</span> <span class="n">timed</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The code block above loads various modules into the environment; they must exist and be loaded into the kernel - if not you get a warning ‚ÄúModule Not Found‚Äù and will have to install into the kernel (i.e. <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">-m</span> <span class="pre">install</span> <span class="pre">module</span></code>, or the <code class="docutils literal notranslate"><span class="pre">conda</span></code> equivalent
Filter warnings repeated to achieve ‚Äúfor sure ‚Ä¶‚Äù that the filter is applied.  By design the filter will not stop ERRORS, and warnings issued within functions will still display, but it will address one annoying deprecation error.</p>
</div>
<section id="define-parameters">
<h3>Define parameters<a class="headerlink" href="#define-parameters" title="Link to this heading">#</a></h3>
<p>Define model units, spatial, and temporal discritization settings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read control file</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-base.txt&quot;</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># Assign Properties</span>
<span class="n">length_units</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">time_units</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">nlay</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># Number of layers</span>
<span class="n">nrow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>  <span class="c1"># Number of rows</span>
<span class="n">ncol</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>  <span class="c1"># Number of columns</span>
<span class="n">delr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>  <span class="c1"># Column width ($m$)</span>
<span class="n">delc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>  <span class="c1"># Row width ($m$)</span>
<span class="n">delz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>  <span class="c1"># Layer thickness ($m$)</span>
<span class="n">top</span>  <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>  <span class="c1"># Top of the model ($m$)</span>

<span class="c1">#</span>

<span class="c1"># more above</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-hydraulic-conductivity">
<h3>Read Hydraulic Conductivity<a class="headerlink" href="#read-hydraulic-conductivity" title="Link to this heading">#</a></h3>
<p>Read the hydraulic conductivity array (float) arranged in layer,row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read hydraulic conductivity array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-hydcond.txt&quot;</span>
<span class="n">hk</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">hk</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">hk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hk</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-boundary-array">
<h3>Read Boundary Array<a class="headerlink" href="#read-boundary-array" title="Link to this heading">#</a></h3>
<p>Read the boundary indication array (integer) arranged in layer,row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read boundary array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-ibound.txt&quot;</span>
<span class="n">ibound</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">ibound</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">ibound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ibound</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-computation-domain-array">
<h3>Read Computation Domain Array<a class="headerlink" href="#read-computation-domain-array" title="Link to this heading">#</a></h3>
<p>Read the computation domain array (integer) indicating active/inactive cells arranged in layer,row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read idomain array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-idomain.txt&quot;</span>
<span class="n">idomain</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">idomain</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">idomain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idomain</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="render-the-array-into-a-visual-representation-will-repeat-this-code-block-as-needed">
<h1>Render the array into a visual representation - will repeat this code block as needed<a class="headerlink" href="#render-the-array-into-a-visual-representation-will-repeat-this-code-block-as-needed" title="Link to this heading">#</a></h1>
<p>import matplotlib.pyplot as plt
import numpy as np</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="example-2d-array-you-would-replace-this-with-your-actual-data">
<h1>Example 2D array (you would replace this with your actual data)<a class="headerlink" href="#example-2d-array-you-would-replace-this-with-your-actual-data" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="assuming-my-array2d-is-your-2d-array-nrow-x-ncol">
<h1>Assuming my_array2D is your 2D array (nrow x ncol)<a class="headerlink" href="#assuming-my-array2d-is-your-2d-array-nrow-x-ncol" title="Link to this heading">#</a></h1>
<p>my_array2D = idomain  # Replace with your actual array</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plot-the-2d-array-using-imshow">
<h1>Plot the 2D array using imshow<a class="headerlink" href="#plot-the-2d-array-using-imshow" title="Link to this heading">#</a></h1>
<p>plt.figure(figsize=(14, 10))  # Optional: set the figure size
plt.imshow(my_array2D, cmap=‚Äôviridis‚Äô, interpolation=‚Äônone‚Äô)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="add-a-colorbar-to-indicate-the-value-scale">
<h1>Add a colorbar to indicate the value scale<a class="headerlink" href="#add-a-colorbar-to-indicate-the-value-scale" title="Link to this heading">#</a></h1>
<p>plt.colorbar(label=‚ÄôArray Value‚Äô)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="add-the-grid">
<h1>Add the grid<a class="headerlink" href="#add-the-grid" title="Link to this heading">#</a></h1>
<p>plt.grid(visible=True, color=‚Äôblack‚Äô, linestyle=‚Äô-‚Äô, linewidth=0.1)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="customize-the-grid-to-align-with-the-image-cells">
<h1>Customize the grid to align with the image cells<a class="headerlink" href="#customize-the-grid-to-align-with-the-image-cells" title="Link to this heading">#</a></h1>
<p>plt.gca().set_xticks(np.arange(-0.5, my_array2D.shape[1], 1), minor=True)
plt.gca().set_yticks(np.arange(-0.5, my_array2D.shape[0], 1), minor=True)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="enable-minor-ticks-to-show-the-grid-at-each-cell">
<h1>Enable minor ticks to show the grid at each cell<a class="headerlink" href="#enable-minor-ticks-to-show-the-grid-at-each-cell" title="Link to this heading">#</a></h1>
<p>plt.gca().grid(which=‚Äôminor‚Äô, color=‚Äôblack‚Äô, linestyle=‚Äô-‚Äô, linewidth=1.5)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="disable-the-default-major-ticks">
<h1>Disable the default major ticks<a class="headerlink" href="#disable-the-default-major-ticks" title="Link to this heading">#</a></h1>
<p>plt.gca().tick_params(which=‚Äômajor‚Äô, bottom=False, left=False)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="add-row-and-column-labels">
<h1>Add row and column labels<a class="headerlink" href="#add-row-and-column-labels" title="Link to this heading">#</a></h1>
<p>rows, cols = my_array2D.shape
plt.xticks(np.arange(cols), labels=[f‚ÄôCol {i}‚Äô for i in range(cols)])
plt.yticks(np.arange(rows), labels=[f‚ÄôRow {i}‚Äô for i in range(rows)])</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="optional-add-labels-for-clarity">
<h1>Optional: Add labels for clarity<a class="headerlink" href="#optional-add-labels-for-clarity" title="Link to this heading">#</a></h1>
<p>plt.title(‚Äò2D Array Visualization for array: idomain‚Äô)
plt.xlabel(‚ÄòColumn Index‚Äô)
plt.ylabel(‚ÄòRow Index‚Äô)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="display-the-plot">
<h1>Display the plot<a class="headerlink" href="#display-the-plot" title="Link to this heading">#</a></h1>
<p>plt.show()</p>
<section id="read-storage-array">
<h2>Read storage array<a class="headerlink" href="#read-storage-array" title="Link to this heading">#</a></h2>
<p>Read the storage coefficient array (float) arranged in layer,row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read storativity array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-storage.txt&quot;</span>
<span class="n">ss_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">ss_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">ss_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ss_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-porosity-array">
<h2>Read porosity array<a class="headerlink" href="#read-porosity-array" title="Link to this heading">#</a></h2>
<p>Read theporosity array (float) arranged in layer, row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read porosity array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-porosity.txt&quot;</span>
<span class="n">pors_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">pors_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">pors_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pors_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-longitudinal-dispersivity-array">
<h2>Read longitudinal dispersivity array<a class="headerlink" href="#read-longitudinal-dispersivity-array" title="Link to this heading">#</a></h2>
<p>Read the longitudinal dispersivity array (float) arranged in layer, row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read longitudinal dispersivity array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-disperl.txt&quot;</span>
<span class="n">displ_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">displ_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">displ_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">displ_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-transverse-dispersivity-array">
<h2>Read transverse dispersivity array<a class="headerlink" href="#read-transverse-dispersivity-array" title="Link to this heading">#</a></h2>
<p>Read the transverse dispersivity array (float) arranged in layer, row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read dispersivity in y-direction array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-dispert.txt&quot;</span>
<span class="n">dispt_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">dispt_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">dispt_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dispt_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read initial heads array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-headinit.txt&quot;</span>
<span class="n">strt</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">strt</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">strt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">strt</span><span class="p">)</span>

<span class="n">strt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[9999.99 , 9999.99 , 9999.99 , 9999.99 , 9999.99 , 9999.99 ,
        9999.99 , 9999.99 , 9999.99 , 9999.99 ],
       [9999.99 ,  600.   ,  600.   ,  600.   ,  600.   ,  600.   ,
         600.   ,  600.   ,  600.   , 9999.99 ],
       [9999.99 ,  598.627,  598.635,  598.651,  598.671,  598.685,
         598.696,  598.698,  598.699, 9999.99 ],
       [9999.99 ,  597.244,  597.263,  597.299,  597.347,  597.373,
         597.4  ,  597.399,  597.398, 9999.99 ],
       [9999.99 ,  595.844,  595.873,  595.935,  596.046,  596.058,
         596.134,  596.1  ,  596.095, 9999.99 ],
       [9999.99 ,  592.981,  593.023,  593.102,  593.21 ,  593.295,
         593.388,  593.439,  593.477, 9999.99 ],
       [9999.99 ,  588.644,  588.707,  588.823,  588.976,  589.14 ,
         589.307,  589.46 ,  589.587, 9999.99 ],
       [9999.99 ,  584.245,  584.338,  584.507,  584.73 ,  584.981,
         585.242,  585.506,  585.823, 9999.99 ],
       [9999.99 ,  579.753,  579.891,  580.139,  580.457,  580.812,
         581.174,  581.498,  581.729, 9999.99 ],
       [9999.99 ,  569.734,  570.035,  570.535,  571.135,  571.774,
         572.459,  573.025,  573.375, 9999.99 ],
       [9999.99 ,  554.028,  554.679,  555.666,  556.761,  557.828,
         559.177,  560.211,  560.877, 9999.99 ],
       [9999.99 ,  537.671,  538.985,  540.691,  542.414,  543.602,
         546.211,  547.765,  549.045, 9999.99 ],
       [9999.99 ,  520.   ,  522.9  ,  525.7  ,  528.6  ,  531.4  ,
         534.3  ,  537.1  ,  540.   , 9999.99 ],
       [9999.99 , 9999.99 , 9999.99 , 9999.99 , 9999.99 , 9999.99 ,
        9999.99 , 9999.99 , 9999.99 , 9999.99 ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mf">0.01548</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.01548
</pre></div>
</div>
</div>
</div>
</section>
<section id="pumping-and-injection-wells">
<h2>Pumping and Injection Wells<a class="headerlink" href="#pumping-and-injection-wells" title="Link to this heading">#</a></h2>
<p>Define wellfield settings, here we are using scripting to build the input structure, bou could just as well use a file read structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Wellfield Conditions</span>
<span class="c1"># MF2K5 pumping/injection rates in length-time units</span>
<span class="c1"># CFS pumping is negative</span>
<span class="n">qW1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">16.0</span> 
<span class="n">qW2</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">7.0</span>
<span class="n">qW3</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">7.0</span>
<span class="c1"># CFS injection is positive</span>
<span class="n">qI1</span> <span class="o">=</span> <span class="mf">0.0</span> 
<span class="n">qI2</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">qI3</span> <span class="o">=</span> <span class="mf">30.0</span>
<span class="c1"># Concentrations </span>
<span class="c1"># PPM pumping (set pumpings to zero value)</span>
<span class="n">cW1</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">cW2</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">cW3</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="c1"># PPM injection</span>
<span class="n">cI1</span> <span class="o">=</span> <span class="mf">00.0</span>
<span class="n">cI2</span> <span class="o">=</span> <span class="mf">00.0</span>
<span class="n">cI3</span> <span class="o">=</span> <span class="mf">1000.0</span>
<span class="c1">#spd = {</span>
 <span class="c1">#   0: [[0, 3, 6, cwell1, 2], [0, 10, 6, cwell0, 2]],</span>
  <span class="c1">#  1: [[0, 3, 6, cwell0, 2], [0, 10, 6, cwell0, 2]],</span>
<span class="c1">#}  # Well info 4 MT3D</span>
<span class="c1"># Build MF6 wellfield objects</span>
<span class="n">wellist_sp1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#                   (k,  i, j),   flow,  conc</span>
<span class="n">wellist_sp1</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">qI1</span><span class="p">,</span> <span class="n">cI1</span><span class="p">])</span>  <span class="c1"># Injection well</span>
<span class="n">wellist_sp1</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">qI1</span><span class="p">,</span> <span class="n">cI2</span><span class="p">])</span>  <span class="c1"># Injection well</span>
<span class="n">wellist_sp1</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">qI1</span><span class="p">,</span> <span class="n">cI3</span><span class="p">])</span>  <span class="c1"># Injection well #3  ACTIVE THIS SCENARIO</span>
<span class="n">wellist_sp1</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">qW1</span><span class="p">,</span> <span class="n">cW1</span><span class="p">])</span>  <span class="c1"># Pumping well</span>
<span class="n">wellist_sp1</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">qW2</span><span class="p">,</span> <span class="n">cW2</span><span class="p">])</span>  <span class="c1"># Pumping well</span>
<span class="n">wellist_sp1</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">qW3</span><span class="p">,</span> <span class="n">cW3</span><span class="p">])</span>  <span class="c1"># Pumping well</span>
<span class="c1">#</span>
<span class="n">wellist_sp2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#                   (k,  i, j),   flow,  conc</span>
<span class="n">wellist_sp2</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">qI1</span><span class="p">,</span> <span class="n">cI1</span><span class="p">])</span>  <span class="c1"># Injection well</span>
<span class="n">wellist_sp2</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">qI2</span><span class="p">,</span> <span class="n">cI2</span><span class="p">])</span>  <span class="c1"># Injection well</span>
<span class="n">wellist_sp2</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">qI3</span><span class="p">,</span> <span class="n">cI3</span><span class="p">])</span>  <span class="c1"># Injection well  #3  ACTIVE THIS SCENARIO</span>
<span class="n">wellist_sp2</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">qW1</span><span class="p">,</span> <span class="n">cW1</span><span class="p">])</span>  <span class="c1"># Pumping well</span>
<span class="n">wellist_sp2</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">qW2</span><span class="p">,</span> <span class="n">cW2</span><span class="p">])</span>  <span class="c1"># Pumping well</span>
<span class="n">wellist_sp2</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">qW3</span><span class="p">,</span> <span class="n">cW3</span><span class="p">])</span>  <span class="c1"># Pumping well</span>
<span class="c1">#</span>
<span class="n">spd_mf6</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">wellist_sp1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">wellist_sp2</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2>Define parameters<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>Define model units, spatial, and temporal discritization settings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model units</span>
<span class="c1">#length_units = &quot;meters&quot;</span>
<span class="c1">#time_units = &quot;seconds&quot;</span>

<span class="c1"># Model parameters</span>
<span class="c1">#nlay = 1  # Number of layers</span>
<span class="c1">#nrow = 18  # Number of rows</span>
<span class="c1">#ncol = 14  # Number of columns</span>
<span class="c1">#delr = 100.0  # Column width ($m$)</span>
<span class="c1">#delc = 100.0  # Row width ($m$)</span>
<span class="c1">#delz = 10.0  # Layer thickness ($m$)</span>
<span class="c1">#top = 0.0  # Top of the model ($m$)</span>
<span class="c1">#prsity = 0.3  # Porosity - array reader above</span>
<span class="n">k1</span> <span class="o">=</span> <span class="mf">1.474e-4</span>  <span class="c1"># Horiz. hyd. conductivity of medium grain material ($m/sec$)</span>
<span class="n">k2</span> <span class="o">=</span> <span class="mf">1.474e-7</span>  <span class="c1"># Horiz. hyd. conductivity of fine grain material ($m/sec$)</span>
<span class="n">inj</span> <span class="o">=</span> <span class="mf">0.001</span>  <span class="c1"># Injection well rate ($m^3/sec$)</span>
<span class="n">ext</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0189</span>  <span class="c1"># Extraction well pumping rate ($m^3/sec$)</span>
<span class="n">al</span> <span class="o">=</span> <span class="mf">20.0</span>  <span class="c1"># Longitudinal dispersivity ($m$)</span>
<span class="n">trpt</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Ratio of horiz. transverse to longitudinal dispersivity ($m$)</span>
<span class="n">perlen</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># Simulation time ($years$)</span>

<span class="c1"># Additional model input</span>
<span class="c1">#hk = k1 * np.ones((nlay, nrow, ncol), dtype=float)</span>
<span class="c1">#hk[:, 5:8, 1:8] = k2</span>
<span class="n">laytyp</span> <span class="o">=</span> <span class="n">icelltype</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Active model domain</span>
<span class="c1">#ibound = np.ones((nlay, nrow, ncol), dtype=int)</span>
<span class="c1">#ibound[0, 0, :] = -1</span>
<span class="c1">#ibound[0, -1, :] = -1</span>
<span class="c1">#idomain = np.ones((nlay, nrow, ncol), dtype=int)</span>
<span class="n">icbund</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Boundary conditions</span>

<span class="c1"># Transport related</span>
<span class="n">sconc</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">ath1</span> <span class="o">=</span> <span class="n">al</span> <span class="o">*</span> <span class="n">trpt</span>
<span class="n">dmcoef</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># m^2/s</span>
<span class="c1"># Time variables</span>
<span class="n">perlen</span> <span class="o">=</span> <span class="p">[</span><span class="mf">365.0</span> <span class="o">*</span> <span class="mi">86400</span><span class="p">,</span> <span class="mf">365.0</span> <span class="o">*</span> <span class="mi">86400</span><span class="p">]</span>
<span class="n">steady</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">nper</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">perlen</span><span class="p">)</span>
<span class="n">nstp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">365</span><span class="p">,</span> <span class="mi">365</span><span class="p">]</span>
<span class="n">tsmult</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="c1">#</span>
<span class="n">sconc</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">c0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">botm</span> <span class="o">=</span> <span class="p">[</span><span class="n">top</span> <span class="o">-</span> <span class="n">delz</span><span class="p">]</span>
<span class="n">mixelm</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="c1"># Solver settings</span>
<span class="n">nouter</span><span class="p">,</span> <span class="n">ninner</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">300</span>
<span class="n">hclose</span><span class="p">,</span> <span class="n">rclose</span><span class="p">,</span> <span class="n">relax</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="n">percel</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># HMOC parameters</span>
<span class="n">itrack</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">wd</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">dceps</span> <span class="o">=</span> <span class="mf">1.0e-5</span>
<span class="n">nplane</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">npl</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">nph</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">npmin</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">npmax</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">dchmoc</span> <span class="o">=</span> <span class="mf">1.0e-3</span>
<span class="n">nlsink</span> <span class="o">=</span> <span class="n">nplane</span>
<span class="n">npsink</span> <span class="o">=</span> <span class="n">nph</span>
<span class="n">nadvfd</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-setup">
<h2>Model setup<a class="headerlink" href="#model-setup" title="Link to this heading">#</a></h2>
<p>Define functions to build models, write input files, and run the simulation.</p>
<p><strong>Groundwater Flow Package Build</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Workspace and Executibles</span>
<span class="c1">#binary = &quot;/home/sensei/ce-4363-webroot/ModflowExperimental/mf6-arm/mf6&quot;  # location on MY computer of the compiled modflow program</span>
<span class="c1">#workarea = &quot;/home/sensei/ce-4363-webroot/ModflowExperimental/mf6-arm/mf6-pr2&quot; # location on MY computer to store files this example (directory must already exist)</span>
<span class="c1">#workarea = workspace # location on MY computer to store files this example (directory must already exist)</span>

<span class="n">binary</span> <span class="o">=</span> <span class="s2">&quot;/home/sensei/mfplayground/modflow-python/mf6.4.1_linux/bin/mf6&quot;</span>  <span class="c1"># location on AWS computer of the compiled modflow program</span>
<span class="n">workarea</span> <span class="o">=</span> <span class="s2">&quot;/home/sensei/ce-5364-webroot/mfexperiments/mf6-pr2&quot;</span> <span class="c1"># location on MY computer to store files this example (directory must already exist)</span>


<span class="c1"># Set Simulation Name(s)</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;mf6-pr2&quot;</span>
<span class="n">gwfname</span> <span class="o">=</span> <span class="s2">&quot;gwf-&quot;</span> <span class="o">+</span> <span class="n">name</span>
<span class="n">gwtname</span> <span class="o">=</span> <span class="s2">&quot;gwt-&quot;</span> <span class="o">+</span> <span class="n">name</span>

<span class="c1">##### FLOPY Build simulation framework ####</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">MFSimulation</span><span class="p">(</span>
    <span class="n">sim_name</span><span class="o">=</span><span class="s2">&quot;sim-&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">exe_name</span><span class="o">=</span><span class="n">binary</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;mf6&quot;</span><span class="p">,</span> <span class="n">sim_ws</span><span class="o">=</span><span class="n">workarea</span>
<span class="p">)</span>
<span class="c1">####### CREATED &quot;/home/sensei/ce-4363-webroot/ModflowExperimental/mf6-arm/mt3d_example9&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">####### Instantiating MODFLOW 6 time discretization ########</span>
<span class="n">tdis_rc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nper</span><span class="p">):</span>
    <span class="n">tdis_rc</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">perlen</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nstp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tsmult</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowTdis</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">nper</span><span class="o">=</span><span class="n">nper</span><span class="p">,</span> <span class="n">perioddata</span><span class="o">=</span><span class="n">tdis_rc</span><span class="p">,</span> <span class="n">time_units</span><span class="o">=</span><span class="n">time_units</span><span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">####### Instantiating MODFLOW 6 groundwater flow model ########</span>
<span class="c1"># Set Model Name (using same base name as the simulation)</span>
<span class="n">model_nam_file</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.nam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gwfname</span><span class="p">)</span>
<span class="c1"># create MODFLOW6 flow model framework</span>
<span class="n">gwf</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwf</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">modelname</span><span class="o">=</span><span class="n">gwfname</span><span class="p">,</span> <span class="n">save_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">model_nam_file</span><span class="o">=</span><span class="n">model_nam_file</span><span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###### Instantiating MODFLOW 6 solver for flow model #######</span>
<span class="c1"># Set Iterative Model Solution (choose solver parameters)</span>
<span class="c1"># about IMS see: https://water.usgs.gov/nrp/gwsoftware/ModelMuse/Help/sms_sparse_matrix_solution_pac.htm</span>
<span class="c1"># using defaults see: https://flopy.readthedocs.io/en/3.3.2/source/flopy.mf6.modflow.mfims.html</span>
<span class="n">imsgwf</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowIms</span><span class="p">(</span>
    <span class="n">sim</span><span class="p">,</span>
    <span class="n">print_option</span><span class="o">=</span><span class="s2">&quot;SUMMARY&quot;</span><span class="p">,</span>
    <span class="n">outer_dvclose</span><span class="o">=</span><span class="n">hclose</span><span class="p">,</span>
    <span class="n">outer_maximum</span><span class="o">=</span><span class="n">nouter</span><span class="p">,</span>
    <span class="n">under_relaxation</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="n">inner_maximum</span><span class="o">=</span><span class="n">ninner</span><span class="p">,</span>
    <span class="n">inner_dvclose</span><span class="o">=</span><span class="n">hclose</span><span class="p">,</span>
    <span class="n">rcloserecord</span><span class="o">=</span><span class="n">rclose</span><span class="p">,</span>
    <span class="n">linear_acceleration</span><span class="o">=</span><span class="s2">&quot;CG&quot;</span><span class="p">,</span>
    <span class="n">scaling_method</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="n">reordering_method</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="n">relaxation_factor</span><span class="o">=</span><span class="n">relax</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.ims&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">register_ims_package</span><span class="p">(</span><span class="n">imsgwf</span><span class="p">,</span> <span class="p">[</span><span class="n">gwf</span><span class="o">.</span><span class="n">name</span><span class="p">]);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###### Instantiating MODFLOW 6 discretization package ######</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfdis</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">length_units</span><span class="o">=</span><span class="n">length_units</span><span class="p">,</span>
    <span class="n">nlay</span><span class="o">=</span><span class="n">nlay</span><span class="p">,</span>
    <span class="n">nrow</span><span class="o">=</span><span class="n">nrow</span><span class="p">,</span>
    <span class="n">ncol</span><span class="o">=</span><span class="n">ncol</span><span class="p">,</span>
    <span class="n">delr</span><span class="o">=</span><span class="n">delr</span><span class="p">,</span>
    <span class="n">delc</span><span class="o">=</span><span class="n">delc</span><span class="p">,</span>
    <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span>
    <span class="n">botm</span><span class="o">=</span><span class="n">botm</span><span class="p">,</span>
    <span class="n">idomain</span><span class="o">=</span><span class="n">idomain</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.dis&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build MF6 constant head boundaries:</span>
<span class="n">xc</span> <span class="o">=</span> <span class="n">gwf</span><span class="o">.</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">xcellcenters</span>
<span class="n">chdspd</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Loop through the top &amp; bottom sides.</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="c1">#for j in np.arange(ncol):</span>
<span class="c1">#               l,  r, c,  head, conc</span>
    <span class="n">chdspd</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="mf">600.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># Top boundary</span>
    <span class="n">hd</span> <span class="o">=</span> <span class="mf">520.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">xc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">xc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">2.8572</span> <span class="o">/</span> <span class="mi">1500</span>
    <span class="n">chdspd</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">hd</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># Bottom boundary</span>
<span class="n">chdspd</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">chdspd</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###### Instantiating MODFLOW 6 initial conditions package for flow model #######</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfic</span><span class="p">(</span><span class="n">gwf</span><span class="p">,</span> <span class="n">strt</span><span class="o">=</span><span class="n">strt</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.ic&quot;</span><span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 node-property flow package</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfnpf</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">icelltype</span><span class="o">=</span><span class="n">icelltype</span><span class="p">,</span>
    <span class="n">k</span><span class="o">=</span><span class="n">hk</span><span class="p">,</span>
    <span class="n">k33</span><span class="o">=</span><span class="n">hk</span><span class="p">,</span>
    <span class="n">save_specific_discharge</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.npf&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the Storage package (sto) with the ss array</span>
<span class="c1">#sto = flopy.mf6.ModflowGwfsto(gwf, ss=1.0e-05)</span>
<span class="n">sto</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfsto</span><span class="p">(</span><span class="n">gwf</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="n">ss_array</span><span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 constant head package</span>

<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfchd</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">maxbound</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">chdspd</span><span class="p">),</span>
    <span class="n">stress_period_data</span><span class="o">=</span><span class="n">chdspd</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">auxiliary</span><span class="o">=</span><span class="s2">&quot;CONCENTRATION&quot;</span><span class="p">,</span>
    <span class="n">pname</span><span class="o">=</span><span class="s2">&quot;CHD-1&quot;</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.chd&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate the wel package</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfwel</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">print_input</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">print_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">stress_period_data</span><span class="o">=</span><span class="n">spd_mf6</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">auxiliary</span><span class="o">=</span><span class="s2">&quot;CONCENTRATION&quot;</span><span class="p">,</span>
    <span class="n">pname</span><span class="o">=</span><span class="s2">&quot;WEL-1&quot;</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.wel&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 output control package for flow model</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfoc</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">head_filerecord</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.hds&quot;</span><span class="p">,</span>
    <span class="n">budget_filerecord</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.bud&quot;</span><span class="p">,</span>
    <span class="n">headprintrecord</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;COLUMNS&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;WIDTH&quot;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;DIGITS&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;GENERAL&quot;</span><span class="p">)],</span>
    <span class="n">saverecord</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;HEAD&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;BUDGET&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">)],</span>
    <span class="n">printrecord</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;HEAD&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;BUDGET&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">)],</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Transport Package Building</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###### Instantiating MODFLOW 6 groundwater transport package ##########</span>
<span class="n">gwtname</span> <span class="o">=</span> <span class="s2">&quot;gwt-&quot;</span> <span class="o">+</span> <span class="n">name</span>
<span class="n">gwt</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">MFModel</span><span class="p">(</span>
    <span class="n">sim</span><span class="p">,</span>
    <span class="n">model_type</span><span class="o">=</span><span class="s2">&quot;gwt6&quot;</span><span class="p">,</span>
    <span class="n">modelname</span><span class="o">=</span><span class="n">gwtname</span><span class="p">,</span>
    <span class="n">model_nam_file</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.nam&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="c1">#;</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
<span class="n">gwt</span><span class="o">.</span><span class="n">name_file</span><span class="o">.</span><span class="n">save_flows</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create iterative model solution and register the gwt model with it</span>
<span class="n">imsgwt</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowIms</span><span class="p">(</span>
    <span class="n">sim</span><span class="p">,</span>
    <span class="n">print_option</span><span class="o">=</span><span class="s2">&quot;SUMMARY&quot;</span><span class="p">,</span>
    <span class="n">outer_dvclose</span><span class="o">=</span><span class="n">hclose</span><span class="p">,</span>
    <span class="n">outer_maximum</span><span class="o">=</span><span class="n">nouter</span><span class="p">,</span>
    <span class="n">under_relaxation</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="n">inner_maximum</span><span class="o">=</span><span class="n">ninner</span><span class="p">,</span>
    <span class="n">inner_dvclose</span><span class="o">=</span><span class="n">hclose</span><span class="p">,</span>
    <span class="n">rcloserecord</span><span class="o">=</span><span class="n">rclose</span><span class="p">,</span>
    <span class="n">linear_acceleration</span><span class="o">=</span><span class="s2">&quot;BICGSTAB&quot;</span><span class="p">,</span>
    <span class="n">scaling_method</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="n">reordering_method</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="n">relaxation_factor</span><span class="o">=</span><span class="n">relax</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.ims&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">register_ims_package</span><span class="p">(</span><span class="n">imsgwt</span><span class="p">,</span> <span class="p">[</span><span class="n">gwt</span><span class="o">.</span><span class="n">name</span><span class="p">]);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###### Instantiating MODFLOW 6 transport discretization package #####</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtdis</span><span class="p">(</span>
    <span class="n">gwt</span><span class="p">,</span>
    <span class="n">nlay</span><span class="o">=</span><span class="n">nlay</span><span class="p">,</span>
    <span class="n">nrow</span><span class="o">=</span><span class="n">nrow</span><span class="p">,</span>
    <span class="n">ncol</span><span class="o">=</span><span class="n">ncol</span><span class="p">,</span>
    <span class="n">delr</span><span class="o">=</span><span class="n">delr</span><span class="p">,</span>
    <span class="n">delc</span><span class="o">=</span><span class="n">delc</span><span class="p">,</span>
    <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span>
    <span class="n">botm</span><span class="o">=</span><span class="n">botm</span><span class="p">,</span>
    <span class="n">idomain</span><span class="o">=</span><span class="n">idomain</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.dis&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 transport initial concentrations</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtic</span><span class="p">(</span><span class="n">gwt</span><span class="p">,</span> <span class="n">strt</span><span class="o">=</span><span class="n">sconc</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.ic&quot;</span><span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 transport advection package</span>
<span class="k">if</span> <span class="n">mixelm</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;UPSTREAM&quot;</span>
<span class="k">elif</span> <span class="n">mixelm</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;TVD&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">()</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtadv</span><span class="p">(</span><span class="n">gwt</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.adv&quot;</span><span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 transport dispersion package</span>
<span class="k">if</span> <span class="n">al</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtdsp</span><span class="p">(</span>
        <span class="n">gwt</span><span class="p">,</span>
        <span class="c1">#alh=al, # longitudinal</span>
        <span class="n">alh</span> <span class="o">=</span> <span class="n">displ_array</span><span class="p">,</span>
        <span class="c1">#ath1=ath1, # transverse</span>
        <span class="n">ath1</span> <span class="o">=</span> <span class="n">dispt_array</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.dsp&quot;</span><span class="p">,</span>
        <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 transport mass storage package</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtmst</span><span class="p">(</span>
    <span class="n">gwt</span><span class="p">,</span>
    <span class="n">porosity</span><span class="o">=</span><span class="n">pors_array</span><span class="p">,</span>
<span class="c1">##    porosity=prsity,</span>
    <span class="n">first_order_decay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">decay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">decay_sorbed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">sorption</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bulk_density</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">distcoef</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.mst&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 transport source-sink mixing package</span>
<span class="n">sourcerecarray</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;WEL-1&quot;</span><span class="p">,</span> <span class="s2">&quot;AUX&quot;</span><span class="p">,</span> <span class="s2">&quot;CONCENTRATION&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;CHD-1&quot;</span><span class="p">,</span> <span class="s2">&quot;AUX&quot;</span><span class="p">,</span> <span class="s2">&quot;CONCENTRATION&quot;</span><span class="p">),</span>
    <span class="p">]</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtssm</span><span class="p">(</span>
    <span class="n">gwt</span><span class="p">,</span>
    <span class="n">sources</span><span class="o">=</span><span class="n">sourcerecarray</span><span class="p">,</span>
    <span class="n">print_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.ssm&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 transport output control package</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtoc</span><span class="p">(</span>
    <span class="n">gwt</span><span class="p">,</span>
    <span class="n">budget_filerecord</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.cbc&quot;</span><span class="p">,</span>
    <span class="n">concentration_filerecord</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.ucn&quot;</span><span class="p">,</span>
    <span class="n">concentrationprintrecord</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;COLUMNS&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;WIDTH&quot;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;DIGITS&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;GENERAL&quot;</span><span class="p">)],</span>
    <span class="n">saverecord</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;CONCENTRATION&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;BUDGET&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">)],</span>
    <span class="n">printrecord</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;CONCENTRATION&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;BUDGET&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">)],</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.oc&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 flow-transport exchange mechanism</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfgwt</span><span class="p">(</span>
    <span class="n">sim</span><span class="p">,</span>
    <span class="n">exgtype</span><span class="o">=</span><span class="s2">&quot;GWF6-GWT6&quot;</span><span class="p">,</span>
    <span class="n">exgmnamea</span><span class="o">=</span><span class="n">gwfname</span><span class="p">,</span>
    <span class="n">exgmnameb</span><span class="o">=</span><span class="n">gwtname</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.gwfgwt&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Generate the Files</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">write_simulation</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Running the Model</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#success, buff = sim.run_simulation(silent=False, report=True)#Verbose output</span>
<span class="n">success</span><span class="p">,</span> <span class="n">buff</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1">#Suppress output</span>
<span class="k">assert</span> <span class="n">success</span><span class="p">,</span> <span class="n">pformat</span><span class="p">(</span><span class="n">buff</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="plotting-results">
<h3>Plotting results<a class="headerlink" href="#plotting-results" title="Link to this heading">#</a></h3>
<p>Plotting model results.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A lot of reverse engineering to produce plots; am positive this is not the best way to make the plots, but was using the original example link as a go-by.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="c1"># Figure properties</span>
<span class="n">figure_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1"># Get the MF6 concentration output</span>
<span class="n">gwt</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">model_names</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ucnobj_mf6</span> <span class="o">=</span> <span class="n">gwt</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">concentration</span><span class="p">()</span>
<span class="n">conc_mf6</span> <span class="o">=</span> <span class="n">ucnobj_mf6</span><span class="o">.</span><span class="n">get_alldata</span><span class="p">()</span>


<span class="c1"># Create figure for scenario</span>
<span class="k">with</span> <span class="n">styles</span><span class="o">.</span><span class="n">USGSPlot</span><span class="p">()</span> <span class="k">as</span> <span class="n">fs</span><span class="p">:</span>
    <span class="n">sim_name</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">name</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;lines.dashed_pattern&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
    <span class="n">stp_idx</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 0-based (out of 2 possible stress periods)</span>
<span class="c1"># Plot after 8 years</span>
    <span class="n">axWasNone</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1">#    if ax is None:</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axWasNone</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">cflood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_less_equal</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="n">stp_idx</span><span class="p">],</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">gwf</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;RdYlGn_r&quot;</span><span class="p">))</span>
    <span class="c1">#cmap = plt.get_cmap(&#39;RdYlGn_r&#39;)</span>
    <span class="n">cmap</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;saddlebrown&#39;</span><span class="p">,</span> <span class="s1">&#39;goldenrod&#39;</span><span class="p">]</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
    <span class="c1">#mm.plot_array(hk, masked_values=[hk[0, 0, 0]], alpha=0.8, cmap = cmap)</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">hk</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">)</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">plot_ibound</span><span class="p">()</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;.5&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;RdYlGn_r&quot;</span><span class="p">))</span>
    <span class="c1">#cmap = plt.get_cmap(&#39;RdYlGn_r&#39;)</span>
    <span class="n">cmap</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">cflood</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">)</span>
<span class="c1"># Add a colorbar to the plot</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>  <span class="c1"># Use orientation=&#39;horizontal&#39; if preferred</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Concentration (ppm)&#39;</span><span class="p">)</span>  <span class="c1"># Replace with appropriate label for your data</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">contour_array</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="n">stp_idx</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance Along X-Axis, in meters&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Distance Along Y-Axis, in meters&quot;</span><span class="p">)</span>

    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MF6 - End of Stress Period &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stp_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># set idx</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">letter</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">styles</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="n">letter</span><span class="p">,</span> <span class="n">heading</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    
<span class="c1"># second stress period</span>
    <span class="n">stp_idx</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 0-based (out of 2 possible stress periods)</span>
    <span class="k">if</span> <span class="n">axWasNone</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;subplot2&quot;</span><span class="p">)</span>
    <span class="n">cflood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_less_equal</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="n">stp_idx</span><span class="p">],</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">gwf</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;saddlebrown&#39;</span><span class="p">,</span> <span class="s1">&#39;goldenrod&#39;</span><span class="p">]</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
    <span class="c1">#mm.plot_array(hk, masked_values=[hk[0, 0, 0]], alpha=0.8, cmap = cmap)</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">hk</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">)</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">plot_ibound</span><span class="p">()</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;.5&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;RdYlGn_r&quot;</span><span class="p">))</span>
    <span class="c1">#cmap = plt.get_cmap(&#39;RdYlGn_r&#39;)</span>
    <span class="n">cmap</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">cflood</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">)</span>
<span class="c1"># Add a colorbar to the plot</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>  <span class="c1"># Use orientation=&#39;horizontal&#39; if preferred</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Concentration (ppm)&#39;</span><span class="p">)</span>  <span class="c1"># Replace with appropriate label for your data</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">contour_array</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="n">stp_idx</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance Along X-Axis, in meters&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Distance Along Y-Axis, in meters&quot;</span><span class="p">)</span>

    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MF6 - End of Stress Period &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stp_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># set idx</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">letter</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">styles</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="n">letter</span><span class="p">,</span> <span class="n">heading</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/d4a0199b6ac39f41def13f9f1ed371f21ed4bc7f6f4dc9499928db33cd355076.png" src="../../../_images/d4a0199b6ac39f41def13f9f1ed371f21ed4bc7f6f4dc9499928db33cd355076.png" />
</div>
</div>
<p>In the figures above, the brown rectangle contained within the goldenrod rectangle represent two different horizontal hydraulic conductivities. The goldenrod color represents the conductivity of a medium grain material, <span class="math notranslate nohighlight">\(K_1 = 1.474\times 10^{-4}~\frac{m}{sec}\)</span>. The brown color represents theconductivity of a fine grain material, <span class="math notranslate nohighlight">\(K_2 = 1.474 \times 10^{-7}~\frac{m}{sec}\)</span>.</p>
<p>The plume ‚Äúcolor map‚Äù is overlain on the material property map, and is set to opaque (not transparent).  The color ramp is and inverted GreenYellowRed.  High values render as red, lowest as green.</p>
<p>Extract concentrations for a specific location, first learn about the array</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape:&quot;</span><span class="p">,</span> <span class="n">conc_mf6</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (rows, columns, depth, etc.)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data type:&quot;</span><span class="p">,</span> <span class="n">conc_mf6</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of dimensions:&quot;</span><span class="p">,</span> <span class="n">conc_mf6</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape: (2, 1, 14, 10)
Data type: float64
Number of dimensions: 4
</pre></div>
</div>
</div>
</div>
<p>My guess is there are two time components (dim0), 1 layer (dim1), and 14 rows (dim2), and 10 columns (dim3).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W1 Conc SP1&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W1 Conc SP2&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W2 Conc SP1&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">][</span><span class="mi">7</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W2 Conc SP2&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">][</span><span class="mi">7</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W3 Conc SP1&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W3 Conc SP2&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>

<span class="c1">#print(&quot;I1 Conc SP1&quot;,round(conc_mf6[0][0][4][4],3))</span>
<span class="c1">#print(&quot;I1 Conc SP2&quot;,round(conc_mf6[1][0][4][4],3))</span>
<span class="c1">#print(&quot;I2 Conc SP1&quot;,round(conc_mf6[0][0][4][6],3))</span>
<span class="c1">#print(&quot;I2 Conc SP2&quot;,round(conc_mf6[1][0][4][6],3))</span>
<span class="c1">#print(&quot;I3 Conc SP1&quot;,round(conc_mf6[0][0][7][8],3))</span>
<span class="c1">#print(&quot;I3 Conc SP2&quot;,round(conc_mf6[1][0][7][8],3))</span>
<span class="c1">#$(0, 11, 5), qW1, cW1])  # Pumping well</span>
<span class="c1">#wellist_sp2.append([(0, 11, 7), qW2, cW2])  # Pumping well</span>
<span class="c1">#wellist_sp2.append([(0, 11, 8)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>W1 Conc SP1 0.0
W1 Conc SP2 15.247
W2 Conc SP1 0.0
W2 Conc SP2 153.983
W3 Conc SP1 0.0
W3 Conc SP2 328.63
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="appendix-i-scenario-2">
<h1>Appendix I: Scenario 2<a class="headerlink" href="#appendix-i-scenario-2" title="Link to this heading">#</a></h1>
<p>Inputs: Injection of 20 cfs at I-3, 10 cfs at I-1.
Outputs: Tracer concentration at wells: W-1: [Concentration] mg/L ;W-2: [Concentration] mg/L; W-3: [Concentration] mg/L</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">reset</span> -f
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The script generates a lot of output that are suppressed by a <code class="docutils literal notranslate"><span class="pre">;</span></code>  Comment the character out to re-enable full output (which is damn helpful for debugging the script!)</p>
</div>
<section id="id2">
<h2>Initial setup<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>Import dependencies, define the example name and workspace, and read settings from environment variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pformat</span>
<span class="kn">import</span> <span class="nn">flopy</span>
<span class="kn">import</span> <span class="nn">git</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">flopy.plot.styles</span> <span class="kn">import</span> <span class="n">styles</span>
<span class="kn">from</span> <span class="nn">modflow_devtools.misc</span> <span class="kn">import</span> <span class="n">get_env</span><span class="p">,</span> <span class="n">timed</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>pwd
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/webroot/ce-5364-webroot/ce5364jupyterbook/chapters/12.01usgsmodflow6/mf6-pr2
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The code block above loads various modules into the environment; they must exist and be loaded into the kernel - if not you get a warning ‚ÄúModule Not Found‚Äù and will have to install into the kernel (i.e. <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">-m</span> <span class="pre">install</span> <span class="pre">module</span></code>, or the <code class="docutils literal notranslate"><span class="pre">conda</span></code> equivalent
Filter warnings repeated to achieve ‚Äúfor sure ‚Ä¶‚Äù that the filter is applied.  By design the filter will not stop ERRORS, and warnings issued within functions will still display, but it will address one annoying deprecation error.</p>
</div>
<section id="id3">
<h3>Define parameters<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Define model units, spatial, and temporal discritization settings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read control file</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-base.txt&quot;</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># Assign Properties</span>
<span class="n">length_units</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">time_units</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">nlay</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># Number of layers</span>
<span class="n">nrow</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>  <span class="c1"># Number of rows</span>
<span class="n">ncol</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>  <span class="c1"># Number of columns</span>
<span class="n">delr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>  <span class="c1"># Column width ($m$)</span>
<span class="n">delc</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>  <span class="c1"># Row width ($m$)</span>
<span class="n">delz</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>  <span class="c1"># Layer thickness ($m$)</span>
<span class="n">top</span>  <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>  <span class="c1"># Top of the model ($m$)</span>

<span class="c1">#</span>

<span class="c1"># more above</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h3>Read Hydraulic Conductivity<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>Read the hydraulic conductivity array (float) arranged in layer,row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read hydraulic conductivity array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-hydcond.txt&quot;</span>
<span class="n">hk</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">hk</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">hk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hk</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id5">
<h3>Read Boundary Array<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p>Read the boundary indication array (integer) arranged in layer,row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read boundary array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-ibound.txt&quot;</span>
<span class="n">ibound</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">ibound</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">ibound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ibound</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h3>Read Computation Domain Array<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<p>Read the computation domain array (integer) indicating active/inactive cells arranged in layer,row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read idomain array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-idomain.txt&quot;</span>
<span class="n">idomain</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">idomain</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">idomain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idomain</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id7">
<h1>Render the array into a visual representation - will repeat this code block as needed<a class="headerlink" href="#id7" title="Link to this heading">#</a></h1>
<p>import matplotlib.pyplot as plt
import numpy as np</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id8">
<h1>Example 2D array (you would replace this with your actual data)<a class="headerlink" href="#id8" title="Link to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id9">
<h1>Assuming my_array2D is your 2D array (nrow x ncol)<a class="headerlink" href="#id9" title="Link to this heading">#</a></h1>
<p>my_array2D = idomain  # Replace with your actual array</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id10">
<h1>Plot the 2D array using imshow<a class="headerlink" href="#id10" title="Link to this heading">#</a></h1>
<p>plt.figure(figsize=(14, 10))  # Optional: set the figure size
plt.imshow(my_array2D, cmap=‚Äôviridis‚Äô, interpolation=‚Äônone‚Äô)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id11">
<h1>Add a colorbar to indicate the value scale<a class="headerlink" href="#id11" title="Link to this heading">#</a></h1>
<p>plt.colorbar(label=‚ÄôArray Value‚Äô)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id12">
<h1>Add the grid<a class="headerlink" href="#id12" title="Link to this heading">#</a></h1>
<p>plt.grid(visible=True, color=‚Äôblack‚Äô, linestyle=‚Äô-‚Äô, linewidth=0.1)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id13">
<h1>Customize the grid to align with the image cells<a class="headerlink" href="#id13" title="Link to this heading">#</a></h1>
<p>plt.gca().set_xticks(np.arange(-0.5, my_array2D.shape[1], 1), minor=True)
plt.gca().set_yticks(np.arange(-0.5, my_array2D.shape[0], 1), minor=True)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id14">
<h1>Enable minor ticks to show the grid at each cell<a class="headerlink" href="#id14" title="Link to this heading">#</a></h1>
<p>plt.gca().grid(which=‚Äôminor‚Äô, color=‚Äôblack‚Äô, linestyle=‚Äô-‚Äô, linewidth=1.5)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id15">
<h1>Disable the default major ticks<a class="headerlink" href="#id15" title="Link to this heading">#</a></h1>
<p>plt.gca().tick_params(which=‚Äômajor‚Äô, bottom=False, left=False)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id16">
<h1>Add row and column labels<a class="headerlink" href="#id16" title="Link to this heading">#</a></h1>
<p>rows, cols = my_array2D.shape
plt.xticks(np.arange(cols), labels=[f‚ÄôCol {i}‚Äô for i in range(cols)])
plt.yticks(np.arange(rows), labels=[f‚ÄôRow {i}‚Äô for i in range(rows)])</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id17">
<h1>Optional: Add labels for clarity<a class="headerlink" href="#id17" title="Link to this heading">#</a></h1>
<p>plt.title(‚Äò2D Array Visualization for array: idomain‚Äô)
plt.xlabel(‚ÄòColumn Index‚Äô)
plt.ylabel(‚ÄòRow Index‚Äô)</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id18">
<h1>Display the plot<a class="headerlink" href="#id18" title="Link to this heading">#</a></h1>
<p>plt.show()</p>
<section id="id19">
<h2>Read storage array<a class="headerlink" href="#id19" title="Link to this heading">#</a></h2>
<p>Read the storage coefficient array (float) arranged in layer,row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read storativity array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-storage.txt&quot;</span>
<span class="n">ss_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">ss_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">ss_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ss_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id20">
<h2>Read porosity array<a class="headerlink" href="#id20" title="Link to this heading">#</a></h2>
<p>Read theporosity array (float) arranged in layer, row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read porosity array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-porosity.txt&quot;</span>
<span class="n">pors_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">pors_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">pors_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pors_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id21">
<h2>Read longitudinal dispersivity array<a class="headerlink" href="#id21" title="Link to this heading">#</a></h2>
<p>Read the longitudinal dispersivity array (float) arranged in layer, row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read longitudinal dispersivity array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-disperl.txt&quot;</span>
<span class="n">displ_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">displ_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">displ_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">displ_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id22">
<h2>Read transverse dispersivity array<a class="headerlink" href="#id22" title="Link to this heading">#</a></h2>
<p>Read the transverse dispersivity array (float) arranged in layer, row, column format.  Read one times per model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read dispersivity in y-direction array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-dispert.txt&quot;</span>
<span class="n">dispt_array</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">dispt_array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">dispt_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dispt_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read initial heads array</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;pr2-input-headinit.txt&quot;</span>
<span class="n">strt</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Read the file</span>
<span class="n">afile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>  <span class="c1"># connect and read file for base input</span>
<span class="k">for</span> <span class="n">ilay</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlay</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">afile</span><span class="p">:</span>
        <span class="n">strt</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
<span class="n">afile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># convert into numpy array</span>
<span class="n">strt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">strt</span><span class="p">)</span>

<span class="n">strt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[9999.99 , 9999.99 , 9999.99 , 9999.99 , 9999.99 , 9999.99 ,
        9999.99 , 9999.99 , 9999.99 , 9999.99 ],
       [9999.99 ,  600.   ,  600.   ,  600.   ,  600.   ,  600.   ,
         600.   ,  600.   ,  600.   , 9999.99 ],
       [9999.99 ,  598.627,  598.635,  598.651,  598.671,  598.685,
         598.696,  598.698,  598.699, 9999.99 ],
       [9999.99 ,  597.244,  597.263,  597.299,  597.347,  597.373,
         597.4  ,  597.399,  597.398, 9999.99 ],
       [9999.99 ,  595.844,  595.873,  595.935,  596.046,  596.058,
         596.134,  596.1  ,  596.095, 9999.99 ],
       [9999.99 ,  592.981,  593.023,  593.102,  593.21 ,  593.295,
         593.388,  593.439,  593.477, 9999.99 ],
       [9999.99 ,  588.644,  588.707,  588.823,  588.976,  589.14 ,
         589.307,  589.46 ,  589.587, 9999.99 ],
       [9999.99 ,  584.245,  584.338,  584.507,  584.73 ,  584.981,
         585.242,  585.506,  585.823, 9999.99 ],
       [9999.99 ,  579.753,  579.891,  580.139,  580.457,  580.812,
         581.174,  581.498,  581.729, 9999.99 ],
       [9999.99 ,  569.734,  570.035,  570.535,  571.135,  571.774,
         572.459,  573.025,  573.375, 9999.99 ],
       [9999.99 ,  554.028,  554.679,  555.666,  556.761,  557.828,
         559.177,  560.211,  560.877, 9999.99 ],
       [9999.99 ,  537.671,  538.985,  540.691,  542.414,  543.602,
         546.211,  547.765,  549.045, 9999.99 ],
       [9999.99 ,  520.   ,  522.9  ,  525.7  ,  528.6  ,  531.4  ,
         534.3  ,  537.1  ,  540.   , 9999.99 ],
       [9999.99 , 9999.99 , 9999.99 , 9999.99 , 9999.99 , 9999.99 ,
        9999.99 , 9999.99 , 9999.99 , 9999.99 ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mf">0.01548</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.01548
</pre></div>
</div>
</div>
</div>
</section>
<section id="id23">
<h2>Pumping and Injection Wells<a class="headerlink" href="#id23" title="Link to this heading">#</a></h2>
<p>Define wellfield settings, here we are using scripting to build the input structure, bou could just as well use a file read structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Wellfield Conditions</span>
<span class="c1"># MF2K5 pumping/injection rates in length-time units</span>
<span class="c1"># CFS pumping is negative</span>
<span class="n">qW1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">16.0</span> 
<span class="n">qW2</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">7.0</span>
<span class="n">qW3</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">7.0</span>
<span class="c1"># CFS injection is positive</span>
<span class="n">qI1</span> <span class="o">=</span> <span class="mf">10.0</span> 
<span class="n">qI2</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">qI3</span> <span class="o">=</span> <span class="mf">20.0</span>
<span class="c1"># Concentrations </span>
<span class="c1"># PPM pumping (set pumpings to zero value)</span>
<span class="n">cW1</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">cW2</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">cW3</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="c1"># PPM injection</span>
<span class="n">cI1</span> <span class="o">=</span> <span class="mf">1000.0</span>
<span class="n">cI2</span> <span class="o">=</span> <span class="mf">1000.0</span>
<span class="n">cI3</span> <span class="o">=</span> <span class="mf">1000.0</span>
<span class="c1">#spd = {</span>
 <span class="c1">#   0: [[0, 3, 6, cwell1, 2], [0, 10, 6, cwell0, 2]],</span>
  <span class="c1">#  1: [[0, 3, 6, cwell0, 2], [0, 10, 6, cwell0, 2]],</span>
<span class="c1">#}  # Well info 4 MT3D</span>
<span class="c1"># Build MF6 wellfield objects</span>
<span class="n">wellist_sp1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#                   (k,  i, j),   flow,  conc</span>
<span class="n">wellist_sp1</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">qI1</span><span class="p">,</span> <span class="n">cI1</span><span class="p">])</span>  <span class="c1"># Injection well</span>
<span class="n">wellist_sp1</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">qI1</span><span class="p">,</span> <span class="n">cI2</span><span class="p">])</span>  <span class="c1"># Injection well</span>
<span class="n">wellist_sp1</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">qI1</span><span class="p">,</span> <span class="n">cI3</span><span class="p">])</span>  <span class="c1"># Injection well #3  ACTIVE THIS SCENARIO</span>
<span class="n">wellist_sp1</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">qW1</span><span class="p">,</span> <span class="n">cW1</span><span class="p">])</span>  <span class="c1"># Pumping well</span>
<span class="n">wellist_sp1</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">qW2</span><span class="p">,</span> <span class="n">cW2</span><span class="p">])</span>  <span class="c1"># Pumping well</span>
<span class="n">wellist_sp1</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">qW3</span><span class="p">,</span> <span class="n">cW3</span><span class="p">])</span>  <span class="c1"># Pumping well</span>
<span class="c1">#</span>
<span class="n">wellist_sp2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#                   (k,  i, j),   flow,  conc</span>
<span class="n">wellist_sp2</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">qI1</span><span class="p">,</span> <span class="n">cI1</span><span class="p">])</span>  <span class="c1"># Injection well</span>
<span class="n">wellist_sp2</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">qI2</span><span class="p">,</span> <span class="n">cI2</span><span class="p">])</span>  <span class="c1"># Injection well</span>
<span class="n">wellist_sp2</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">qI3</span><span class="p">,</span> <span class="n">cI3</span><span class="p">])</span>  <span class="c1"># Injection well  #3  ACTIVE THIS SCENARIO</span>
<span class="n">wellist_sp2</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">qW1</span><span class="p">,</span> <span class="n">cW1</span><span class="p">])</span>  <span class="c1"># Pumping well</span>
<span class="n">wellist_sp2</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">qW2</span><span class="p">,</span> <span class="n">cW2</span><span class="p">])</span>  <span class="c1"># Pumping well</span>
<span class="n">wellist_sp2</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">qW3</span><span class="p">,</span> <span class="n">cW3</span><span class="p">])</span>  <span class="c1"># Pumping well</span>
<span class="c1">#</span>
<span class="n">spd_mf6</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">wellist_sp1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">wellist_sp2</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id24">
<h2>Define parameters<a class="headerlink" href="#id24" title="Link to this heading">#</a></h2>
<p>Define model units, spatial, and temporal discritization settings.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model units</span>
<span class="c1">#length_units = &quot;meters&quot;</span>
<span class="c1">#time_units = &quot;seconds&quot;</span>

<span class="c1"># Model parameters</span>
<span class="c1">#nlay = 1  # Number of layers</span>
<span class="c1">#nrow = 18  # Number of rows</span>
<span class="c1">#ncol = 14  # Number of columns</span>
<span class="c1">#delr = 100.0  # Column width ($m$)</span>
<span class="c1">#delc = 100.0  # Row width ($m$)</span>
<span class="c1">#delz = 10.0  # Layer thickness ($m$)</span>
<span class="c1">#top = 0.0  # Top of the model ($m$)</span>
<span class="c1">#prsity = 0.3  # Porosity - array reader above</span>
<span class="n">k1</span> <span class="o">=</span> <span class="mf">1.474e-4</span>  <span class="c1"># Horiz. hyd. conductivity of medium grain material ($m/sec$)</span>
<span class="n">k2</span> <span class="o">=</span> <span class="mf">1.474e-7</span>  <span class="c1"># Horiz. hyd. conductivity of fine grain material ($m/sec$)</span>
<span class="n">inj</span> <span class="o">=</span> <span class="mf">0.001</span>  <span class="c1"># Injection well rate ($m^3/sec$)</span>
<span class="n">ext</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0189</span>  <span class="c1"># Extraction well pumping rate ($m^3/sec$)</span>
<span class="n">al</span> <span class="o">=</span> <span class="mf">20.0</span>  <span class="c1"># Longitudinal dispersivity ($m$)</span>
<span class="n">trpt</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Ratio of horiz. transverse to longitudinal dispersivity ($m$)</span>
<span class="n">perlen</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># Simulation time ($years$)</span>

<span class="c1"># Additional model input</span>
<span class="c1">#hk = k1 * np.ones((nlay, nrow, ncol), dtype=float)</span>
<span class="c1">#hk[:, 5:8, 1:8] = k2</span>
<span class="n">laytyp</span> <span class="o">=</span> <span class="n">icelltype</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Active model domain</span>
<span class="c1">#ibound = np.ones((nlay, nrow, ncol), dtype=int)</span>
<span class="c1">#ibound[0, 0, :] = -1</span>
<span class="c1">#ibound[0, -1, :] = -1</span>
<span class="c1">#idomain = np.ones((nlay, nrow, ncol), dtype=int)</span>
<span class="n">icbund</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Boundary conditions</span>

<span class="c1"># Transport related</span>
<span class="n">sconc</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">ath1</span> <span class="o">=</span> <span class="n">al</span> <span class="o">*</span> <span class="n">trpt</span>
<span class="n">dmcoef</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># m^2/s</span>
<span class="c1"># Time variables</span>
<span class="n">perlen</span> <span class="o">=</span> <span class="p">[</span><span class="mf">365.0</span> <span class="o">*</span> <span class="mi">86400</span><span class="p">,</span> <span class="mf">365.0</span> <span class="o">*</span> <span class="mi">86400</span><span class="p">]</span>
<span class="n">steady</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">nper</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">perlen</span><span class="p">)</span>
<span class="n">nstp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">365</span><span class="p">,</span> <span class="mi">365</span><span class="p">]</span>
<span class="n">tsmult</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="c1">#</span>
<span class="n">sconc</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">c0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">botm</span> <span class="o">=</span> <span class="p">[</span><span class="n">top</span> <span class="o">-</span> <span class="n">delz</span><span class="p">]</span>
<span class="n">mixelm</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="c1"># Solver settings</span>
<span class="n">nouter</span><span class="p">,</span> <span class="n">ninner</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">300</span>
<span class="n">hclose</span><span class="p">,</span> <span class="n">rclose</span><span class="p">,</span> <span class="n">relax</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1e-6</span><span class="p">,</span> <span class="mf">1.0</span>
<span class="n">percel</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># HMOC parameters</span>
<span class="n">itrack</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">wd</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">dceps</span> <span class="o">=</span> <span class="mf">1.0e-5</span>
<span class="n">nplane</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">npl</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">nph</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">npmin</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">npmax</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">dchmoc</span> <span class="o">=</span> <span class="mf">1.0e-3</span>
<span class="n">nlsink</span> <span class="o">=</span> <span class="n">nplane</span>
<span class="n">npsink</span> <span class="o">=</span> <span class="n">nph</span>
<span class="n">nadvfd</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id25">
<h2>Model setup<a class="headerlink" href="#id25" title="Link to this heading">#</a></h2>
<p>Define functions to build models, write input files, and run the simulation.</p>
<p><strong>Groundwater Flow Package Build</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Workspace and Executibles</span>
<span class="n">binary</span> <span class="o">=</span> <span class="s2">&quot;/home/sensei/ce-4363-webroot/ModflowExperimental/mf6-arm/mf6&quot;</span>  <span class="c1"># location on MY computer of the compiled modflow program</span>
<span class="n">workarea</span> <span class="o">=</span> <span class="s2">&quot;/home/sensei/ce-4363-webroot/ModflowExperimental/mf6-arm/mf6-pr2&quot;</span> <span class="c1"># location on MY computer to store files this example (directory must already exist)</span>
<span class="c1">#workarea = workspace # location on MY computer to store files this example (directory must already exist)</span>

<span class="n">binary</span> <span class="o">=</span> <span class="s2">&quot;/home/sensei/mfplayground/modflow-python/mf6.4.1_linux/bin/mf6&quot;</span>  <span class="c1"># location on AWS computer of the compiled modflow program</span>
<span class="n">workarea</span> <span class="o">=</span> <span class="s2">&quot;/home/sensei/ce-5364-webroot/mfexperiments/mf6-pr2&quot;</span> <span class="c1"># location on MY computer to store files this example (directory must already exist)</span>



<span class="c1"># Set Simulation Name(s)</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;mf6-pr2&quot;</span>
<span class="n">gwfname</span> <span class="o">=</span> <span class="s2">&quot;gwf-&quot;</span> <span class="o">+</span> <span class="n">name</span>
<span class="n">gwtname</span> <span class="o">=</span> <span class="s2">&quot;gwt-&quot;</span> <span class="o">+</span> <span class="n">name</span>

<span class="c1">##### FLOPY Build simulation framework ####</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">MFSimulation</span><span class="p">(</span>
    <span class="n">sim_name</span><span class="o">=</span><span class="s2">&quot;sim-&quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">exe_name</span><span class="o">=</span><span class="n">binary</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;mf6&quot;</span><span class="p">,</span> <span class="n">sim_ws</span><span class="o">=</span><span class="n">workarea</span>
<span class="p">)</span>
<span class="c1">####### CREATED &quot;/home/sensei/ce-4363-webroot/ModflowExperimental/mf6-arm/mt3d_example9&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">####### Instantiating MODFLOW 6 time discretization ########</span>
<span class="n">tdis_rc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nper</span><span class="p">):</span>
    <span class="n">tdis_rc</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">perlen</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">nstp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tsmult</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowTdis</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">nper</span><span class="o">=</span><span class="n">nper</span><span class="p">,</span> <span class="n">perioddata</span><span class="o">=</span><span class="n">tdis_rc</span><span class="p">,</span> <span class="n">time_units</span><span class="o">=</span><span class="n">time_units</span><span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">####### Instantiating MODFLOW 6 groundwater flow model ########</span>
<span class="c1"># Set Model Name (using same base name as the simulation)</span>
<span class="n">model_nam_file</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.nam&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gwfname</span><span class="p">)</span>
<span class="c1"># create MODFLOW6 flow model framework</span>
<span class="n">gwf</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwf</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">modelname</span><span class="o">=</span><span class="n">gwfname</span><span class="p">,</span> <span class="n">save_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">model_nam_file</span><span class="o">=</span><span class="n">model_nam_file</span><span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###### Instantiating MODFLOW 6 solver for flow model #######</span>
<span class="c1"># Set Iterative Model Solution (choose solver parameters)</span>
<span class="c1"># about IMS see: https://water.usgs.gov/nrp/gwsoftware/ModelMuse/Help/sms_sparse_matrix_solution_pac.htm</span>
<span class="c1"># using defaults see: https://flopy.readthedocs.io/en/3.3.2/source/flopy.mf6.modflow.mfims.html</span>
<span class="n">imsgwf</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowIms</span><span class="p">(</span>
    <span class="n">sim</span><span class="p">,</span>
    <span class="n">print_option</span><span class="o">=</span><span class="s2">&quot;SUMMARY&quot;</span><span class="p">,</span>
    <span class="n">outer_dvclose</span><span class="o">=</span><span class="n">hclose</span><span class="p">,</span>
    <span class="n">outer_maximum</span><span class="o">=</span><span class="n">nouter</span><span class="p">,</span>
    <span class="n">under_relaxation</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="n">inner_maximum</span><span class="o">=</span><span class="n">ninner</span><span class="p">,</span>
    <span class="n">inner_dvclose</span><span class="o">=</span><span class="n">hclose</span><span class="p">,</span>
    <span class="n">rcloserecord</span><span class="o">=</span><span class="n">rclose</span><span class="p">,</span>
    <span class="n">linear_acceleration</span><span class="o">=</span><span class="s2">&quot;CG&quot;</span><span class="p">,</span>
    <span class="n">scaling_method</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="n">reordering_method</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="n">relaxation_factor</span><span class="o">=</span><span class="n">relax</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.ims&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">register_ims_package</span><span class="p">(</span><span class="n">imsgwf</span><span class="p">,</span> <span class="p">[</span><span class="n">gwf</span><span class="o">.</span><span class="n">name</span><span class="p">]);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###### Instantiating MODFLOW 6 discretization package ######</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfdis</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">length_units</span><span class="o">=</span><span class="n">length_units</span><span class="p">,</span>
    <span class="n">nlay</span><span class="o">=</span><span class="n">nlay</span><span class="p">,</span>
    <span class="n">nrow</span><span class="o">=</span><span class="n">nrow</span><span class="p">,</span>
    <span class="n">ncol</span><span class="o">=</span><span class="n">ncol</span><span class="p">,</span>
    <span class="n">delr</span><span class="o">=</span><span class="n">delr</span><span class="p">,</span>
    <span class="n">delc</span><span class="o">=</span><span class="n">delc</span><span class="p">,</span>
    <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span>
    <span class="n">botm</span><span class="o">=</span><span class="n">botm</span><span class="p">,</span>
    <span class="n">idomain</span><span class="o">=</span><span class="n">idomain</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.dis&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build MF6 constant head boundaries:</span>
<span class="n">xc</span> <span class="o">=</span> <span class="n">gwf</span><span class="o">.</span><span class="n">modelgrid</span><span class="o">.</span><span class="n">xcellcenters</span>
<span class="n">chdspd</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Loop through the top &amp; bottom sides.</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="c1">#for j in np.arange(ncol):</span>
<span class="c1">#               l,  r, c,  head, conc</span>
    <span class="n">chdspd</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="mf">600.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># Top boundary</span>
    <span class="n">hd</span> <span class="o">=</span> <span class="mf">520.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">xc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">xc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">2.8572</span> <span class="o">/</span> <span class="mi">1500</span>
    <span class="n">chdspd</span><span class="o">.</span><span class="n">append</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">hd</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># Bottom boundary</span>
<span class="n">chdspd</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">chdspd</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###### Instantiating MODFLOW 6 initial conditions package for flow model #######</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfic</span><span class="p">(</span><span class="n">gwf</span><span class="p">,</span> <span class="n">strt</span><span class="o">=</span><span class="n">strt</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.ic&quot;</span><span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 node-property flow package</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfnpf</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">icelltype</span><span class="o">=</span><span class="n">icelltype</span><span class="p">,</span>
    <span class="n">k</span><span class="o">=</span><span class="n">hk</span><span class="p">,</span>
    <span class="n">k33</span><span class="o">=</span><span class="n">hk</span><span class="p">,</span>
    <span class="n">save_specific_discharge</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.npf&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the Storage package (sto) with the ss array</span>
<span class="c1">#sto = flopy.mf6.ModflowGwfsto(gwf, ss=1.0e-05)</span>
<span class="n">sto</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfsto</span><span class="p">(</span><span class="n">gwf</span><span class="p">,</span> <span class="n">ss</span><span class="o">=</span><span class="n">ss_array</span><span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 constant head package</span>

<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfchd</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">maxbound</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">chdspd</span><span class="p">),</span>
    <span class="n">stress_period_data</span><span class="o">=</span><span class="n">chdspd</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">auxiliary</span><span class="o">=</span><span class="s2">&quot;CONCENTRATION&quot;</span><span class="p">,</span>
    <span class="n">pname</span><span class="o">=</span><span class="s2">&quot;CHD-1&quot;</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.chd&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate the wel package</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfwel</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">print_input</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">print_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">stress_period_data</span><span class="o">=</span><span class="n">spd_mf6</span><span class="p">,</span>
    <span class="n">save_flows</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">auxiliary</span><span class="o">=</span><span class="s2">&quot;CONCENTRATION&quot;</span><span class="p">,</span>
    <span class="n">pname</span><span class="o">=</span><span class="s2">&quot;WEL-1&quot;</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.wel&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 output control package for flow model</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfoc</span><span class="p">(</span>
    <span class="n">gwf</span><span class="p">,</span>
    <span class="n">head_filerecord</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.hds&quot;</span><span class="p">,</span>
    <span class="n">budget_filerecord</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwfname</span><span class="si">}</span><span class="s2">.bud&quot;</span><span class="p">,</span>
    <span class="n">headprintrecord</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;COLUMNS&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;WIDTH&quot;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;DIGITS&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;GENERAL&quot;</span><span class="p">)],</span>
    <span class="n">saverecord</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;HEAD&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;BUDGET&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">)],</span>
    <span class="n">printrecord</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;HEAD&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;BUDGET&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">)],</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Transport Package Building</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###### Instantiating MODFLOW 6 groundwater transport package ##########</span>
<span class="n">gwtname</span> <span class="o">=</span> <span class="s2">&quot;gwt-&quot;</span> <span class="o">+</span> <span class="n">name</span>
<span class="n">gwt</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">MFModel</span><span class="p">(</span>
    <span class="n">sim</span><span class="p">,</span>
    <span class="n">model_type</span><span class="o">=</span><span class="s2">&quot;gwt6&quot;</span><span class="p">,</span>
    <span class="n">modelname</span><span class="o">=</span><span class="n">gwtname</span><span class="p">,</span>
    <span class="n">model_nam_file</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.nam&quot;</span><span class="p">,</span>
    <span class="p">)</span><span class="c1">#;</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
<span class="n">gwt</span><span class="o">.</span><span class="n">name_file</span><span class="o">.</span><span class="n">save_flows</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create iterative model solution and register the gwt model with it</span>
<span class="n">imsgwt</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowIms</span><span class="p">(</span>
    <span class="n">sim</span><span class="p">,</span>
    <span class="n">print_option</span><span class="o">=</span><span class="s2">&quot;SUMMARY&quot;</span><span class="p">,</span>
    <span class="n">outer_dvclose</span><span class="o">=</span><span class="n">hclose</span><span class="p">,</span>
    <span class="n">outer_maximum</span><span class="o">=</span><span class="n">nouter</span><span class="p">,</span>
    <span class="n">under_relaxation</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="n">inner_maximum</span><span class="o">=</span><span class="n">ninner</span><span class="p">,</span>
    <span class="n">inner_dvclose</span><span class="o">=</span><span class="n">hclose</span><span class="p">,</span>
    <span class="n">rcloserecord</span><span class="o">=</span><span class="n">rclose</span><span class="p">,</span>
    <span class="n">linear_acceleration</span><span class="o">=</span><span class="s2">&quot;BICGSTAB&quot;</span><span class="p">,</span>
    <span class="n">scaling_method</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="n">reordering_method</span><span class="o">=</span><span class="s2">&quot;NONE&quot;</span><span class="p">,</span>
    <span class="n">relaxation_factor</span><span class="o">=</span><span class="n">relax</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.ims&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">register_ims_package</span><span class="p">(</span><span class="n">imsgwt</span><span class="p">,</span> <span class="p">[</span><span class="n">gwt</span><span class="o">.</span><span class="n">name</span><span class="p">]);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###### Instantiating MODFLOW 6 transport discretization package #####</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtdis</span><span class="p">(</span>
    <span class="n">gwt</span><span class="p">,</span>
    <span class="n">nlay</span><span class="o">=</span><span class="n">nlay</span><span class="p">,</span>
    <span class="n">nrow</span><span class="o">=</span><span class="n">nrow</span><span class="p">,</span>
    <span class="n">ncol</span><span class="o">=</span><span class="n">ncol</span><span class="p">,</span>
    <span class="n">delr</span><span class="o">=</span><span class="n">delr</span><span class="p">,</span>
    <span class="n">delc</span><span class="o">=</span><span class="n">delc</span><span class="p">,</span>
    <span class="n">top</span><span class="o">=</span><span class="n">top</span><span class="p">,</span>
    <span class="n">botm</span><span class="o">=</span><span class="n">botm</span><span class="p">,</span>
    <span class="n">idomain</span><span class="o">=</span><span class="n">idomain</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.dis&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 transport initial concentrations</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtic</span><span class="p">(</span><span class="n">gwt</span><span class="p">,</span> <span class="n">strt</span><span class="o">=</span><span class="n">sconc</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.ic&quot;</span><span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 transport advection package</span>
<span class="k">if</span> <span class="n">mixelm</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;UPSTREAM&quot;</span>
<span class="k">elif</span> <span class="n">mixelm</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;TVD&quot;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">()</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtadv</span><span class="p">(</span><span class="n">gwt</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.adv&quot;</span><span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 transport dispersion package</span>
<span class="k">if</span> <span class="n">al</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtdsp</span><span class="p">(</span>
        <span class="n">gwt</span><span class="p">,</span>
        <span class="c1">#alh=al, # longitudinal</span>
        <span class="n">alh</span> <span class="o">=</span> <span class="n">displ_array</span><span class="p">,</span>
        <span class="c1">#ath1=ath1, # transverse</span>
        <span class="n">ath1</span> <span class="o">=</span> <span class="n">dispt_array</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.dsp&quot;</span><span class="p">,</span>
        <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 transport mass storage package</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtmst</span><span class="p">(</span>
    <span class="n">gwt</span><span class="p">,</span>
    <span class="n">porosity</span><span class="o">=</span><span class="n">pors_array</span><span class="p">,</span>
<span class="c1">##    porosity=prsity,</span>
    <span class="n">first_order_decay</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">decay</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">decay_sorbed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">sorption</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">bulk_density</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">distcoef</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.mst&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 transport source-sink mixing package</span>
<span class="n">sourcerecarray</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;WEL-1&quot;</span><span class="p">,</span> <span class="s2">&quot;AUX&quot;</span><span class="p">,</span> <span class="s2">&quot;CONCENTRATION&quot;</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;CHD-1&quot;</span><span class="p">,</span> <span class="s2">&quot;AUX&quot;</span><span class="p">,</span> <span class="s2">&quot;CONCENTRATION&quot;</span><span class="p">),</span>
    <span class="p">]</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtssm</span><span class="p">(</span>
    <span class="n">gwt</span><span class="p">,</span>
    <span class="n">sources</span><span class="o">=</span><span class="n">sourcerecarray</span><span class="p">,</span>
    <span class="n">print_flows</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.ssm&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 transport output control package</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwtoc</span><span class="p">(</span>
    <span class="n">gwt</span><span class="p">,</span>
    <span class="n">budget_filerecord</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.cbc&quot;</span><span class="p">,</span>
    <span class="n">concentration_filerecord</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.ucn&quot;</span><span class="p">,</span>
    <span class="n">concentrationprintrecord</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;COLUMNS&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;WIDTH&quot;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s2">&quot;DIGITS&quot;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;GENERAL&quot;</span><span class="p">)],</span>
    <span class="n">saverecord</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;CONCENTRATION&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;BUDGET&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">)],</span>
    <span class="n">printrecord</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;CONCENTRATION&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;BUDGET&quot;</span><span class="p">,</span> <span class="s2">&quot;LAST&quot;</span><span class="p">)],</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gwtname</span><span class="si">}</span><span class="s2">.oc&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiating MODFLOW 6 flow-transport exchange mechanism</span>
<span class="n">flopy</span><span class="o">.</span><span class="n">mf6</span><span class="o">.</span><span class="n">ModflowGwfgwt</span><span class="p">(</span>
    <span class="n">sim</span><span class="p">,</span>
    <span class="n">exgtype</span><span class="o">=</span><span class="s2">&quot;GWF6-GWT6&quot;</span><span class="p">,</span>
    <span class="n">exgmnamea</span><span class="o">=</span><span class="n">gwfname</span><span class="p">,</span>
    <span class="n">exgmnameb</span><span class="o">=</span><span class="n">gwtname</span><span class="p">,</span>
    <span class="n">filename</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.gwfgwt&quot;</span><span class="p">,</span>
    <span class="p">);</span>
<span class="c1">## delete &quot;;&quot; in above line at end to show full output</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Generate the Files</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span><span class="o">.</span><span class="n">write_simulation</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Running the Model</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#success, buff = sim.run_simulation(silent=False, report=True)#Verbose output</span>
<span class="n">success</span><span class="p">,</span> <span class="n">buff</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run_simulation</span><span class="p">(</span><span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">report</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="c1">#Suppress output</span>
<span class="k">assert</span> <span class="n">success</span><span class="p">,</span> <span class="n">pformat</span><span class="p">(</span><span class="n">buff</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id26">
<h3>Plotting results<a class="headerlink" href="#id26" title="Link to this heading">#</a></h3>
<p>Plotting model results.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A lot of reverse engineering to produce plots; am positive this is not the best way to make the plots, but was using the original example link as a go-by.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="c1"># Figure properties</span>
<span class="n">figure_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1"># Get the MF6 concentration output</span>
<span class="n">gwt</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">model_names</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ucnobj_mf6</span> <span class="o">=</span> <span class="n">gwt</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">concentration</span><span class="p">()</span>
<span class="n">conc_mf6</span> <span class="o">=</span> <span class="n">ucnobj_mf6</span><span class="o">.</span><span class="n">get_alldata</span><span class="p">()</span>


<span class="c1"># Create figure for scenario</span>
<span class="k">with</span> <span class="n">styles</span><span class="o">.</span><span class="n">USGSPlot</span><span class="p">()</span> <span class="k">as</span> <span class="n">fs</span><span class="p">:</span>
    <span class="n">sim_name</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">name</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;lines.dashed_pattern&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
    <span class="n">stp_idx</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># 0-based (out of 2 possible stress periods)</span>
<span class="c1"># Plot after 8 years</span>
    <span class="n">axWasNone</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1">#    if ax is None:</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figure_size</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axWasNone</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">cflood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_less_equal</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="n">stp_idx</span><span class="p">],</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">gwf</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;RdYlGn_r&quot;</span><span class="p">))</span>
    <span class="c1">#cmap = plt.get_cmap(&#39;RdYlGn_r&#39;)</span>
    <span class="n">cmap</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;saddlebrown&#39;</span><span class="p">,</span> <span class="s1">&#39;goldenrod&#39;</span><span class="p">]</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
    <span class="c1">#mm.plot_array(hk, masked_values=[hk[0, 0, 0]], alpha=0.8, cmap = cmap)</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">hk</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">)</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">plot_ibound</span><span class="p">()</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;.5&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;RdYlGn_r&quot;</span><span class="p">))</span>
    <span class="c1">#cmap = plt.get_cmap(&#39;RdYlGn_r&#39;)</span>
    <span class="n">cmap</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">cflood</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">)</span>
<span class="c1"># Add a colorbar to the plot</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>  <span class="c1"># Use orientation=&#39;horizontal&#39; if preferred</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Concentration (ppm)&#39;</span><span class="p">)</span>  <span class="c1"># Replace with appropriate label for your data</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">contour_array</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="n">stp_idx</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance Along X-Axis, in meters&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Distance Along Y-Axis, in meters&quot;</span><span class="p">)</span>

    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MF6 - End of Stress Period &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stp_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># set idx</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">letter</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">styles</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="n">letter</span><span class="p">,</span> <span class="n">heading</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
    
<span class="c1"># second stress period</span>
    <span class="n">stp_idx</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 0-based (out of 2 possible stress periods)</span>
    <span class="k">if</span> <span class="n">axWasNone</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;subplot2&quot;</span><span class="p">)</span>
    <span class="n">cflood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_less_equal</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="n">stp_idx</span><span class="p">],</span> <span class="mf">0.2</span><span class="p">)</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">flopy</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">PlotMapView</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">gwf</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;saddlebrown&#39;</span><span class="p">,</span> <span class="s1">&#39;goldenrod&#39;</span><span class="p">]</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
    <span class="c1">#mm.plot_array(hk, masked_values=[hk[0, 0, 0]], alpha=0.8, cmap = cmap)</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">hk</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">)</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">plot_ibound</span><span class="p">()</span>
    <span class="n">mm</span><span class="o">.</span><span class="n">plot_grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;.5&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;RdYlGn_r&quot;</span><span class="p">))</span>
    <span class="c1">#cmap = plt.get_cmap(&#39;RdYlGn_r&#39;)</span>
    <span class="n">cmap</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">plot_array</span><span class="p">(</span><span class="n">cflood</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">)</span>
<span class="c1"># Add a colorbar to the plot</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>  <span class="c1"># Use orientation=&#39;horizontal&#39; if preferred</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Concentration (ppm)&#39;</span><span class="p">)</span>  <span class="c1"># Replace with appropriate label for your data</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">contour_array</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="n">stp_idx</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Distance Along X-Axis, in meters&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Distance Along Y-Axis, in meters&quot;</span><span class="p">)</span>

    <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MF6 - End of Stress Period &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">stp_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1"># set idx</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">letter</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">styles</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="n">letter</span><span class="p">,</span> <span class="n">heading</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the figures above, the brown rectangle contained within the goldenrod rectangle represent two different horizontal hydraulic conductivities. The goldenrod color represents the conductivity of a medium grain material, <span class="math notranslate nohighlight">\(K_1 = 1.474\times 10^{-4}~\frac{m}{sec}\)</span>. The brown color represents theconductivity of a fine grain material, <span class="math notranslate nohighlight">\(K_2 = 1.474 \times 10^{-7}~\frac{m}{sec}\)</span>.</p>
<p>The plume ‚Äúcolor map‚Äù is overlain on the material property map, and is set to opaque (not transparent).  The color ramp is and inverted GreenYellowRed.  High values render as red, lowest as green.</p>
<p>Extract concentrations for a specific location, first learn about the array</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape:&quot;</span><span class="p">,</span> <span class="n">conc_mf6</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (rows, columns, depth, etc.)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data type:&quot;</span><span class="p">,</span> <span class="n">conc_mf6</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of dimensions:&quot;</span><span class="p">,</span> <span class="n">conc_mf6</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape: (2, 1, 14, 10)
Data type: float64
Number of dimensions: 4
</pre></div>
</div>
</div>
</div>
<p>My guess is there are two time components (dim0), 1 layer (dim1), and 14 rows (dim2), and 10 columns (dim3).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W1 Conc SP1&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W1 Conc SP2&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">][</span><span class="mi">5</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W2 Conc SP1&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">][</span><span class="mi">7</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W2 Conc SP2&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">][</span><span class="mi">7</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W3 Conc SP1&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;W3 Conc SP2&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">conc_mf6</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">11</span><span class="p">][</span><span class="mi">8</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>

<span class="c1">#print(&quot;I1 Conc SP1&quot;,round(conc_mf6[0][0][4][4],3))</span>
<span class="c1">#print(&quot;I1 Conc SP2&quot;,round(conc_mf6[1][0][4][4],3))</span>
<span class="c1">#print(&quot;I2 Conc SP1&quot;,round(conc_mf6[0][0][4][6],3))</span>
<span class="c1">#print(&quot;I2 Conc SP2&quot;,round(conc_mf6[1][0][4][6],3))</span>
<span class="c1">#print(&quot;I3 Conc SP1&quot;,round(conc_mf6[0][0][7][8],3))</span>
<span class="c1">#print(&quot;I3 Conc SP2&quot;,round(conc_mf6[1][0][7][8],3))</span>
<span class="c1">#$(0, 11, 5), qW1, cW1])  # Pumping well</span>
<span class="c1">#wellist_sp2.append([(0, 11, 7), qW2, cW2])  # Pumping well</span>
<span class="c1">#wellist_sp2.append([(0, 11, 8)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>W1 Conc SP1 65.591
W1 Conc SP2 25.506
W2 Conc SP1 67.033
W2 Conc SP2 99.129
W3 Conc SP1 130.479
W3 Conc SP2 234.931
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="0">
<li><p>Title Page: Title of the Report; Author(s); Date; Affiliation/Institution</p></li>
<li><p>Introduction: Objective is to evaluate the feasibility of injecting tracer-labeled wastewater into the aquifer without exceeding water quality goals at drinking water wells. Injection must achieve a 4:1 dilution (250 mg/L threshold) at the production wells W-1, W-2, and W-3, starting from an injection concentration of 1000 mg/L.</p></li>
<li><p>Problem Statement: Evaluate injection scenarios at sites I-1, I-2, and I-3 considering:</p></li>
</ol>
<ul class="simple">
<li><p>Feasibility of injecting 30 cfs at I-3.</p></li>
<li><p>Potential for higher injection rates or alternative locations.</p></li>
<li><p>Maximum allowable injection volume meeting water quality goals (regulatory assimilative capacity).</p></li>
<li><p>Maximum waste load (mg/sec) at allowable injection rates.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Assumptions and Parameters:</p></li>
</ol>
<ul class="simple">
<li><p>Aquifer Properties</p></li>
<li><p>Well Production Rates:</p></li>
<li><p>Tracer concentration:</p></li>
<li><p>Water quality threshold:</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>Modeling Methodology</p></li>
</ol>
<ul class="simple">
<li><p>Flow Calculations: Simulate groundwater velocity using Darcy‚Äôs Law and account for the influence of production wells.</p></li>
<li><p>Transport Modeling: Model advection, dispersion, and dilution to predict tracer concentrations at wells.</p></li>
<li><p>Dilution Criteria: Evaluate tracer concentrations at each production well to ensure <span class="math notranslate nohighlight">\(C_goal\)</span> is met.</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p>Results:</p></li>
</ol>
<ul class="simple">
<li><p>Scenario 1: Injection of 30 cfs at I-3. Tracer concentration at wells: W-1: [Concentration] mg/L ;W-2: [Concentration] mg/L; W-3: [Concentration] mg/L; Evaluation: [State whether 30 cfs injection meets the goal].</p></li>
<li><p>Scenario 2: Higher Injection Rates or Alternative Locations. Injection rate: [Maximum rate feasible for each site, I-1, I-2, I-3]. Evaluation: [State if higher injection rates meet the goal].</p></li>
<li><p>Scenario 3: Regulatory Assimilative Capacity. Maximum injection volume: [Calculated capacity in cfs or m¬≥/s]. Comparison to well demand: [State if capacity exceeds current drinking water demand].</p></li>
<li><p>Scenario 4: Maximum Waste Load. Maximum injection rate: [Rate that satisfies water demand]. Waste load: [Calculated maximum mg/secmg/sec].</p></li>
</ul>
<ol class="arabic simple" start="6">
<li><p>Discussion</p></li>
</ol>
<ul class="simple">
<li><p>Feasibility: Summarize the feasibility of injection scenarios.</p></li>
<li><p>Sensitivity Analysis: Discuss key parameters affecting the results (e.g., dispersivity, porosity).</p></li>
<li><p>Limitations: Highlight assumptions that could impact accuracy.</p></li>
</ul>
<ol class="arabic simple" start="7">
<li><p>Recommendations</p></li>
</ol>
<ul class="simple">
<li><p>Proposed injection site(s) and rates.</p></li>
<li><p>Monitoring strategies to ensure compliance with water quality goals.</p></li>
<li><p>Consideration of alternative aquifer management strategies if goals cannot be met.</p></li>
</ul>
<ol class="arabic simple" start="8">
<li><p>Conclusions</p></li>
</ol>
<ul class="simple">
<li><p>Summarize findings, including the maximum allowable injection volume and waste load.</p></li>
</ul>
<ol class="arabic simple" start="9">
<li><p>Appendices</p></li>
</ol>
<ul class="simple">
<li><p>Appendix A: Detailed calculations (flow modeling, dilution ratios).</p></li>
<li><p>Appendix B: Maps/visualizations of flow and tracer concentration.</p></li>
<li><p>Appendix C: Tables of input parameters and results.</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/12.01usgsmodflow6/mf6-pr2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">MF6 Project Problem Statement</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-the-assimilative-capacity-of-a-300-ft-aquifer-for-aquifer-storage-recovery-applications-using-modflow6"><div style="text-align: center;"> Modeling the Assimilative Capacity of a 300-ft Aquifer for Aquifer-Storage-Recovery Applications using MODFLOW6 </div></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-problem-statement">Modeling Problem Statement</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions-and-parameters">Assumptions and Parameters:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-methodology">Modeling Methodology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modeling-workflow">Modeling Workflow</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-i-scenario-1">Appendix I: Scenario 1</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-setup">Initial setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-parameters">Define parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-hydraulic-conductivity">Read Hydraulic Conductivity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-boundary-array">Read Boundary Array</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-computation-domain-array">Read Computation Domain Array</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#render-the-array-into-a-visual-representation-will-repeat-this-code-block-as-needed">Render the array into a visual representation - will repeat this code block as needed</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2d-array-you-would-replace-this-with-your-actual-data">Example 2D array (you would replace this with your actual data)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#assuming-my-array2d-is-your-2d-array-nrow-x-ncol">Assuming my_array2D is your 2D array (nrow x ncol)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-2d-array-using-imshow">Plot the 2D array using imshow</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#add-a-colorbar-to-indicate-the-value-scale">Add a colorbar to indicate the value scale</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#add-the-grid">Add the grid</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#customize-the-grid-to-align-with-the-image-cells">Customize the grid to align with the image cells</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#enable-minor-ticks-to-show-the-grid-at-each-cell">Enable minor ticks to show the grid at each cell</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#disable-the-default-major-ticks">Disable the default major ticks</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#add-row-and-column-labels">Add row and column labels</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-add-labels-for-clarity">Optional: Add labels for clarity</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#display-the-plot">Display the plot</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-storage-array">Read storage array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-porosity-array">Read porosity array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-longitudinal-dispersivity-array">Read longitudinal dispersivity array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-transverse-dispersivity-array">Read transverse dispersivity array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pumping-and-injection-wells">Pumping and Injection Wells</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Define parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-setup">Model setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-results">Plotting results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#appendix-i-scenario-2">Appendix I: Scenario 2</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Initial setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Define parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Read Hydraulic Conductivity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Read Boundary Array</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Read Computation Domain Array</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Render the array into a visual representation - will repeat this code block as needed</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">Example 2D array (you would replace this with your actual data)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Assuming my_array2D is your 2D array (nrow x ncol)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Plot the 2D array using imshow</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Add a colorbar to indicate the value scale</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Add the grid</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Customize the grid to align with the image cells</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">Enable minor ticks to show the grid at each cell</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Disable the default major ticks</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Add row and column labels</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Optional: Add labels for clarity</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">Display the plot</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Read storage array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Read porosity array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Read longitudinal dispersivity array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Read transverse dispersivity array</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id23">Pumping and Injection Wells</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Define parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id25">Model setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26">Plotting results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Theodore G. Cleveland, PhD
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      ¬© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>