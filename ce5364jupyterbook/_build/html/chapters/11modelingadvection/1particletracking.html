
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Modeling Advection by Particle Tracking &#8212; Groundwater Transport Phenomena</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/11modelingadvection/1particletracking';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/gwtransport.png" class="logo__image only-light" alt="Groundwater Transport Phenomena - Home"/>
    <script>document.write(`<img src="../../_static/gwtransport.png" class="logo__image only-dark" alt="Groundwater Transport Phenomena - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Preface
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00introduction/00introduction.html">1. Introduction to Groundwater Contaminant Transport</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03site.mapping.tools/site.mapping.tools.html">Site Mapping Tools</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapters/11modelingadvection/1particletracking.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chapters/11modelingadvection/1particletracking.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modeling Advection by Particle Tracking</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-linear-interpolation">Multi-Linear Interpolation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spreadsheet-approach">Spreadsheet Approach</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spreadsheet-examples">Spreadsheet Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-particle-tracking">Example of Particle Tracking</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-need-to-digitize-the-head-map">Step 1. Need to Digitize the Head Map</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#open-g3data">Open G3DATA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-view-zoom">Set View == Zoom</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-filename">Set Filename</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-xy-coordinates">Set XY Coordinates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digitize-the-contours">Digitize the Contours</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-check-the-digitization-results">Step 2 Check the Digitization Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contour-plot-using-triangulated-data">Contour Plot Using Triangulated Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extensions">Extensions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modeling-advection-by-particle-tracking">
<h1>Modeling Advection by Particle Tracking<a class="headerlink" href="#modeling-advection-by-particle-tracking" title="Link to this heading">#</a></h1>
<p>Later on we will use USGS-MOC (which incorporates particle tracking to define characteristic trajectories), so we will illustrate particle tracking keeping MOC in mind.</p>
<ul class="simple">
<li><p>Particle or front tracking is typically performed using special software.</p></li>
<li><p>It can be performed using a spreadsheet.</p></li>
<li><p>The spreadsheet exercise is useful to illustrate the principles involved in particle tracking calculations.</p></li>
<li><p>Particle tracking with reactions is very computationally intensive and is beyond practical application in a spreadsheet; such computations are used to design space shuttles, helicopters and other things where the knowledge gained justifies the costs</p></li>
</ul>
<p>The first step is to compute the velocity field (if it is steady even better, if not then every time increment it is recomputed)</p>
<ul class="simple">
<li><p>If analytical functions are available for the velocity field then tracking is relatively easy.</p></li>
<li><p>Usually the velocity field is determined numerically at discrete points in space, and this is the situation of interest.</p></li>
<li><p>The interpolation schemes in common use are simple; simple, simple-linear, and multi-linear schemes.</p></li>
<li><p>Only the simple-linear scheme preserves cell-by-cell mass balances.</p></li>
</ul>
<p>The figure below illustrates simple linear interpolation.</p>
<p><img alt="" src="../../_images/particle_track_interpolation.png" /></p>
<ul class="simple">
<li><p>Typical computational grid for heads.</p></li>
<li><p>Arrows are the interfacial fluxes.</p></li>
<li><p>The simple scheme assigns the top and left flux to <span class="math notranslate nohighlight">\((x_1,y_1)\)</span>.</p></li>
<li><p>The simple scheme assgins the right and bottom flux to <span class="math notranslate nohighlight">\((x_2,y_2)\)</span>.</p></li>
</ul>
<p>The particle velocity is determined by position of the particle relative to the velocity grid.</p>
<p><img alt="" src="../../_images/pt_find_particle.png" /></p>
<p>Uses the same grid as the head scheme.
Velocity is the distance weighted average of the cell that the particle occupies.</p>
<p><img alt="" src="../../_images/pt_get_velo.png" /></p>
<p>From the above figure, the particle’s velocities (x- and y- directions) are:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(u_p = \frac{1-\delta x}{\Delta x}u(x_1,y_1)+\frac{\delta x}{\Delta x}u(x_2,y_2)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(v_p = \frac{1-\delta y}{\Delta y}v(x_1,y_1)+\frac{\delta y}{\Delta y}v(x_2,y_2)\)</span></p></li>
</ul>
<section id="multi-linear-interpolation">
<h2>Multi-Linear Interpolation<a class="headerlink" href="#multi-linear-interpolation" title="Link to this heading">#</a></h2>
<p>Higher order schemes produce smoother velocity fields at the expense of cell mass balances and computational ease. The USGS-MOC model uses a bi-linear scheme where the velocities at the four corners of the occupied cell are used. When transient flow fields occur, averaging in time is also used. The differences in the schemes are hard to detect when the grid spacing is small and the flow field is smoothly varying.</p>
</section>
<section id="spreadsheet-approach">
<h2>Spreadsheet Approach<a class="headerlink" href="#spreadsheet-approach" title="Link to this heading">#</a></h2>
<p>To illustrate particle tracking the simple velocity scheme is used.<br />
Extension to higher order schemes is straight forward.</p>
<p>Illustrate with simple scheme. Consider:</p>
<p><img alt="" src="../../_images/ss_fig1.png" /></p>
<ul class="simple">
<li><p>Large rectangles represent the velocity grid.</p></li>
<li><p>Circles represent the geometric location where velocity is known.</p></li>
<li><p>Small rectangle represents the particle that we wish to track.</p></li>
</ul>
<p><strong>Cell Indexing</strong></p>
<p><img alt="" src="../../_images/ss_fig2.png" /></p>
<ul class="simple">
<li><p>Each cell represents a grid location in the velocity field.  Thus each cell has a unique row and column index.</p></li>
<li><p>Each cell centroid also has a unique geomteric (x,y) location.</p></li>
<li><p>The particle in the figure is located in cell named: Col_1,Row_2.</p></li>
<li><p>The cell is located at position: (X_1,Y_2).</p></li>
<li><p>The particle position is (XP,YP).</p></li>
</ul>
<p><strong>Locating the Particle</strong></p>
<ul class="simple">
<li><p>At the start of a time-step:</p></li>
<li><p>particle position is known.</p></li>
<li><p>cell positions are known.</p></li>
<li><p>cell that the particle occupies is unknown.</p></li>
<li><p>Construct a distance table</p></li>
<li><p>The distance from each cell to the particle is calculated and stored in a table.</p></li>
<li><p>Search the table,find the cell nearest the particle.</p></li>
<li><p>The cell coordinates of the smallest distance in the table is determined</p></li>
</ul>
<p><strong>Locating in Excel</strong></p>
<ul class="simple">
<li><p>The spreadsheet function that finds the value in an array (rectangular area of cells), given the position in the array to search is the function <code class="docutils literal notranslate"><span class="pre">INDEX(array,row_index,column_index)</span></code></p></li>
<li><p>The spreadsheet function that can find the position in an array where a particular value appears is the function <code class="docutils literal notranslate"><span class="pre">MATCH(value,array,type)</span></code></p></li>
</ul>
<p><strong>INDEX Function</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">INDEX(array,row_index,column_index)</span></code>
array is the location of the rectangular area of cells to search (eg. A3:C6).
row_index is number of rows down from the starting row to search.
column_index is the number of columns across from the starting column to search.</p></li>
</ul>
<p><strong>MATCH Function</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MATCH(value,array,type)</span></code>
value is the numerical value to search for in the array.
array is the location of the rectangular area of cells to search (eg. A3:C6).
type is the type of match to use.  type=0 means exact matching.</p></li>
</ul>
<p><strong>Using the Functions</strong></p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">INDEX</span></code> function allows us to select the correct values of velocity if we know which cell the particle resides in.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">MATCH</span></code> function allows us to compare values in an array and determine the position in the array that these values are found.<br />
Thus the <code class="docutils literal notranslate"><span class="pre">MATCH</span></code> function lets us search a distance table, find the cell center nearest the particle, and then use the index to find the correct velocity.</p></li>
</ul>
<p><strong>Moving the Particle</strong></p>
<p>Once the cell containing the particle is identified, the particle is assigned the velocity values for that cell.
The particle is then “moved” by the simple kinematic calculation:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x_p(t+\Delta t)=x_p(t)+u_p(t)\Delta t\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y_p(t+\Delta t)=y_p(t)+v_p(t)\Delta t\)</span></p></li>
</ul>
<p><strong>Illustrative Example</strong></p>
<p>An example with 3 particles is shown below - the spreadsheet is kind of big because iterative computations are intentionally avoided.</p>
<p><img alt="" src="../../_images/pt_seg0.png" /></p>
<p>Closer view for particle 1:</p>
<p><img alt="" src="../../_images/pt_seg1.png" /></p>
<p>Closer view for particle 2:</p>
<p><img alt="" src="../../_images/pt_seg2.png" /></p>
<p>Closer view for particle 3:</p>
<p><img alt="" src="../../_images/pt_seg3.png" /></p>
<p><strong>Summary</strong></p>
<ul class="simple">
<li><p>Particle tracking is a tool to determine the position of a fluid particle in a flow field.</p></li>
<li><p>A two-step approach is required:</p></li>
<li><p>Determine particle velocity</p>
<ul>
<li><p>Locate the particle relative to known velocity locations.</p></li>
<li><p>Assign the velocity to the particle based on an interpolation scheme.</p></li>
</ul>
</li>
<li><p>Move the particle.</p></li>
<li><p>All particle tracking programs use some sort of this two-step logic.</p></li>
<li><p>Extension to a 3rd spatial dimension is straightforward; boundaries are tricky - ray tracing and folding back across a boundary is a simple approach to manage a need to keep particles in a computational domain; alternatively</p></li>
</ul>
<section id="spreadsheet-examples">
<h3>Spreadsheet Examples<a class="headerlink" href="#spreadsheet-examples" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/ce5364jupyterbook/chapters/11modelingadvection/PartTrack_10.xls">Cleveland, T.G. (1997) <em>Particle Tracking Spreadsheet (10X10) (Excel)</em></a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/ce5364jupyterbook/chapters/11modelingadvection/PartTrack_20.xls">Cleveland, T.G. (1997) <em>Particle Tracking Spreadsheet (20X20) (Excel)</em></a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/ce-5364-webroot/ce5364jupyterbook/chapters/11modelingadvection/PartTrack.xls">Cleveland, T.G. (1997) <em>Particle Tracking Spreadsheet (5X5 same as example above) (Excel)</em></a></p></li>
</ol>
<p>Performing the calculations in a python script is illustrated in the next section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will see that the python script is simpler to construct than the spreadsheet (in terms of weird functions), but takes a shit-ton more code!</p>
</div>
</section>
</section>
<section id="example-of-particle-tracking">
<h2>Example of Particle Tracking<a class="headerlink" href="#example-of-particle-tracking" title="Link to this heading">#</a></h2>
<p>Here we illustrate using particle tracking to address a homework problem.</p>
<hr><hr>
<p>The figure below shows a piezometric map for a shallow sand aquifer.  The hydraulic conductivtiy is estimated to be <span class="math notranslate nohighlight">\(1.5 \times 10^{-2}~\frac{cm}{s}\)</span>, the saturated thickness is 40 feet, and the effective porosity is 0.3.</p>
<p><img alt="" src="http://54.243.252.9/ce-5364-webroot/2-Exercises/ES1/Fig5.18.png" /></p>
<p>Determine:</p>
<ol class="arabic simple">
<li><p>Which well is expected to be the most contaminated.</p></li>
<li><p>The groundwater velocity and seepage velocity across the plume.</p></li>
<li><p>The duration that the source has been contaminating the aquifer (neglect dispersion, diffusiom, and adsorption).</p></li>
<li><p>The flow rate across the plume.</p></li>
<li><p>An explaination for contamination upgradient of the source zone.</p></li>
</ol>
</section>
<section id="step-1-need-to-digitize-the-head-map">
<h2>Step 1. Need to Digitize the Head Map<a class="headerlink" href="#step-1-need-to-digitize-the-head-map" title="Link to this heading">#</a></h2>
<p>Use <a class="reference external" href="https://alternativeto.net/software/g3data/?platform=windows">G3DATA</a> or something similar to digitize the head map.</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">G3DATA</span></code> we will need a coordinate system, so thats superimposed on</p>
<p><img alt="" src="../../_images/Fig5.18-Coordinates.png" /></p>
<p>Next you need to open an instance of <code class="docutils literal notranslate"><span class="pre">G3DATA</span></code>. If using Windows the system should give you a windows manager, if using linux you need an X-window desktop.</p>
<section id="open-g3data">
<h3>Open G3DATA<a class="headerlink" href="#open-g3data" title="Link to this heading">#</a></h3>
<p>Observe that I get the RandR warning (Resize and rotate) - this is assocated with my VNC server window, and the software still is working.  Given I am running on a Raspberry Pi over the internet, ill live with the warning.</p>
<p><img alt="" src="../../_images/openG3.png" /></p>
<p>Also notice in the program call the <code class="docutils literal notranslate"><span class="pre">-scale</span> <span class="pre">0.1</span></code> this is a trial-and-error to rescale the image so I can see what I am doing, so open and close a few times until you get the view window into a workable size.</p>
<p><img alt="" src="../../_images/G3running.png" /></p>
</section>
<section id="set-view-zoom">
<h3>Set View == Zoom<a class="headerlink" href="#set-view-zoom" title="Link to this heading">#</a></h3>
<p>Next we will need to set the view window to Zoom area.  This is needed to write the level set files that we are building.</p>
<p><img alt="" src="../../_images/viewZoom.png" /></p>
</section>
<section id="set-filename">
<h3>Set Filename<a class="headerlink" href="#set-filename" title="Link to this heading">#</a></h3>
<p>Here we set the file name for each level set.  We will digitize each contour line and save its coordinates to a file, then we conactenate these files after adding the Z coordinate into a single file for gridding and plotting.</p>
<p><img alt="" src="../../_images/setFileName.png" /></p>
</section>
<section id="set-xy-coordinates">
<h3>Set XY Coordinates<a class="headerlink" href="#set-xy-coordinates" title="Link to this heading">#</a></h3>
<p>Here we must set the X and Y coordinates of the lower left,lower right (X) and lower left upper left (Y) to establish how we will be measuring things.</p>
<p><img alt="" src="../../_images/setXY.png" /></p>
</section>
<section id="digitize-the-contours">
<h3>Digitize the Contours<a class="headerlink" href="#digitize-the-contours" title="Link to this heading">#</a></h3>
<p>Now we digitize a contour line</p>
<p><img alt="" src="../../_images/digitizeLS.png" /></p>
<p>when done, we write the points to a file.  Here is what is in the tile.</p>
<p><img alt="" src="../../_images/LSfile.png" /></p>
<p>Then clear the points (in the G3DATA program), change the file name and digitize the next line. Repeat until all the lines are complete.</p>
<p>Then open each file and add the Z-coordinate.  Lastly join each file into a single file for further processing.</p>
<p>Here is what my version looks like, the file is <code class="docutils literal notranslate"><span class="pre">Fig5.18-LevelSets.png.dat</span></code> its an ASCII file that I can read and make a contour plot, but more importantly I can grid the data to estimate x- and y- components of velocity from the given value of hydraulic conductivity.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">-</span><span class="n">Easting</span>	<span class="n">Y</span><span class="o">-</span><span class="n">Northing</span>	<span class="n">Z</span><span class="o">-</span><span class="n">Elevation</span>
<span class="o">-</span><span class="mf">0.365791375238</span>  <span class="mf">0.00426936718372</span> <span class="mf">5.5</span>
<span class="mf">7.44799110264</span>  <span class="mf">34.0524726574</span> <span class="mf">5.5</span>
<span class="mf">30.6624750375</span>  <span class="mf">65.7872126049</span> <span class="mf">5.5</span>
<span class="o">...</span>
<span class="n">many</span> <span class="n">lines</span>
<span class="o">...</span>
<span class="mf">353.704129652</span>  <span class="mf">725.957058705</span> <span class="mf">5.5</span>
<span class="mf">186.509893725</span>  <span class="mf">0.312464310759</span> <span class="mf">5.75</span>
<span class="mf">195.371098732</span>  <span class="mf">37.1933927273</span> <span class="mf">5.75</span>
<span class="mf">202.181166327</span>  <span class="mf">65.9190293167</span> <span class="mf">5.75</span>
<span class="mf">206.765265923</span>  <span class="mf">96.4487403766</span> <span class="mf">5.75</span>
<span class="o">...</span>
<span class="n">many</span> <span class="n">lines</span>
<span class="o">...</span>
<span class="mf">486.889653936</span>  <span class="mf">722.268859129</span> <span class="mf">5.75</span>
<span class="mf">362.749010841</span>  <span class="o">-</span><span class="mf">18.4586090188</span> <span class="mf">6.0</span>
<span class="mf">367.376818083</span>  <span class="mf">9.58126046662</span> <span class="mf">6.0</span>
<span class="o">...</span>
<span class="n">many</span> <span class="n">lines</span>
<span class="o">...</span>
<span class="mf">595.939191403</span>  <span class="mf">718.506746134</span> <span class="mf">6.0</span>
<span class="mf">502.803399911</span>  <span class="o">-</span><span class="mf">17.6039350757</span> <span class="mf">6.25</span>
<span class="mf">512.271308678</span>  <span class="mf">26.3822876764</span> <span class="mf">6.25</span>
<span class="mf">520.432150683</span>  <span class="mf">61.4932965599</span> <span class="mf">6.25</span>
<span class="mf">525.047470026</span>  <span class="mf">90.2445493523</span> <span class="mf">6.25</span>
<span class="o">...</span>
<span class="n">many</span> <span class="n">lines</span>
<span class="o">...</span>
<span class="mf">708.769440297</span>  <span class="mf">624.373336948</span> <span class="mf">6.25</span>
<span class="mf">637.755441575</span>  <span class="o">-</span><span class="mf">17.7565649526</span> <span class="mf">6.50</span>
<span class="mf">649.674100524</span>  <span class="mf">11.6206838032</span> <span class="mf">6.50</span>
<span class="o">...</span>
<span class="n">many</span> <span class="n">lines</span>
<span class="o">...</span>
<span class="mf">885.881149356</span>  <span class="mf">618.394355043</span> <span class="mf">6.50</span>
<span class="mf">901.700715759</span>  <span class="o">-</span><span class="mf">11.9467567219</span> <span class="mf">6.75</span>
<span class="mf">909.60191353</span>  <span class="mf">17.1217634194</span> <span class="mf">6.75</span>
<span class="o">...</span>
<span class="n">many</span> <span class="n">lines</span>
<span class="o">...</span>
<span class="mf">976.769639356</span>  <span class="mf">628.357723872</span> <span class="mf">6.75</span>
</pre></div>
</div>
</section>
</section>
<section id="step-2-check-the-digitization-results">
<h2>Step 2 Check the Digitization Results<a class="headerlink" href="#step-2-check-the-digitization-results" title="Link to this heading">#</a></h2>
<p>Here we will now produce a contour map from the digitized map, adjust sizes and overlay on the original map to get an idea of how good we did.</p>
<p>Also will use trial-and-error to find a useable hull within the contour plot where we can capture heads and use for a particle tracking effort - we have to find a rectangle with non-null interpolation values; easiest way (my opinion) is to try indices until can find a reasonable rectangle then sample from that rectangle.  The process is documented below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The interpolation algorithm does not estimate vales outside the convex hull defined by the observation data.  So the box below is by trial-and-error to stay within the convex hull; the interpolator in this region produces useable estimates for computing the heads and velocities from just the mapped information&gt;</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># CCMR from ENGR-1330:</span>
<span class="c1"># http://54.243.252.9/engr-1330-webroot/8-Labs/Lab07/Lab07.html</span>
<span class="c1"># https://clouds.eos.ubc.ca/~phil/docs/problem_solving/06-Plotting-with-Matplotlib/06.14-Contour-Plots.html</span>
<span class="c1"># https://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html</span>
<span class="c1"># https://stackoverflow.com/questions/332289/how-do-you-change-the-size-of-figures-drawn-with-matplotlib</span>
<span class="c1"># https://stackoverflow.com/questions/18730044/converting-two-lists-into-a-matrix</span>
<span class="c1"># https://stackoverflow.com/questions/3242382/interpolation-over-an-irregular-grid</span>
<span class="c1"># https://stackoverflow.com/questions/33919875/interpolate-irregular-3d-data-from-a-xyz-file-to-a-regular-grid</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Fig5.18-LevelSets.png.dat&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># read an ascii file already prepared, delimiter is tabs</span>
<span class="c1">#my_xyz = pandas.read_csv(&#39;XYZSomewhereUSA.txt&#39;,sep=&#39; &#39;) # read an ascii file already prepared, delimiter is tabs</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span> <span class="c1"># convert into a data frame</span>
<span class="c1">#print(my_xyz) #examine the dataframe</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="c1"># extract lists from the dataframe</span>
<span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="s1">&#39;X-Easting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="s1">&#39;Y-Northing&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="s1">&#39;Z-Elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">coord_xy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">))</span>
<span class="c1"># Set plotting range in original data units</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
<span class="c1"># Grid the data; use cubic spline interpolation (other choices are nearest and linear)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_xy</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coord_z</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">fill_value</span> <span class="o">=</span> <span class="s1">&#39;nan&#39;</span><span class="p">)</span>
<span class="c1"># Build the map</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Indices of black box on overlay below:&quot;</span><span class="p">)</span>
<span class="n">ixl</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">ixh</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">iyl</span> <span class="o">=</span> <span class="mi">27</span>
<span class="n">iyh</span> <span class="o">=</span> <span class="mi">62</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xyz lower left corner &quot;</span><span class="p">,</span><span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixl</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixl</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixl</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xyz lower right corner&quot;</span><span class="p">,</span><span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixh</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixh</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixh</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xyz upper left corner &quot;</span><span class="p">,</span><span class="n">X</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixl</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixl</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixl</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;xyz upper right corner &quot;</span><span class="p">,</span><span class="n">X</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixh</span><span class="p">],</span><span class="n">Y</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixh</span><span class="p">],</span><span class="n">Z</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixh</span><span class="p">])</span>
<span class="n">xxl</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixl</span><span class="p">]</span>
<span class="n">xxh</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixh</span><span class="p">]</span>
<span class="n">yyl</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixl</span><span class="p">]</span>
<span class="n">yyh</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixh</span><span class="p">]</span>
<span class="n">flag</span><span class="o">=</span><span class="kc">True</span>
<span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.00</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">]</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.autolayout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;Fig5.18-Coordinates.png&quot;</span><span class="p">)</span> <span class="c1"># base image</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">if</span> <span class="n">flag</span><span class="p">:</span> 
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span><span class="c1"># sets X and Y plot window of basemap</span>
<span class="c1">#fig.set_size_inches(14, 7)</span>
<span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">5.50</span><span class="p">,</span><span class="mf">5.75</span><span class="p">,</span><span class="mf">6.00</span><span class="p">,</span><span class="mf">6.25</span><span class="p">,</span><span class="mf">6.50</span><span class="p">,</span><span class="mf">6.75</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Contour Plot from Gridded Data File&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">800</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyl</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyh</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxl</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxh</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Indices of black box on overlay below:
xyz lower left corner  90.9090909090909 200.0 5.478952367771485
xyz lower right corner 909.090909090909 200.0 6.7224489855441645
xyz upper left corner  90.9090909090909 588.8888888888889 5.302942021834025
xyz upper right corner  909.090909090909 588.8888888888889 6.663235234576626
</pre></div>
</div>
<img alt="../../_images/1a9f6dda9e0b4aa1354015bd7bbc4da23c85c4d26106035c451571e0528dbbda.png" src="../../_images/1a9f6dda9e0b4aa1354015bd7bbc4da23c85c4d26106035c451571e0528dbbda.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># === Load Required Libraries ===</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.tri</span> <span class="k">as</span> <span class="nn">tri</span>

<span class="c1"># === Load Data from ASCII File ===</span>
<span class="c1"># This file is expected to have tab-separated columns: X-Easting, Y-Northing, Z-Elevation</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Fig5.18-LevelSets.png.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_xyz</span><span class="p">)</span>

<span class="c1"># === Extract Columns into Arrays ===</span>
<span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="s1">&#39;X-Easting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="s1">&#39;Y-Northing&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="s1">&#39;Z-Elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># === Create Triangulation from Scattered Points ===</span>
<span class="n">triang</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">)</span>

<span class="c1"># === Define Bounding Box Indices in Grid Coordinates (manually set) ===</span>
<span class="c1"># These are used to extract corners for annotation</span>
<span class="n">ixl</span> <span class="o">=</span> <span class="mi">9</span>   <span class="c1"># x-index low</span>
<span class="n">ixh</span> <span class="o">=</span> <span class="mi">90</span>  <span class="c1"># x-index high</span>
<span class="n">iyl</span> <span class="o">=</span> <span class="mi">27</span>  <span class="c1"># y-index low</span>
<span class="n">iyh</span> <span class="o">=</span> <span class="mi">62</span>  <span class="c1"># y-index high</span>

<span class="c1"># === Compute Bounding Box Corners for Annotations ===</span>
<span class="c1"># Because there is no gridding here, we must derive directly from coordinate logic</span>
<span class="c1"># We&#39;ll define corners directly using data range rather than relying on mesh indices</span>
<span class="c1"># Here we compute approximate bounding box from coordinate values</span>
<span class="n">xxl</span><span class="p">,</span> <span class="n">xxh</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">800</span>  <span class="c1"># manual adjustment as needed</span>
<span class="n">yyl</span><span class="p">,</span> <span class="n">yyh</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">600</span>

<span class="c1"># === Prepare Plotting Environment ===</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># === Overlay Background Image (optional) ===</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;Fig5.18-Coordinates.png&quot;</span><span class="p">)</span>  <span class="c1"># base map image</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span>  <span class="c1"># extent must match image bounds</span>

<span class="c1"># === Plot Contour Lines from Triangulated Data ===</span>
<span class="n">contour_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.50</span><span class="p">,</span> <span class="mf">5.75</span><span class="p">,</span> <span class="mf">6.00</span><span class="p">,</span> <span class="mf">6.25</span><span class="p">,</span> <span class="mf">6.50</span><span class="p">,</span> <span class="mf">6.75</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">tricontour</span><span class="p">(</span><span class="n">triang</span><span class="p">,</span> <span class="n">coord_z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">contour_levels</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># === Annotate Bounding Box (Black Box Over a Region of Interest) ===</span>
<span class="c1"># Draw rectangle from (xxl, yyl) to (xxh, yyh)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span> <span class="n">xxh</span><span class="p">],</span> <span class="p">[</span><span class="n">yyl</span><span class="p">,</span> <span class="n">yyl</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>  <span class="c1"># bottom edge</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span> <span class="n">xxh</span><span class="p">],</span> <span class="p">[</span><span class="n">yyh</span><span class="p">,</span> <span class="n">yyh</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>  <span class="c1"># top edge</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span> <span class="n">xxl</span><span class="p">],</span> <span class="p">[</span><span class="n">yyl</span><span class="p">,</span> <span class="n">yyh</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>  <span class="c1"># left edge</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxh</span><span class="p">,</span> <span class="n">xxh</span><span class="p">],</span> <span class="p">[</span><span class="n">yyl</span><span class="p">,</span> <span class="n">yyh</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>  <span class="c1"># right edge</span>

<span class="c1"># === Customize Plot Appearance ===</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Triangulated Contour Plot with Overlay and Bounding Box&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X-Easting&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y-Northing&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>  <span class="c1"># Maintain 1:1 aspect ratio</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># === Show the Final Plot ===</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3531376059ce7056d055c21093a3f8660287564b77fb6c7271965eead507fa09.png" src="../../_images/3531376059ce7056d055c21093a3f8660287564b77fb6c7271965eead507fa09.png" />
</div>
</div>
</section>
<section id="contour-plot-using-triangulated-data">
<h2>Contour Plot Using Triangulated Data<a class="headerlink" href="#contour-plot-using-triangulated-data" title="Link to this heading">#</a></h2>
<p>This example demonstrates how to:</p>
<ul class="simple">
<li><p>Generate a <strong>contour plot</strong> from irregularly spaced data using <strong>triangulation</strong></p></li>
<li><p>Overlay a <strong>bounding box</strong> to highlight a region of interest</p></li>
<li><p>Use an <strong>interpolation tool</strong> to estimate elevation (<code class="docutils literal notranslate"><span class="pre">Z</span></code>) at an arbitrary location</p></li>
<li><p>(Optional) Display a <strong>base map</strong> beneath the contours</p></li>
</ul>
<p>Later in this course, you will use the interpolation tool in a <strong>particle tracking</strong> exercise to simulate flow along hydraulic gradients.</p>
<p>The dataset <code class="docutils literal notranslate"><span class="pre">Fig5.18-LevelSets.png.dat</span></code> should be located in your working directory and contains <code class="docutils literal notranslate"><span class="pre">X</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, and <code class="docutils literal notranslate"><span class="pre">Z</span></code> columns for Easting, Northing, and Elevation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.tri</span> <span class="k">as</span> <span class="nn">tri</span>
<span class="kn">from</span> <span class="nn">matplotlib.tri</span> <span class="kn">import</span> <span class="n">LinearTriInterpolator</span>

<span class="c1"># === Load Data ===</span>
<span class="n">my_xyz</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Fig5.18-LevelSets.png.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">coord_x</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="s1">&#39;X-Easting&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">coord_y</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="s1">&#39;Y-Northing&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">coord_z</span> <span class="o">=</span> <span class="n">my_xyz</span><span class="p">[</span><span class="s1">&#39;Z-Elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># === Triangulate for Irregular Grid ===</span>
<span class="n">triang</span> <span class="o">=</span> <span class="n">tri</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="n">coord_x</span><span class="p">,</span> <span class="n">coord_y</span><span class="p">)</span>

<span class="c1"># === Optional Base Map Image ===</span>
<span class="n">use_basemap</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">if</span> <span class="n">use_basemap</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.00</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.autolayout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;Fig5.18-Coordinates.png&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">if</span> <span class="n">use_basemap</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span>  <span class="c1"># Adjust extent to match coordinates</span>

<span class="c1"># === Contour Plot via Triangulation ===</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.50</span><span class="p">,</span> <span class="mf">5.75</span><span class="p">,</span> <span class="mf">6.00</span><span class="p">,</span> <span class="mf">6.25</span><span class="p">,</span> <span class="mf">6.50</span><span class="p">,</span> <span class="mf">6.75</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">tricontour</span><span class="p">(</span><span class="n">triang</span><span class="p">,</span> <span class="n">coord_z</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">CS</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># === Bounding Box Overlay ===</span>
<span class="n">ixl</span><span class="p">,</span> <span class="n">ixh</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">90</span>
<span class="n">iyl</span><span class="p">,</span> <span class="n">iyh</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">62</span>
<span class="n">lon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_x</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">lat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord_y</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>

<span class="n">xxl</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixl</span><span class="p">]</span>
<span class="n">xxh</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixh</span><span class="p">]</span>
<span class="n">yyl</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="p">][</span><span class="n">ixl</span><span class="p">]</span>
<span class="n">yyh</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">iyh</span><span class="p">][</span><span class="n">ixh</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span> <span class="n">xxh</span><span class="p">],</span> <span class="p">[</span><span class="n">yyl</span><span class="p">,</span> <span class="n">yyl</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span> <span class="n">xxh</span><span class="p">],</span> <span class="p">[</span><span class="n">yyh</span><span class="p">,</span> <span class="n">yyh</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span> <span class="n">xxl</span><span class="p">],</span> <span class="p">[</span><span class="n">yyl</span><span class="p">,</span> <span class="n">yyh</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxh</span><span class="p">,</span> <span class="n">xxh</span><span class="p">],</span> <span class="p">[</span><span class="n">yyl</span><span class="p">,</span> <span class="n">yyh</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

<span class="c1"># === Interpolator Block (for future particle tracking logic) ===</span>
<span class="n">interpolate_flag</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">if</span> <span class="n">interpolate_flag</span><span class="p">:</span>
    <span class="n">interpolator</span> <span class="o">=</span> <span class="n">LinearTriInterpolator</span><span class="p">(</span><span class="n">triang</span><span class="p">,</span> <span class="n">coord_z</span><span class="p">)</span>

    <span class="c1"># Define a test point</span>
    <span class="n">x_query</span> <span class="o">=</span> <span class="mi">400</span>
    <span class="n">y_query</span> <span class="o">=</span> <span class="mi">200</span>
    <span class="n">z_est</span> <span class="o">=</span> <span class="n">interpolator</span><span class="p">(</span><span class="n">x_query</span><span class="p">,</span> <span class="n">y_query</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Interpolated Z at (</span><span class="si">{</span><span class="n">x_query</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y_query</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">) = </span><span class="si">{</span><span class="n">z_est</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_query</span><span class="p">,</span> <span class="n">y_query</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>  <span class="c1"># Red dot</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">z_est</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">x_query</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span> <span class="n">y_query</span> <span class="o">+</span> <span class="mi">10</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># === Final Plot Settings ===</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Triangulated Contour Plot with Bounding Box and Interpolation Point&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X - Easting&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y - Northing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Interpolated Z at (400.00, 200.00) = 6.001
</pre></div>
</div>
<img alt="../../_images/1aab87fedb74098fcfb98a879631c52186924027be3763ada799680d958e5703.png" src="../../_images/1aab87fedb74098fcfb98a879631c52186924027be3763ada799680d958e5703.png" />
</div>
</div>
<p>This is acceptable.  Now we will extract velocities from the gridded data files - using the “box”.  Recall to use the spreadsheet version of the particle tracker we need the <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> fields from the head distribution.</p>
<p>We will use the supplied hydraulic conductivity and porosity</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(K~\approx~ 1.5 \times 10^{-2}~\frac{cm}{s} \cdot \frac{1~in}{2.54~cm} \cdot \frac{1~ft}{12~in} \cdot \frac{86400~s}{1~day} = 42.52~\frac{ft}{day}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(n~\approx~ 0.30 \)</span></p></li>
</ul>
<p>And apply Darcy’s law as</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\textbf{u(x,y)} = -\frac{K}{n}\cdot \frac{\Delta h}{\Delta x}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\textbf{v(x,y)} = -\frac{K}{n}\cdot \frac{\Delta h}{\Delta y}\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Conductivity</span> <span class="o">=</span> <span class="mf">42.52</span> <span class="c1"># feet/day</span>
<span class="n">Porosity</span> <span class="o">=</span> <span class="mf">0.30</span> <span class="c1"># voids/bulk</span>
<span class="n">nrows</span> <span class="o">=</span> <span class="n">iyh</span> <span class="o">-</span> <span class="n">iyl</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="n">ixh</span> <span class="o">-</span> <span class="n">ixl</span>
<span class="c1">#Zero vectors for the velocity fields</span>
<span class="n">U</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">V</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="c1">#Zero vectors for realinged mesh grid</span>
<span class="n">XG</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="n">YG</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> <span class="c1">#range(nrows)</span>
        <span class="n">U</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="p">(</span><span class="n">Conductivity</span><span class="o">/</span><span class="n">Porosity</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">Z</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1">#- K dh/dx</span>
        <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="o">*</span><span class="p">(</span><span class="n">Conductivity</span><span class="o">/</span><span class="n">Porosity</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">Z</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">])</span> <span class="c1">#- K dh/dy</span>
        <span class="n">XG</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">]</span>
        <span class="n">YG</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">iyl</span><span class="o">+</span><span class="n">i</span><span class="p">][</span><span class="n">ixl</span><span class="o">+</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Suppose we want a plot of the vector field just to check our work, a nice tool is <code class="docutils literal notranslate"><span class="pre">quiver</span></code> and/or <code class="docutils literal notranslate"><span class="pre">streamplot</span></code> which are demonstrated below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert to numpy arrays</span>
<span class="n">UU</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="n">VV</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">XX</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">XG</span><span class="p">)</span>
<span class="n">YY</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">YG</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">UU</span><span class="p">[</span><span class="mi">30</span><span class="p">][</span><span class="mi">30</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(-0.2250452891747141)
</pre></div>
</div>
</div>
</div>
<p>Now a cool “quiver” plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.00</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">]</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.autolayout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;Fig5.18-Coordinates.png&quot;</span><span class="p">)</span> <span class="c1"># base image</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">if</span> <span class="n">flag</span><span class="p">:</span> 
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span><span class="c1"># sets X and Y plot window of basemap</span>
<span class="c1">#fig.set_size_inches(14, 7)</span>
<span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">5.50</span><span class="p">,</span><span class="mf">5.75</span><span class="p">,</span><span class="mf">6.00</span><span class="p">,</span><span class="mf">6.25</span><span class="p">,</span><span class="mf">6.50</span><span class="p">,</span><span class="mf">6.75</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">XX</span><span class="p">[::</span><span class="mi">6</span><span class="p">,</span> <span class="p">::</span><span class="mi">6</span><span class="p">],</span> <span class="n">YY</span><span class="p">[::</span><span class="mi">6</span><span class="p">,</span> <span class="p">::</span><span class="mi">6</span><span class="p">],</span> <span class="n">UU</span><span class="p">[::</span><span class="mi">6</span><span class="p">,</span> <span class="p">::</span><span class="mi">6</span><span class="p">],</span> <span class="n">VV</span><span class="p">[::</span><span class="mi">6</span><span class="p">,</span> <span class="p">::</span><span class="mi">6</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;width&#39;</span><span class="p">)</span>
<span class="c1">#ax.clabel(CS, inline=2, fontsize=12)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Vector Plot from Gridded Data File&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">800</span><span class="p">]);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyl</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyh</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxl</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxh</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">);</span>

<span class="c1">#matplotlib.pyplot.quiver(XX[::6, ::6], YY[::6, ::6], UU[::6, ::6], VV[::6, ::6], units=&#39;width&#39;)</span>
<span class="c1">#matplotlib.pyplot.streamplot(XX, YY, UU, VV, density=0.5, linewidth=2, color=None)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8367502528ff7611e622a7cd79e76576fc5b3ff90bb1824f2b51e8dba9656e79.png" src="../../_images/8367502528ff7611e622a7cd79e76576fc5b3ff90bb1824f2b51e8dba9656e79.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.00</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">]</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.autolayout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;Fig5.18-Coordinates.png&quot;</span><span class="p">)</span> <span class="c1"># base image</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">if</span> <span class="n">flag</span><span class="p">:</span> 
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span><span class="c1"># sets X and Y plot window of basemap</span>
<span class="c1">#fig.set_size_inches(14, 7)</span>
<span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">5.50</span><span class="p">,</span><span class="mf">5.75</span><span class="p">,</span><span class="mf">6.00</span><span class="p">,</span><span class="mf">6.25</span><span class="p">,</span><span class="mf">6.50</span><span class="p">,</span><span class="mf">6.75</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">UU</span><span class="p">,</span> <span class="n">VV</span><span class="p">,</span>  <span class="n">density</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1">#ax.clabel(CS, inline=2, fontsize=12)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Vector Plot from Gridded Data File&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">800</span><span class="p">]);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyl</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyh</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxl</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxh</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6f20600fd5392667e2d947a2bc5a87216d5bd74266b7d0ee47af9901b12d541c.png" src="../../_images/6f20600fd5392667e2d947a2bc5a87216d5bd74266b7d0ee47af9901b12d541c.png" />
</div>
</div>
<p>Now we can implement a particle tracking script.  Using the spreadsheet as a guide we can write it in python, and access the cool graphics.</p>
<p>Here is the basic script, one simply has to wrap it into a time-stepping loop to produce a trajectory.  Multiple particles can be managed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># U array x-velocity at XG,YG</span>
<span class="c1"># V array y-velocity at XG,YG</span>
<span class="c1"># XG array X-value of cell center</span>
<span class="c1"># YG array Y-value of cell center</span>
<span class="c1"># XP X-value of particle position </span>
<span class="c1"># YP Y-value of particle position</span>
<span class="c1"># UP x-velocity of particle </span>
<span class="c1"># VP y-velocity of particle</span>
<span class="c1"># TX x-component particle trajectory</span>
<span class="c1"># TY y-component particle trajectory</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
<span class="n">terse</span><span class="o">=</span><span class="kc">False</span>
<span class="n">deltaT</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">etime</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">numTime</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">XP</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">YP</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">UP</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">VP</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">TX</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#trajectory vector</span>
<span class="n">TY</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">np</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># Total particles </span>
<span class="n">XP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">900</span><span class="p">)</span>
<span class="n">YP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">290</span><span class="p">)</span>
<span class="n">UP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">VP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ip</span><span class="o">=</span><span class="n">np</span><span class="o">-</span><span class="mi">1</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;                   Initial Particle Position&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">UP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">VP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">etime</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># move particles this time step</span>
<span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numTime</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ip</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="p">):</span>
    <span class="c1"># Build Particle Distance Table</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncols</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrows</span><span class="p">):</span> <span class="c1">#range(nrows)</span>
                <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">XX</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">YY</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
                <span class="n">index</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">count</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span> <span class="c1"># use to find i,j for a given index</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span><span class="mi">1</span>
    <span class="c1"># find closest cell</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">dist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dist</span><span class="p">):</span>
                <span class="c1">#print(index[i],dist[i])</span>
                <span class="n">ixx</span><span class="o">=</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">jyy</span><span class="o">=</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># use nearest cell assignment - aka simple scheme</span>
                <span class="n">UP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span> <span class="o">=</span> <span class="n">UU</span><span class="p">[</span><span class="n">ixx</span><span class="p">][</span><span class="n">jyy</span><span class="p">]</span>
                <span class="n">VP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span> <span class="o">=</span> <span class="n">VV</span><span class="p">[</span><span class="n">ixx</span><span class="p">][</span><span class="n">jyy</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Particle Position and Velocities Before Move&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">UP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">VP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">etime</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
                <span class="k">break</span> <span class="c1">#exits the loop - we stop at the first nearest cell encountered</span>
    <span class="c1"># move the particle</span>
        <span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="o">=</span><span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="o">+</span><span class="n">UP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="o">*</span><span class="n">deltaT</span>
        <span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="o">=</span><span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="o">+</span><span class="n">VP</span><span class="p">[</span><span class="n">ip</span><span class="p">]</span><span class="o">*</span><span class="n">deltaT</span>
        <span class="n">etime</span><span class="o">=</span><span class="n">etime</span><span class="o">+</span><span class="n">deltaT</span>
        <span class="k">if</span> <span class="n">terse</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Particle Position and Velocities After Move&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">UP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">VP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">etime</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">TX</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">XP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="n">etime</span><span class="p">])</span>
        <span class="n">TY</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ip</span><span class="p">,</span><span class="n">YP</span><span class="p">[</span><span class="n">ip</span><span class="p">],</span><span class="n">etime</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                   Initial Particle Position 900 290 0 0 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.00</span><span class="p">,</span> <span class="mf">8.00</span><span class="p">]</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.autolayout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;Fig5.18-Coordinates.png&quot;</span><span class="p">)</span> <span class="c1"># base image</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">if</span> <span class="n">flag</span><span class="p">:</span> 
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span> <span class="mi">800</span><span class="p">])</span><span class="c1"># sets X and Y plot window of basemap</span>
<span class="c1">#fig.set_size_inches(14, 7)</span>
<span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mf">5.50</span><span class="p">,</span><span class="mf">5.75</span><span class="p">,</span><span class="mf">6.00</span><span class="p">,</span><span class="mf">6.25</span><span class="p">,</span><span class="mf">6.50</span><span class="p">,</span><span class="mf">6.75</span><span class="p">]</span>
<span class="n">CS</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">streamplot</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span> <span class="n">YY</span><span class="p">,</span> <span class="n">UU</span><span class="p">,</span> <span class="n">VV</span><span class="p">,</span>  <span class="n">density</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">arrowsize</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1">#ax.clabel(CS, inline=2, fontsize=12)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Vector Plot from Gridded Data File</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
            <span class="s1">&#39;Each Marker is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">deltaT</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; days</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
            <span class="s1">&#39;Total Time is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">etime</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; days&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">800</span><span class="p">]);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyl</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyh</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxl</span><span class="p">,</span><span class="n">xxl</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xxh</span><span class="p">,</span><span class="n">xxh</span><span class="p">],[</span><span class="n">yyl</span><span class="p">,</span><span class="n">yyh</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">xtrajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">sublist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">TX</span><span class="p">]</span>
<span class="n">ytrajectory</span> <span class="o">=</span> <span class="p">[</span><span class="n">sublist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">TY</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtrajectory</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ytrajectory</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xtrajectory</span><span class="p">,</span><span class="n">ytrajectory</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="p">;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;&#39;
</pre></div>
</div>
<img alt="../../_images/fb5ddea0229206a21aa77048a2da44090718f0efaff475516692f49c953ad5f9.png" src="../../_images/fb5ddea0229206a21aa77048a2da44090718f0efaff475516692f49c953ad5f9.png" />
</div>
</div>
<section id="extensions">
<h3>Extensions<a class="headerlink" href="#extensions" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>One could certainly add a lot more particles.</p></li>
<li><p>If the parcels represent some quantify of mass, concentrations can be directly approximated.</p></li>
</ol>
<p>The method is not limited to groundwater hydrology, and an example of another use is in the references.</p>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://54.243.252.9/about-me-webroot/about-me/MyWebPapers/project_reports/HARC_Document/HARC_Document.pdf">Cleveland, T.G., 1991. <em>A Comparison of Sampling Design Criterion using a Lagrangian Particle Tracking Model for Transport in Porous Media</em>, Final Report to Houston Advanced Research Center, Woodlands, Texas. 54p.</a></p></li>
<li><p><a class="reference external" href="https://www.osti.gov/servlets/purl/7083383-IHl4XM/">Ahlstrom, S W, Foote, H P, Arnett, R C, Cole, C R, and Serne, R J. <em>Multicomponent mass transport model: theory and numerical implementation (discrete-parcel-random-walk version).</em> United States: N. p., 1977. Web. doi:10.2172/7083383.</a></p></li>
<li><p><a class="reference external" href="https://pdf.sciencedirectassets.com/271718/1-s2.0-S0309170800X00206/1-s2.0-S0309170897000079/main.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEO%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLWVhc3QtMSJHMEUCIQDnoA3cV9bojVQfPNNC5216IOqSfA3CC9oNpKqm7jsg%2BAIgPNHP7BORGCHJOPXblsR7OgkpZOL4TiorvYNFoF7DzzoqvAUI2P%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAFGgwwNTkwMDM1NDY4NjUiDMtHVnMRegEZxZu%2FZiqQBTx7ackkzlJkdep3XgGsyzfLKPWiZki7LjIGbfJzfz8ghafQjvK87AoSeOQbPszA9n%2BA%2B98Cg4Td9L1s2sGvfQbmSP6y3cX55ettaeiK7IpLsVoN0Xj%2FCN00ZNLkFrbQvJx1Rf4mIj75YEI9csluicZQ16%2BFfPnaKMwguwCEtT13YL%2F%2B%2BNhpahdG5TZ8iMzgHNsyQWoMUM2CgnQU2G9HuKlIqUQWWQE5muKj2t1m5bVStiFX%2BYrsdCCwAAIAQXi%2BzNsjMY%2B92CE9Y%2BUjLXzOmb2nTemS7oJ3khktN7mbimpf5bXQvBxiwU%2B5fdOqJfkssnBrIUa%2BH4NVqtC%2F33cB%2FGJLSBstPPnTIDhObNPUnKNrwduwFa7nPcWKBhdTbjN%2B4C31UI8VV5ktT22TeFxtIxU7WPb4%2FiorI0bYgWh4rjiIWP3LewwsNVH3BeLhqVdmq8rISfyQVosTxpXvmzWVZi027h6PvICdSHIqjTUdg5%2BIN9IEeT0vibYXLIrGXPJH%2F5cRpmDnxDBZP86qyvJ7yO%2BjciEzesPfrMAeiV30eKsxyMU6mQVARd8AVHR4OUpJ3HjW6PCWaP6KHqDUDeDE9YcQpOVyHbpTojE%2BMXun6K8cVL2eghCu9JqpwaqhRnwFMSoE66sD%2F0QMDzTQhpMZOuuwwMkPwM25MXLOIUzkI%2B1Iyuz5IPWeBoMWUMmINQxMaMuXRUkajR3PEJw9Q78IurKMz3MYU%2BM2Lq2CrMulkGfB5ICmOSEAA2oDym6oVyNA13MiwgyhXfyROEtxF4dMBKkOOdcAzSR7BH%2FwefmvFZtNXn5CuqSr6TZCx%2BrQQkPgCPWlZaIhQvC3yDST7dSeHOpNEGEA6%2FKjUWmyCR0ILmJIMLOOrKgGOrEBqqrXj4L7AVYSVhfpXTtIOpQFLkzWXqlkYtxWyPxmOYgnaiBfzRsplcRE8Z15zosf35r%2Fv1DVKUie%2BNqMgcszd2tH89iZ3z29JkvRAlgCmD2cFwTzwyoTuCWGTQhZtm9B5HGkQ%2F6OkQUNmbl%2FtQzkdEdKqFTsnD8Rqr7j78eB82fPB94%2BdPFSfFDCfSNDbT4aEZtq0Gys4IxXE0fpr%2BwJrmqqffzX2WsQAcdnQKJsAZ8u&amp;amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;amp;X-Amz-Date=20230920T152957Z&amp;amp;X-Amz-SignedHeaders=host&amp;amp;X-Amz-Expires=300&amp;amp;X-Amz-Credential=ASIAQ3PHCVTY3SEVAUPT%2F20230920%2Fus-east-1%2Fs3%2Faws4_request&amp;amp;X-Amz-Signature=32d7e0fcf2047a83bd395b8a01396547b1df965c3919265e1df97af08e546058&amp;amp;hash=98e447ef758882bdc500f581d99984707720145e14f6f213ed170521c1a545bf&amp;amp;host=68042c943591013ac2b2430a89b270f6af2c76d8dfd086a07176afe7c76c2c61&amp;amp;pii=S0309170897000079&amp;amp;tid=spdf-9915bbf9-f314-4721-8f97-e5760a05c1dd&amp;amp;sid=2f575b1c213689494e48a5227441297408a8gxrqa&amp;amp;type=client&amp;amp;tsoh=d3d3LnNjaWVuY2VkaXJlY3QuY29t&amp;amp;ua=0f15595e560d5f03560907&amp;amp;rr=809b1b5fcec7479a&amp;amp;cc=us"><em>Modeling plume behavior for nonlinearly sorbing solutes in saturated homogeneous porous media</em> in Advances in Water Resources 21 (1998) 487-498 Elsevier Science Limited</a></p></li>
<li><p><a class="reference external" href="https://www.amazon.com/Dynamics-Fluids-Porous-Mechanical-Engineering/dp/0486656756">Bear, J. (1972) <em>Dynamics of Fluids in Porous Media</em> McGraw Hill (pp. 236-241)</a></p></li>
<li><p><a class="reference external" href="http://54.243.252.9/about-me-webroot/about-me/MyWebPapers/presentations/2007_0721_ECI_Unitgraphs/2007_0721_ECI_Unitgraphs.pdf">Cleveland, T.G., Thompson, D.B., Fang,X., He, X. 2007. <em>Synthesis of Unit Hydrographs from a Digital Elevation Model.</em> Urban Runoff Modeling: Intelligent Modeling to Improve Stormwater Management, ECI Specialty Conference, July 22-27, Humboldt State University, Arcata, California.</a></p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters/11modelingadvection"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-linear-interpolation">Multi-Linear Interpolation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spreadsheet-approach">Spreadsheet Approach</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spreadsheet-examples">Spreadsheet Examples</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-of-particle-tracking">Example of Particle Tracking</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-need-to-digitize-the-head-map">Step 1. Need to Digitize the Head Map</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#open-g3data">Open G3DATA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-view-zoom">Set View == Zoom</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-filename">Set Filename</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-xy-coordinates">Set XY Coordinates</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digitize-the-contours">Digitize the Contours</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-check-the-digitization-results">Step 2 Check the Digitization Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contour-plot-using-triangulated-data">Contour Plot Using Triangulated Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extensions">Extensions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Theodore G. Cleveland, PhD
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>